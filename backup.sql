mysqldump: [Warning] Using a password on the command line interface can be insecure.
-- MySQL dump 10.13  Distrib 5.7.26, for Linux (x86_64)
--
-- Host: localhost    Database: orchestrator_dashboard
-- ------------------------------------------------------
-- Server version	5.7.26

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `deployments`
--

DROP TABLE IF EXISTS `deployments`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `deployments` (
  `uuid` varchar(36) NOT NULL,
  `creation_time` datetime DEFAULT NULL,
  `update_time` datetime DEFAULT NULL,
  `physicalId` varchar(36) DEFAULT NULL,
  `description` varchar(256) DEFAULT NULL,
  `status` varchar(128) DEFAULT NULL,
  `outputs` mediumtext,
  `task` varchar(64) DEFAULT NULL,
  `links` mediumtext,
  `sub` varchar(36) DEFAULT NULL,
  `provider_name` varchar(128) DEFAULT NULL,
  `endpoint` varchar(256) DEFAULT NULL,
  `template` longtext,
  `inputs` mediumtext,
  `params` mediumtext,
  `locked` tinyint(1) DEFAULT '0',
  `feedback_required` tinyint(1) DEFAULT '1',
  `remote` tinyint(1) DEFAULT '0',
  `issuer` varchar(256) DEFAULT NULL,
  `storage_encryption` tinyint(1) DEFAULT '0',
  `vault_secret_uuid` varchar(36) DEFAULT NULL,
  `vault_secret_key` varchar(32) DEFAULT NULL,
  `status_reason` varchar(256) DEFAULT NULL,
  PRIMARY KEY (`uuid`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `deployments`
--

LOCK TABLES `deployments` WRITE;
/*!40000 ALTER TABLE `deployments` DISABLE KEYS */;
INSERT INTO `deployments` VALUES ('11e991ce-f3f8-7ef6-8400-024283ff312a','2019-06-18 13:42:00','2019-06-19 09:58:11','ff6fc57a-91ce-11e9-becb-fa163e0663d5','','DELETE_COMPLETE','{\"galaxy_url\": \"http://90.147.102.108/galaxy\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e991ce-f3f8-7ef6-8400-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e991ce-f3f8-7ef6-8400-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e991ce-f3f8-7ef6-8400-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','description: \'Deploy Galaxy on a single Virtual Machine installing it from scratch\n  (SLOW). The basic configuration includes CentOS 7, the selected Galaxy flavour,\n  companion software and reference data. Configure, click on the \"Submit\" button and\n  wait for the confirmation e-mail(s) with instructions on how to provide your passphrase\n  (if encryption is enabled) and log in to your new Galaxy instance. If after some\n  hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\n  \'\nimports:\n- indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\ntopology_template:\n  inputs:\n    admin_api_key:\n      default: not_very_secret_api_key\n      description: key to access the API with admin role\n      type: string\n    admin_email:\n      default: admin@admin.com\n      description: email of the admin user\n      type: string\n    export_dir:\n      default: /export\n      description: path to store galaxy data\n      type: string\n    flavor:\n      default: galaxy-no-tools\n      description: Galaxy flavor for tools installation\n      type: string\n    iam_client_id:\n      default: iam_client_id_for_luks_client\n      description: null\n      required: false\n      type: string\n    iam_client_secret:\n      default: iam_secret_for_luks_client\n      description: null\n      required: false\n      type: string\n    instance_description:\n      default: INDIGO Galaxy test\n      description: galaxy instance description\n      type: string\n    instance_flavor:\n      default: small\n      description: instance flavor (num_cpu, memory, disk)\n      type: string\n    instance_key_pub:\n      default: your_ssh_public_key\n      description: galaxy instance ssh public key\n      type: string\n    refdata_cvmfs_key_file:\n      default: elixir-italy.galaxy.refdata.pub\n      description: CernVM-FS public key\n      type: string\n    refdata_cvmfs_proxy_port:\n      default: 80\n      description: CernVM-FS proxy port\n      type: integer\n    refdata_cvmfs_proxy_url:\n      default: DIRECT\n      description: CernVM-FS proxy url\n      type: string\n    refdata_cvmfs_repository_name:\n      default: elixir-italy.galaxy.refdata\n      description: Reference data CernVM-FS repository name\n      type: string\n    refdata_cvmfs_server_url:\n      default: 90.147.102.186\n      description: CernVM-FS server, replica or stratum-zero\n      type: string\n    refdata_dir:\n      default: /cvmfs\n      description: path to store galaxy reference data\n      type: string\n    refdata_provider:\n      default: not_a_provider\n      description: Oneprovider for reference data\n      type: string\n    refdata_provider_type:\n      default: cvmfs_preconfigured\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      type: string\n    refdata_repository_name:\n      default: elixir-italy.galaxy.refdata\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload\n        name\n      type: string\n    refdata_token:\n      default: not_a_token\n      description: Access token for reference data\n      type: string\n    reference_data:\n      default: true\n      description: Install Reference data\n      type: boolean\n    storage_encryption:\n      default: true\n      description: Enable storage encryption using Vault to store secrets and LUKS\n        to encrypt\n      required: true\n      type: boolean\n    storage_size:\n      default: 10 GB\n      description: storage memory required for the instance\n      type: string\n    user:\n      default: galaxy\n      description: username to launch the galaxy daemon\n      type: string\n    vault_secret_key:\n      default: luks\n      description: Vault secret key name\n      required: false\n      type: string\n    vault_secret_path:\n      default: 20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\n      description: Vault path to store secret\n      required: false\n      type: string\n    vault_url:\n      default: https://cloud-90-147-75-223.cloud.ba.infn.it:8200\n      description: Hashicorp Vault server url\n      required: false\n      type: string\n    vault_wrapping_token:\n      default: not_a_wrapping_token\n      description: Vault Wrapping token to write secret\n      required: false\n      type: string\n    version:\n      default: master\n      description: galaxy version to install\n      type: string\n  node_templates:\n    galaxy:\n      properties:\n        admin_api_key:\n          get_input: admin_api_key\n        admin_email:\n          get_input: admin_email\n        export_dir:\n          get_input: export_dir\n        iam_client_id:\n          get_input: iam_client_id\n        iam_client_secret:\n          get_input: iam_client_id\n        instance_description:\n          get_input: instance_description\n        instance_key_pub:\n          get_input: instance_key_pub\n        storage_encryption:\n          get_input: storage_encryption\n        vault_secret_key:\n          get_input: vault_secret_key\n        vault_secret_path:\n          get_input: vault_secret_path\n        vault_url:\n          get_input: vault_url\n        vault_wrapping_token:\n          get_input: vault_wrapping_token\n        version:\n          get_input: version\n      requirements:\n      - lrms: local_lrms\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n    galaxy_refdata:\n      properties:\n        flavor:\n          get_input: flavor\n        refdata_cvmfs_key_file:\n          get_input: refdata_cvmfs_key_file\n        refdata_cvmfs_proxy_port:\n          get_input: refdata_cvmfs_proxy_port\n        refdata_cvmfs_proxy_url:\n          get_input: refdata_cvmfs_proxy_url\n        refdata_cvmfs_repository_name:\n          get_input: refdata_cvmfs_repository_name\n        refdata_cvmfs_server_url:\n          get_input: refdata_cvmfs_server_url\n        refdata_dir:\n          get_input: refdata_dir\n        refdata_provider:\n          get_input: refdata_provider\n        refdata_provider_type:\n          get_input: refdata_provider_type\n        refdata_repository_name:\n          get_input: refdata_repository_name\n        refdata_token:\n          get_input: refdata_token\n        reference_data:\n          get_input: reference_data\n      requirements:\n      - host: galaxy\n      - dependency: galaxy_tools\n      type: tosca.nodes.indigo.GalaxyReferenceData\n    galaxy_server:\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            ports:\n              ftp_passive:\n                protocol: tcp\n                source_range:\n                - 30000\n                - 30009\n              ftp_port:\n                protocol: tcp\n                source: 21\n              http_port:\n                protocol: tcp\n                source: 80\n            private_ip: false\n        host:\n          properties:\n            instance_type:\n              get_input: instance_flavor\n        os:\n          properties:\n            image: centos-7-galaxy-base\n      requirements:\n      - local_storage:\n          capability: tosca.capabilities.Attachment\n          node: my_block_storage\n          relationship:\n            properties:\n              device: hdb\n              location:\n                get_input: export_dir\n            type: tosca.relationships.AttachesTo\n      type: tosca.nodes.indigo.Compute\n    galaxy_tools:\n      properties:\n        admin_api_key:\n          get_input: admin_api_key\n        flavor:\n          get_input: flavor\n        version:\n          get_input: version\n      requirements:\n      - host: galaxy\n      type: tosca.nodes.indigo.GalaxyShedTool\n    local_lrms:\n      requirements:\n      - host: galaxy_server\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n    my_block_storage:\n      properties:\n        size:\n          get_input: storage_size\n      type: tosca.nodes.BlockStorage\n  outputs:\n    galaxy_url:\n      value:\n        concat:\n        - http://\n        - get_attribute:\n          - galaxy_server\n          - public_address\n          - 0\n        - /galaxy\ntosca_definitions_version: tosca_simple_yaml_1_0\n','','',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e992a7-acaa-3416-8400-024283ff312a','2019-06-19 15:34:00','2019-06-23 06:54:42','b30a6a1c-92a7-11e9-8069-fa163e0663d5','','DELETE_COMPLETE','{\"node_creds\": {\"user\": \"cloudadm\", \"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqQIBAAKCAQEApNny1iG4Ce8nlbg5M0ZgRoN1P+9MNrAZMjAPSzz/Ue00E/TN\nf3O8mlALqvYEG732tXM+77GTcCFYoBzL2G1krfMKrDGBdeha0ASo3XFdbVoD5Ow5\nGknkYOjLjoovZZ8qJRondq3IUkv8/Da8JaOwMS7Pn+PAnJcM6twWyOm2WDaK2CFU\nUT+hSXhUzrVOS4QlEaRFR7W8h4Q3xD+zcIUC8QNS0waDsBo+W8D+AZnMwHtKKDDn\nL1KOguldtunnVltxDiBnlZhJGm4pV9vgs9nGYOhuxfyizFwac0AI06hYlEG03iFU\nOBmkkStWTetRcw/P03Z2elJ0ei/VuXqkFFLSiwIDAQABAoIBAAo8MfSTkV6kh5un\nHX4Of4nBPbVjgSLgGiBglYKBXgTTKmmWyG+CWxJlp+PMdILYb4nihuTQ7KuIln0S\nbKGaYSbfsSjxxezxKTpDH8zn7foNHbLH69+y+Mf/jCvkbn7ru+0jy5F1xrs9Vo6+\nQz4/BIB5PJDbziiqxDWMxqlgwV6GotZzJy3IuucGrnY1fiTV1yEEkjxh0wjMdi13\nt3DZG/Pm0gjrtnn5TW/5PfF6dJfPCk8zDcdmMlya76NV2vTaUCz0wOBdDL6Ln3AZ\n6mGR2EJTkDKnDTMVnesLSuM+RDJjpdLmHjvloMJ7zjJv4JDQMced0TgTyUbddGy3\nmy687mECggCBAMC5hTOyH8NZboQwQgTIfpdJrVZ23TknS9fw+Zkjs/OS3XjK+Bm6\nPviDzfVK70VgwDPx/VhU/MLFZquP0m2ns2aL0ylizc7xspDbCk+R8lW9sw4ascwC\nKu4H9PlVuG9Bc4YF/OIkf+Y/8be50uPcnlQZHa8WrKWr9r8yJ9eGi997AoIAgQDa\n+a30pezMxvswIWD07wwZZdYjalqYOW78XI93kSubWjLQ7NSB4z9oPZOpGcttwEPb\nHqYAUpETmfHp8OQeWTOFbWsjU5L6yELtIA9huiS6zZ/L3LpFMlPW4F0/Rf8L0og1\nWmEmY6MDdBtwwuY40lprUa6a2i2+iFd1JDsWJHNkMQKCAIEAtn21hMsRSqBfhupP\nSUo0nLsWWL57Ikh0h8jWAE2Pc4BJGL1RCsOSJy5fkvre8Nn5hfaJx9/J7ACSBLhO\nMKlQtjSGwjSd32x8gq/25nuzdb8IUr2ySBRxZC3CqWqjFy5p3qnC2LxpI7S/BRL/\nf+aDQez6b7XPy5y3LDqpAWuU/QsCggCBAJItHK/1V7d3mVUO4y9+qGAH+EQaCjIW\nHP3AOFGECk0hkEyh3FZ8weYvPPQkcQVp1KJgukX62Dfyi2g008Ninp8SZPPnJXXd\n27d5sGr3nO9KtsKbLYllyEvn6LeFXXWh7CVZmQLMfpSenHbQ1GjYG14K3/klbmYD\nlAZx0jO8z37xAoIAgC1w96t9fT/fCXUsn8ANnyCS+9O4Uknn5deTWLO2LWYOC0Oq\n97Xc6CV2v/WVTdVdYqDfr63AzvMZBKzD2KiPlhYAuzjw5e2Q96CavQckjhtZ0oEI\nLan4qb9eS3slnKQOZdGs4/crNVuDYTCFx/dUFnP/UNSf3nA9lOMcyp4Oi1h3\n-----END RSA PRIVATE KEY-----\n\"}, \"node_ip\": \"90.147.102.31\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e992a7-acaa-3416-8400-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e992a7-acaa-3416-8400-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e992a7-acaa-3416-8400-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    node_ip:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"num_cpus\": \"2\", \"noinput\": \"\", \"mem_size\": \"3 GB\", \"os_distribution\": \"ubuntu\", \"additional_description\": \"\", \"zabbix_metadata\": \"\", \"num_instances\": \"1\", \"zabbix_server\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e992ab-1532-46ed-8400-024283ff312a','2019-06-19 15:58:00','2019-06-21 11:38:02','1a97ef9e-92ab-11e9-8069-fa163e0663d5','very long phrase to destroy format table style','DELETE_COMPLETE','{\"node_ip\": \"90.147.102.53\", \"node_creds\": {\"user\": \"cloudadm\", \"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqAIBAAKCAQEAqDtNVgMHAP0OZb0UytkhYTSnQtLnNekxnFMtXIqbiPxcmxXP\nmajiYENV5RgBel8ETMZXQQ7PPyEdXEGi+clhJtS01/NqSEgJFNgKhuxEoxw4HpvD\nGqhKi2D3PvHgn8jvgasWz49lqGN2HVdFFxS+6fA6yR9hLaIfO66GHJ5JjzA4Wb7a\ntxC5oc1n46WygBHJGAnAmApz2IUeZWqcSRYXAH3ZRF3t/6bn84lqStYKjjA+mgcV\ndXdhChbpp3ZDxIw229bTm5/3XAghqovcrkkHbTwfYluMBtFTrdqDaYE52in2qFEp\nCpHJCkf+KamPuPmiAABtKWIBNsLZpIjoRj4chwIDAQABAoIBAEsFtyVGUFdGgqco\nPR+A2PvqaTTJrMZD6hXWmgIM5fOe5wVaIqxZvipDnQh/Phl+SgKa6Mpgeleiwt8j\nfjR6c9LHRKaRLLJzPWmINpmYv7slmHk96TH4HtYtNdViNFPNXdGrpI6HWkRPpprL\nEkqKu+DDetO6JLIe/GK3H6OfixpJIqlHS3wAdGIFE0Gee6vH6bfPpUduh40Q2Fkb\nJhr9EITH6mM0uYEAPJhWQSxuw/oLRkV0r6gogrO0OdGcztcvP/CFJgQJVVYdQpwG\nNEPeylIjAkIUSDxYfLq8IAXvFjKeU77r1sZUukXGkH+SIqJ+8UzR/kORPEqryrxy\nbN3VCZECggCBALtn2D/Xyn46mnRlpoDlHv0iz019bgCwEGervuJDrttIO5KCHG6v\nqBevj7S5QHiBxEibFnknFqu167an372I+TPxkdMzLuYclsvw/LvUPzlBHGB4vW5i\n7bL46vxPTjoRAuAVr8zkvF5SpM1okTAXPP7859+FHuI+ugcvpkFTxyJ7AoIAgQDl\nztQvqgkkIlsBTu0w2YLbYHKxRKhWHZvAHZ59TN58riWWkF7aM54Pw/6H+qlhaN/K\nnQCT7MMsUEV/tsZmGoQKZcizvGoMQoVROpOpwmD+dpENi1PZ+kjpQiDjfsOY0FAv\nCQ9cuXM8sQIRrM2Vq9lMj0TQO9955Dha+jEtPinmZQKCAIAo3xP9kH18HCHVYtn2\nYIHqqS3W85ULF1rskTtXM3WuI0nCwRecWDjruYE44/IYlgyN3S0AjTLXjhxzQJd+\nSaI33uZzzkTbML7+iXdFK5wCS535uDtwGKlIkBsHnfAsn8slvfUSVYxzcci5d6W6\nfEb0QYn8aJb8trtxl8XFl5TlgwKCAIAK2IERItA9oVV0MVpmZM2VNu8SyK+9KLaS\nEZPKTBdwAPQLMBMZ7ze1fMWFe2IFE+MD9/bwBEuNytgM1/5zEStMJlObj/fdTkJm\nfAI+D8tuFwBviDTT48kPISzWL8RhcOtn3OCZurLimWQEm4g0WSDvSQ+xWDIK2aeD\nO62YegeWNQKCAIEAswn8EWPivfyOH0qbCRhpQKZWyUZlNawzSLi39/djeN8ZiHtq\n0R0rwsPX5Pn9b3wldmb19VsDHoOk4MvLDUWTRta/HJ/ufGcErYUE/hjG7yl3EBtw\njIhmivk+31ZO7kdtf/4i6cy4+5mS/FFGBJdwc6nWeHzINSM1ytIqDhIWuL8=\n-----END RSA PRIVATE KEY-----\n\"}}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e992ab-1532-46ed-8400-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e992ab-1532-46ed-8400-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e992ab-1532-46ed-8400-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    node_ip:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"zabbix_server\": \"\", \"noinput\": \"\", \"additional_description\": \"very long phrase to destroy format table style\", \"zabbix_metadata\": \"\", \"num_instances\": \"1\", \"os_distribution\": \"ubuntu\", \"num_cpus\": \"2\", \"mem_size\": \"3 GB\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e9941b-98da-1e23-8400-024283ff312a','2019-06-21 11:56:00','2019-06-21 14:21:40','a3abf17e-941b-11e9-a582-fa163e0663d5','','DELETE_COMPLETE','{\"node_creds\": {\"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqQIBAAKCAQEA7mL5pXcS1ncrlkSmgsQgSqkA57HdXAaDJnSCbxt56YApUpxA\nmY3I646/tfk+y+NNytBmWwVACkWg2rcp8jAlOv8WYyyKt5NIatw16rNtbCWbJiMv\nsteKSNWP9LjMUk+mID04AYNsZZp2LxR5OnSyfiv+x89zA8CHKrLtUhYhfn+9Dbav\nUSmO6qRCbaOAUqPOVuOkE9JJN/XXpCrnarDDR55T+F1uwfF6i4MfnWq1oDJKZXtb\nWdVMd9lnBc1tDj5YAZee7XDpt3MQAIRE2rFB2OWFRdch5zZ6hqX3hbaB0hkv+CtV\nWhvIK4RU09Okrh8fIEMv/HEM4A/0j9CCC7DaEQIDAQABAoIBAQDcoAGIoBFxJ83R\nPywULkvsjUlnJfhGqUhMGNx21CkacCDOcgpfkxd22yCW3Fy/+lkO8Z0pdEx2tUZP\n5eEOYnyyg09G7fxcNhV5wOCtnO4SfyN+QmZs0IsNKYoX5chEDa8ke0QQMn/p8PCc\nVgh0j3h6yWD9sAM0X8U5QWve4tiQ5wLXCI1myYbb+er91ZQEhFv2/iPOsawUED8z\nRH7+LnQnvjuDtHQzYgskYCdfQ1Ok8Tm+qJjz6uKR+AW9/k3nPy4d1/wCLpK6nohX\n46qm0rgmZu+6b51sjWIHGspJ9db6HCNivtrJw0XH62k6q67Gm1FDLWYP4BDE0EDM\nhT5RnLmBAoIAgQD0MRCibmmShXHU0B4brFHAeOfB4l5lqdQYhPTsDav9rkk8oYTf\nYe0QSnvvYf0N+Q+8OhmdsWnaMh0GYq9MTquuZo98jh82uIzIHh/b0S6vEHiJLUmN\nR2AxLtB5s3e7BuHWS/GZYuzH+AB6S5XHMB8Shty87aBjV91T8Wv2H88E2QKCAIEA\n+eoMLhjA7KVZBrmerPDWxEDKBpaxEX52nmWfCHYgHs5XnkYoVuLsm7oSOOdiMjl4\nV3QLE09QVK6VQNA2BpcvXrOP1EOak+a6CSe0MgXiCD07bwKiOoeH9P7O7TwxFKx1\nszTFdyY36IbXv0IIBTUXk2NfeMAZZf1B+bJdYFf8W/kCggCAdUifmbR4RmSLkNBI\ntbflKBGqFohYGHIiKYiqbjn+0oAEMvfM7tGE4B82OXqR5UUrlpc9OG0+zwrkv+1k\nDr12XfRqlENaoJixHWjCmnx09KZvjktPGWkfvV+jx+A38H9Utu2Q48AMw9rMt/BX\nxuzI78gQezmSoERSTIAW/4a1krkCggCARY0kbKPI9VMjDqMUDO9N5fpd/y1rBAJd\nAsInW1R8pfYpHkxKJ7wpu0EylxGWG4IxAq2x82LMaXTY5tvLXVQwA7wXWCykVWsN\n9UROeul2OXLJGqDyAzX62W0cq5tn0WgZrZEPL5S8VINKgdjfoIthD0zFojZcGy07\nckF4iTqTagkCggCBAIYstOJ0yMFpWzhnAPMyVZA+q5heSLb3b4MsmK3aeK4gkWPR\nyaiFSNm+WZzPWp8cwxzdaakBkEnpDCMB2+IgjksUuU7UilmVKyofDyxbErNA4Oqd\ns/jy3G0L18lDcMpJvPPr1AVOuD4rM8wA55s2BalE+s9To+uwjXJxbnRLBv/h\n-----END RSA PRIVATE KEY-----\n\", \"user\": \"cloudadm\"}, \"node_ip\": \"90.147.102.96\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9941b-98da-1e23-8400-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9941b-98da-1e23-8400-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9941b-98da-1e23-8400-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\n\ntopology_template:\n \n  node_templates:\n   \n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            #private_ip: false\n            ports:\n              user_port:\n                protocol: tcp\n                source: 9000\n              other_port:\n                protocol: tcp\n                source: 9001\n              ssh_port:\n                protocol: tcp\n                source: 22\n        scalable:\n          properties:\n            count: 1\n        host:\n          properties:\n            num_cpus: 1\n            mem_size: 2 GB\n        os:\n          properties:\n            type: linux  \n            # The format of the image must be defined\n            # Currently this example uses the IM URI convention\n            # used in disk.0.image.url\n            # see: http://imdocs.readthedocs.org/en/latest/radl.html?highlight=uri#system-features\n            #image: ubuntu-16.04-vmi\n            #image: centos-7-1708-vmi\n            #image: ubuntu-16.04_2nic\n            #image: centos-7_2nic\n            image: centos-7-galaxy-base\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                #location: /export\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: 1 GB\n\n  outputs:\n    node_ip:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"noinput\": \"\", \"additional_description\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99443-287f-e24b-8400-024283ff312a','2019-06-21 16:39:00','2019-06-21 22:41:37','334c37b8-9443-11e9-b72e-fa163e0663d5','','DELETE_COMPLETE','{\"node_ip\": \"90.147.75.85\", \"node_creds\": {\"user\": \"cloudadm\", \"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqQIBAAKCAQEApeKxMskFQwKKeZmAo/LJN+0tzPBXVmtkT0tP7LvtWpcaJRoS\nlqEigjPa/xL2FvvpejjrArP580O+54FqqNlOJl0Vv50kektiW4X6NIMiMzRksnaa\nFurnAFfWFTF0NodePx4L4TCkyWvaShEFjXLp3Tk22vUth0U/XSgjxpb2wUF4JTaE\nAlPBJB7o4Xi35Vg5saVEzdL8KJQaSJuYTHV3Rhi1RkAbT7Jm4c5vCcfGhUmvuHDn\n4bhuc9yBVZ5qCmKN3zr5Ld4VNWSawgd5MObGEyTGpD21PmX3K8/kbjSTEnEVucJJ\nFFu5SkS+KM1cJc5L33e9k+5TRnq6C+0+rHlA0wIDAQABAoIBAAMAgThsDt5Rk3Pz\n5TISWLXcYvHMf6getWgB8uZT2E3FYkG9oQx8ygUVLydijnWIBYeitA4Od72BQlkq\nLGX12MY09QnMrDZSWutRF2AP53SJxDC+mLdFdPy6mjMz++hotrnpr0lZ+gFzJDYm\n7LTMmZLZUDbSLQq/pA/phAw5+ykwIJ+ZlI+PflCUqflODbYPQVwc5T/vB26oYvvw\ndfU9L/qUZRYhJkw+H+m4mTIbtpyAb1Y1KI7zvjzRKw4skdfdk1fzLBrFmzB71Xs5\n9EOXHDnXgd0KCtgcWmtoOQxOSaqBZi8wlTcHLg35JJvWSLxOpdAVCROwu55Vi5Zt\ndWMPaaECggCBALqK2H5jxVvUlesCos+ZxWSlIEzzyNk5iMsFcHuKd8UtuYrwGjqx\nVLuaynqp5Cvzm5IwuLVln4PDmGqt5UmVEAgR65PcQY+LJ9aB3U793dobI64cPXtX\nRGMrY7Do45+/auWIzE38uFpnspm5T2jNgx1lzml5N04ogurBf1wa5a4JAoIAgQDj\npte6Qbp01gPoSsFl5XulRCdtGJOOEFMMtbCH4o2fJomLW0cGvVt6GLZ7WFqZOkAQ\n3z+WLzBnVHEDXtijK6BmY9z7kEVTkWjO0Hm1Tl4Bx7YLB84sfKx42yhTWkoMn6Mt\n59ZhDus7PInQeTp7NCnqG8x6XoiLlADkczcZSHIu+wKCAIBdx32NFLVcNCRmMD4P\nZfvRXB4/8XLwmbcGcaaZxQPvUcxsZ8aX6Rxy8B+IyS4XVnHIbcv+DafCwys1vlR9\nyH11wSSQgfNHqaqOcV0D4CaPBoPKfRH/luCfhmmov3vnjIC+AibLshgwAt/L3lho\nlKCsv8ikR7chCMbAJCTV9gOvmQKCAIEAquAI/V1ov1oFBM9X60wdSyelEFZqKzBF\npjyajOSYuOUMSPXykjR//V2fW2YuWuVGQWPRLsGs62KOkaEXqyKL+07qCEl6QAfd\nS59gO57fISbulcj+EJZkPzMBSc9z1ZXdvg9O8vtnxcbjCwBzzRaSf47uJMvgYiRt\npwx0Rx4B1xECggCBAJTvW8V7d0WOdtGTa8t6MpktFD1UZRmPHrXrhpWzx9vQqRN5\nXtIy+nY97zlRHzW3/SRNuidRJoP+Dt9s5+gnV8JtiXyZA8p1Ydpi55XDa79q7jxy\ngKwpk46h5VZzHlPWzpsMGCLjAyu1/3acdpcH0U/kQaIGQHC3nQR6ApNmKHW4\n-----END RSA PRIVATE KEY-----\n\"}}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99443-287f-e24b-8400-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99443-287f-e24b-8400-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99443-287f-e24b-8400-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\n\ntopology_template:\n \n  node_templates:\n   \n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            #private_ip: false\n            ports:\n              user_port:\n                protocol: tcp\n                source: 9000\n              other_port:\n                protocol: tcp\n                source: 9001\n              ssh_port:\n                protocol: tcp\n                source: 22\n        scalable:\n          properties:\n            count: 1\n        host:\n          properties:\n            num_cpus: 1\n            mem_size: 2 GB\n        os:\n          properties:\n            type: linux  \n            # The format of the image must be defined\n            # Currently this example uses the IM URI convention\n            # used in disk.0.image.url\n            # see: http://imdocs.readthedocs.org/en/latest/radl.html?highlight=uri#system-features\n            #image: ubuntu-16.04-vmi\n            #image: centos-7-1708-vmi\n            #image: ubuntu-16.04_2nic\n            #image: centos-7_2nic\n            image: centos-7-galaxy-base\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                #location: /export\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: 1 GB\n\n  outputs:\n    node_ip:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"noinput\": \"\", \"additional_description\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e994be-8f62-bb1f-8400-024283ff312a','2019-06-22 07:22:00','2019-06-23 06:54:42','987d56d2-94be-11e9-8ead-fa163e0663d5','','DELETE_COMPLETE','{\"node_creds\": {\"user\": \"cloudadm\", \"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqQIBAAKCAQEAkZRRSkuIs88ogH2B7W+wlkCxzjlX4HB2r0hHBG3pV5WoSjB8\nbVrA2Jrd/vco9kwcopZ8pdxkg9Hmz6nuf9B+De5pU3LEqvEhPCVN1YLZf5g6oXzj\nN5eT7uKVuwpDkW8Kiv6w1BPi1A6Od9bq3sHxTBZuZmuMKwg4XIIl8SQTBbGiWArI\nkerQSH4Yx+835gzGu9hKM+nADdUW3vQkOKaq6iE0Y2fZWluxFraoNyhqFBCthEKZ\nmXhjnhn6r0nNauHHX2iKdEOrnYxMR7hbaRvcJRfkP2dMhXegj9IrtnKcd61dUSJF\nNXuye6VwwdgJ9hYjOtuib+40a8sx22iFlf+H1wIDAQABAoIBADCa3X05tN2b58Dm\npo+Yv9OarALXgHCN/AJP1m4zKDo23GZQw+pa55IqOr5a1RFOnizmo51Y9TJRzYc+\nDEQeX0fVdtMGuYT9VwRWzCLiOi3wrHqoUNCJyjly61z0c1TGRzXbDTzxmsUESyrV\n1bsj86Vcw+VsOPNRHkg8p+BYFAXNJSPyExuIhIBhJN8+p9nn1XpLZmLk914r3Ewp\nTKgc9yhBeHWP8bO60By4MBFllpjR/SvyxYThZQ5jlPr7DsbiV3Bc+1+HQ5+WuV0o\nbXrtHR8Ki5lqTAoOBAlqBrhaYdAUL6HvadCiFlPwhCaIW92o2JOr3JqCe2LTQM5/\nILnBDbkCggCBAL6ErPVvYB0EDduOHg5wEyLkIBgtRAyhWieznrbtSwsomKDdXHKl\nc/Pfsvn/ZWoUi7WJLqa4VktFERXWanc78bAO8voA/OqSFVr6sIR4qfWvfDSOS9Ki\nBK2BLYNOOSQRFrlYOx5yHtYf7pxr/3QzAmwRvw8v6XFzmaZ4iuT3a2p9AoIAgQDD\nnY6rj0JiY41MU1bpRR8BE12h1gf2kQD7vAQpzlQEH+s+I6JS1TCzMZsKl2YO3RSa\n+CRYn6a5Gn4evfx1vOxj5FZ+Olyhchz/CaShfbkRkh/EkIBqVeTzIlI+c1+BAZvZ\nqRleherWIjxSRRASX/AEX0mdmZQSYhRer0zgdEB34wKCAIEAmhNgcSk+eJjTwDDi\nG9kFkN0fG45YD0LaT2tTOysS2pZdQRNkdY9bA+pwqv+h+7Vb+1dTNB+2Ii9cDuYV\nuhHvduvQEuGDqQy1WpuM78VJ5liiQTqnFVRUJiFnNl6nlYSAdSpmvUubpp2ycixh\nLo8mMVH0ywp7Z3YO1/N6mIuEAl0CggCAXN3K4qWjZWRPq2GRTDM1ceRIulEK/MKA\nTgJHk7VRa5ffrWNrZ5mwghHVwiR4HixU4PFXB//bPdtW7q9RUG/9Zbr8WPbKDRdI\nrsdcMhKmrrHJhR746AKZK9gqZV2OhIdH/wBpe9dl0nz0WDZTV/XV062NHFXR1xxb\nAUyF2bU2+fMCggCBAIqtUg4YRQXM32jCGrseMUq9N6ZRJGo9mdTykMWUbVBnjv7O\n1MmLkZn8cNy9ivBEa4XfyYSD+0hcFkN1MIsdxAMs3L3WGm+hrh+h9dCjO1u1aUj6\nfl9VjN6GWQwYjyTobfHufhojCWKUC2xFL9/3Zacb/KsuTN4VFkxEy5yvhZui\n-----END RSA PRIVATE KEY-----\n\"}, \"node_ip\": \"90.147.75.6\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e994be-8f62-bb1f-8400-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e994be-8f62-bb1f-8400-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e994be-8f62-bb1f-8400-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    node_ip:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"mem_size\": \"3 GB\", \"num_cpus\": \"2\", \"noinput\": \"\", \"zabbix_metadata\": \"\", \"zabbix_server\": \"\", \"os_distribution\": \"ubuntu\", \"num_instances\": \"1\", \"additional_description\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99504-086c-64c3-8400-024283ff312a','2019-06-22 15:40:00','2019-06-22 22:40:18','','','DELETE_COMPLETE','{}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99504-086c-64c3-8400-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99504-086c-64c3-8400-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99504-086c-64c3-8400-024283ff312a/template\", \"rel\": \"template\"}]','9c3c7f53-7279-4008-82be-60600418c884','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    node_ip:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"num_instances\": \"1\", \"num_cpus\": \"2\", \"zabbix_metadata\": \"\", \"zabbix_server\": \"\", \"mem_size\": \"3 GB\", \"additional_description\": \"\", \"noinput\": \"\", \"os_distribution\": \"ubuntu\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e9953e-b3bb-7ab0-8400-024283ff312a','2019-06-22 22:40:00','2019-07-10 13:02:36','','','DELETE_COMPLETE','{}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9953e-b3bb-7ab0-8400-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9953e-b3bb-7ab0-8400-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9953e-b3bb-7ab0-8400-024283ff312a/template\", \"rel\": \"template\"}]','9c3c7f53-7279-4008-82be-60600418c884','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    node_ip:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"num_cpus\": \"2\", \"mem_size\": \"3 GB\", \"zabbix_server\": \"\", \"num_instances\": \"1\", \"additional_description\": \"\", \"zabbix_metadata\": \"\", \"os_distribution\": \"ubuntu\", \"noinput\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,NULL,NULL,''),('11e99548-39ac-f1bb-8400-024283ff312a','2019-06-22 23:48:00','2019-06-23 07:54:04','46c58b9a-9548-11e9-9fe8-fa163e0663d5','test galaxy','DELETE_COMPLETE','{\"galaxy_url\": \"http://90.147.75.74/galaxy\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99548-39ac-f1bb-8400-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99548-39ac-f1bb-8400-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99548-39ac-f1bb-8400-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: true\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: luks\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    galaxy_url:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"vault_secret_key\": \"luks\", \"instance_flavor\": \"medium\", \"refdata_provider_type\": \"cvmfs_preconfigured\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"iam_client_id\": \"iam_client_id_for_luks_client\", \"refdata_cvmfs_proxy_url\": \"DIRECT\", \"refdata_repository_name\": \"elixir-italy.galaxy.refdata\", \"refdata_provider\": \"not_a_provider\", \"admin_email\": \"admin@admin.com\", \"noinput\": \"\", \"storage_encryption\": \"False\", \"admin_api_key\": \"not_very_secret_api_key\", \"storage_size\": \"50 GB\", \"flavor\": \"galaxy-no-tools\", \"refdata_dir\": \"/cvmfs\", \"refdata_cvmfs_proxy_port\": \"80\", \"refdata_cvmfs_key_file\": \"elixir-italy.galaxy.refdata.pub\", \"instance_description\": \"INDIGO Galaxy test\", \"vault_wrapping_token\": \"not_a_wrapping_token\", \"refdata_token\": \"not_a_token\", \"reference_data\": \"True\", \"iam_client_secret\": \"iam_secret_for_luks_client\", \"version\": \"release_18.05\", \"user\": \"galaxy\", \"additional_description\": \"test galaxy\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"vault_url\": \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\", \"export_dir\": \"/export\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\", \"refdata_cvmfs_server_url\": \"90.147.102.186\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99583-2fdd-a502-8400-024283ff312a','2019-06-23 06:50:00','2019-06-24 11:44:42','3c4e5224-9583-11e9-9fe8-fa163e0663d5','','DELETE_COMPLETE','{\"endpoint\": \"90.147.170.236\", \"node_creds\": {\"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqQIBAAKCAQEA9gfu095+tS9cE6y7l2XRUprm9ZRO4zvzvO0VaUIn830FnRXp\nPMw99xABCy/xu09vqbNrY//vESsDBTspJshL0KeTk/PuQg3eQgIJAfoT1E3pjn14\nnJgn1PvJNFzLsrkHf8EGBjBCNkY1xx0QfFbEDrcs1Y9eK6MZmEYy4+E1mImaiQM5\ng9umv2e6onte4EirQdJ3p1cUVgzA3cI45P7lPrfN+/R5W0fGFupg/5jPn1E+gWdx\nvNZnd1N8Ee0gi+AkpNU/XQVPd0f4n5cn2xRO0uMJmi108QMI93wmvCnoR1VfzQYi\nyfbKT2PskSiQXqfalTqT5mSe3+FD9Jj9eGU1fQIDAQABAoIBAQCITZTO5DEmh/pn\nHAdBtTLmpNLXszaRRaGfRWnbSr9/cgAuKvlwqWaa/c7WN9WghD3EspYIbL4xsLaX\nq1L9HXKDQpPMIBQbnDtKLn53Dej2ccO3IWQ0vUc0A9pQnCht93xkFrgTraDBGNyq\nVzvO5vLvhCPenPL7Ef0YE6wV+6sJufxBV0E9dWV2IkYCbCjITYczjTSKZpMHGcnU\ny8IesGpcl8tkkutxko4lCmsz3hRnjwGt0FidrHIafRdUe279dKROmvoAaB4UyIO4\nqKEVpaHSImLMS0fAOvuynNef00wbeUl49QxDjJIvZ7c6f5sdUAMToZ2ALJXchYyv\nFVKmOo4xAoIAgQD5Ev5JxzT5H4hTByIMprAejlWXZ/glqUbEuQVQzN1NqVkkX1KB\n4QMialEh/W6iwRt92JwM/uewQ+aUgt1MxiXgbRHGrFx4AyQfvWH2lMJKR9mLwTto\nKolMcChapyiHxgmK7pn4uvTekl2I439cIovmtFIxusgYqzGjIkpIYcCWCwKCAIEA\n/N9G4qyAE2KBJhYEb3CwRZ8fTBljLlFOB8XvmGcx6hIRo8yldroMr7EM/Xn2cuKH\negEydXr4gPIOYgi18pBeray6IcW2XJDyAjieqPPreY9EHo7tAFAdp1Y4yn962THs\nN1aigM6rlCryi0KNuQl2Zby33bc7Avf/PLlcmWygP5cCggCBAPg1Kj0hjDOabcK3\nwAG1dprsonTgQhRdzU0rSBXOIddLpK6vY0xUjEgWhMWHhWIhaCEP4+q7du1brQNg\nKeJhL8unRWijyP47uxr6Ig6VDczyLuOra2URxoLq3fwAyk4LVuUhg0SwImdOmnFY\nrEmHj70XAzXVeaPDrhJwkG/zIfUjAoIAgGamjLP/qo4z8pFvZqWGbUgV7DKMK8Ll\npnNpWnXXjl+irh58OL8Vj4jSqp9LH0xLwQs56S3fmXleyY/qUVICYSzHbVfAVuME\nw/k62s1jFzflfJWbF4KFA0Smr68kSM5agbWFKbp4KxaeyI7XmYh/2tw527nZY880\ntRwFcx2lBvhJAoIAgF8Wv1OI3FKH12HfcgdTIksv6jOOpS6A6RlMZ9Fzxd974fKa\nhHbgFJChxJD5EcuChA+zRyYsWUseSc67eA94bo3PtpUavgbFrmvb2Q9ICs+CJ8PU\nJBAJWoolpJSk0tZw2xMD2+XSw48zS8wfkJgY/cuDThBuo4e/NUfjQNPDrdNM\n-----END RSA PRIVATE KEY-----\n\", \"user\": \"cloudadm\"}}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99583-2fdd-a502-8400-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99583-2fdd-a502-8400-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99583-2fdd-a502-8400-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"noinput\": \"\", \"num_cpus\": \"2\", \"zabbix_metadata\": \"\", \"zabbix_server\": \"\", \"additional_description\": \"\", \"mem_size\": \"3 GB\", \"num_instances\": \"1\", \"os_distribution\": \"ubuntu\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e9958b-fd6d-927c-8400-024283ff312a','2019-06-23 07:53:00','2019-06-23 21:34:09','0bb9d814-958c-11e9-a582-fa163e0663d5','test galaxy 2','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.105/galaxy\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9958b-fd6d-927c-8400-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9958b-fd6d-927c-8400-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9958b-fd6d-927c-8400-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: true\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: luks\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"test galaxy 2\", \"refdata_provider\": \"not_a_provider\", \"instance_key_pub\": \"your_ssh_public_key\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\", \"refdata_cvmfs_proxy_port\": \"80\", \"storage_encryption\": \"False\", \"iam_client_id\": \"iam_client_id_for_luks_client\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"version\": \"release_18.05\", \"iam_client_secret\": \"iam_secret_for_luks_client\", \"storage_size\": \"50 GB\", \"refdata_repository_name\": \"elixir-italy.galaxy.refdata\", \"refdata_dir\": \"/cvmfs\", \"refdata_cvmfs_server_url\": \"90.147.102.186\", \"instance_flavor\": \"medium\", \"admin_api_key\": \"not_very_secret_api_key\", \"refdata_token\": \"not_a_token\", \"vault_wrapping_token\": \"not_a_wrapping_token\", \"noinput\": \"\", \"export_dir\": \"/export\", \"vault_secret_key\": \"luks\", \"reference_data\": \"True\", \"flavor\": \"galaxy-no-tools\", \"user\": \"galaxy\", \"refdata_cvmfs_proxy_url\": \"DIRECT\", \"instance_description\": \"INDIGO Galaxy test\", \"refdata_provider_type\": \"cvmfs_preconfigured\", \"vault_url\": \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\", \"refdata_cvmfs_key_file\": \"elixir-italy.galaxy.refdata.pub\", \"admin_email\": \"admin@admin.com\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e995fb-4ef2-8f96-8400-024283ff312a','2019-06-23 21:10:00','2019-06-23 21:24:58','684cfb64-95fb-11e9-becb-fa163e0663d5','prova','DELETE_COMPLETE','{\"node_creds\": {\"token_type\": \"private_key\", \"user\": \"cloudadm\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqQIBAAKCAQEAzePqDALISPykmay7PTgNjkeYIkN2UAHJjXdeeNr+HDQEXX2X\nJO3twym7PfKJa/3ONMpBuvKQBwrsXNjqruuLJcMYF8hwWXYhNUGjTIryR6MI47C7\nbvaOZTKxUqijrhoY1RfTajWhbkcJRkv9XMLvEIrkKjm7A4mNdouiNx0QaoUkPTKf\nCzcAbF7nmVCVJh1z1uIYpRq8pXiE/vvYeZhuAfIh4T3vQAN+DOv1sHUi+z4wMYCr\nYtONwvFu9CJ8B6sFxKjjk/90e7qAznuHrvkDkUjJtiy5O2CzzB/yqbOjvwITOYwF\nUkLjtOIeOLTeo9Xy/uZOxX62w9Nro/WS2mGgEQIDAQABAoIBAQDD5mjqNreFIsYm\n5kBd1nineR2a9F+dbqXs8bg0/AGuqhvBLN9kJvMEsC9VmPECjMLoXc2+6E78NHuD\nOG3MM5f5PTEuZ+vmY0zjlGmhSc+PM+QgaSdeREBmr54jDQx4eqJIF1x0gUTxXavI\ndENFQMEhF1ZTiwyTKA0uz1twXzogboj/A+377+7b3MBhKLKcLflDAV0zwHuqfddQ\nw/YbyGG1k0Sb5xDL6BsmdhjC7a9qWGkAccDjRJFPTkDeFcDPQo4Y9gSnSqLlTHBS\njKzCZAbuGmvh9UGKeIojYG9+S5EwjdfxXATq6HqlrUG6Qy8JPnzaMT0hVMgOhxmW\npJWBlDmxAoIAgQDN++g9q08A0hBCzvRdH/xrQTQgD6lX+xudF7TqFeojf9HuIMzT\nwTlUxYY/A4GDdiJg7Nag51xGhdXPHH3NM1/+qk6x9d8cLGrheRpNZvqUOEJwYbui\n6CeMQ7Kqsk+ySyrkzRKwYrxlBOKTZLZLkXBrFJ9FRhAiRr7id7KqQutxTQKCAIEA\n/+IuY8oF1Usdovr4zKsdOumsYJXQT/MkKGaYs/RKkavemOMrsdSt1GbTwwdTcQv5\nwhHqE1ROi9pH05Gkz4U89hFKjtZrFkRA+uJCrqkfz3uznO6KjQidmTx5iUe5eAXO\nw2Qk7pWacuu5T0b5e4rG4sTQvjPZEXfCTNuGJFhQR9UCggCAWKB4joA039+CS5yM\nG711eBh3+wuCC27ptK/MkaOYOGn4w4KtXrcWmdjbKCW0BgJATH/a4SRq2ZUgJ5rU\nrgPa29IfRgbKVm7uFdFrdb5HNpr2SzBh8Xf9/CXsq/FIxSf+bq+lyOrSsIxniI+e\nt+j9+7TFyqKYsobJ/tsNrqBYeUkCggCABrcw8H2E2aw3AugDT5vOEJXBaGeGKBMB\nh+3pZA+tRVV1ah3ML8adKU3pkNzIW9csnuNJeWhlB1abO/o+kRO2Hd8mTcli1hrE\nedEmXt8hbpiYhi3chQcM29Cyf9/aBkRgwNAICBr1Cr8VBfee5Jcn0RvJPrStpb+2\n4b2BL8MBmGECggCBAInPKZG1M898uVd4bd/tcO3JYpixZGdNzI8mBlrlY4hiDRyw\n3SwdsCR7fHpMkU5UdJ/BQdDQcTNQ/UJVzlKABIAdeUM2Jp0qiMNDZtYiWEqv9eRJ\nkpbNq6c1K2/vn7MFPXH0xd/U5smmtxWvsWNfM5iKo6Luy9QJd+QmgzfeoWBP\n-----END RSA PRIVATE KEY-----\n\"}, \"endpoint\": \"90.147.102.44\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e995fb-4ef2-8f96-8400-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e995fb-4ef2-8f96-8400-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e995fb-4ef2-8f96-8400-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"num_instances\": \"1\", \"additional_description\": \"prova\", \"zabbix_metadata\": \"\", \"num_cpus\": \"2\", \"zabbix_server\": \"\", \"mem_size\": \"3 GB\", \"os_distribution\": \"ubuntu\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e995fb-c65b-8fc7-8400-024283ff312a','2019-06-23 21:13:00','2019-06-23 21:34:43','d81cc5a0-95fb-11e9-9fe8-fa163e0663d5','vfergervdssd','DELETE_COMPLETE','{\"node_creds\": {\"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqQIBAAKCAQEAn88W4Q7SotBBboVCbk1YpQ8QWe1uYw23mln/pqF5CbbZnWvu\nvVmICh6V207jqpkcDsY3NSfFN1fIsIF7cY4jBrOccxRDVkByLUfyNDiEQ0nJCjOZ\njF3+mBgv7Q+WBjTm//sxoKpBY3AM3InqI1qZTGa6KQ4odEFRKioJjrsplgfTOWE5\nRklqCBhO/9wVS54Psa7Uh+x0Dg/gNM7du96lVzVjdP9KmCIeKYLYr9LWYhLfVOEr\ne0P1ylps3IcEkL9/EMqDBjq2JHeEKiUxRjNAb6I8Mu5He7VdEi8hLEYf5ymo6bu6\nQKDFhSzRD93J4pTtT547hDFhFpB5WG3MMRyeXQIDAQABAoIBAFHsG1JsAtar458A\neTmKNPMIcd1ntbrZgVGC6WdGR4IPVic4+T3f87kcTL4MBvGhY5y/R/Xb2WGxgpPZ\nDKr9rj71PDJSJOLGTsGfrC3Q+xxzarfsE769QJI/c/IWl1W/MNvwrVQrczHCcxVr\nLbfJ7eQYlT4On/ZYtX7j5dphX8Qklq7A00aHBNe/pX8co5v6sasGYzx5Z+9fE4fA\nBIN9MLp9F4vR/wStXk2QI9r1zRph3519O5sqsd8tpNmBRWFvG4Q9vtfefwZBh0Hl\nNt7AEAB72RWhManr0tcce9vxoK8gr7FC6r8tfgMfV8425ow862/byI/0vtG8nmBv\n5NGsmYECggCBALoZIDGkb+wkCf8LaOCyifpYik/bhgB7iSg6Ysp+FUJ4qf2M34SK\nB5ss+LX9EPMkvKjlcERcT4rJLT+x6XsmgfQcsxnyKMxbNy7S0JQKPz6SCsyDavuQ\n16feWp6E6HrEuDO21T+tN5ODMxFJgiTQRlHwAgekOIWr/gREwDafTUo1AoIAgQDb\n1goW9/AFadvMOwZm+fTMbWlLQhTqMaNwY9r1b5PkeNHKe7IV7B2ZD+ArVLbqGJ3L\nZSHkChbKkzV/SRwJWUJpjXTOvyxom1/9iH2qKGx5GTYSYCgTaiNwmbqzqXzxa3Zf\nwbV3mnMvBBlNzIZXWsL7OgEG0+RiTRJpJrXtGH1IiQKCAIBsRgYXG+cKawVt4EOK\nyBXDFBSU1dInIbjxMNcdnTHdVLsCjB3XzT8Tp5yktbJQ5MTnN2aUP2kABIBRGMAR\nKJxfXPtPUzctfryif4FfQH7/dpTV3Hg4GVN/lbz/kbB5DU9mty9nNu6o4qKpoi0Y\nIh1nus5Th9Zi32iRLzbuEM01KQKCAIEAgpKZH5dYev6rTJzqapOgcSOzXL39SjT9\njK3iydDiGNwiT5A08Ixz8Avb7CC/HEBOyRZikN3lN6FELzwvaOYZajRY4svuBpvy\n4dYGPeEQvMTatwNiClYKgsDsgfXzfjmD79BQhp+4Nn7KwMjwKkaAdVO4dGO6zSBW\nBRq3CAJ5t3ECggCBAILpAC1GtCBHXfc2qQkCoFHUKs0DKZggVc/RhNz93aUK8cSi\nsxfzsm/POSmMDSbo549h8y725bxOLDa3I1y86s74d7+yGhSkMJDRpiAl5T1HGsam\n0SIpvu6ypOz0eAu5ODAWV0iFF3DBv6Xn/D6uaA2P28koToB7Tof6u/Zb7LS/\n-----END RSA PRIVATE KEY-----\n\", \"user\": \"cloudadm\"}, \"endpoint\": \"90.147.102.53\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e995fb-c65b-8fc7-8400-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e995fb-c65b-8fc7-8400-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e995fb-c65b-8fc7-8400-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\n\ntopology_template:\n \n  node_templates:\n   \n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            #private_ip: false\n            ports:\n              user_port:\n                protocol: tcp\n                source: 9000\n              other_port:\n                protocol: tcp\n                source: 9001\n              ssh_port:\n                protocol: tcp\n                source: 22\n        scalable:\n          properties:\n            count: 1\n        host:\n          properties:\n            num_cpus: 1\n            mem_size: 2 GB\n        os:\n          properties:\n            type: linux  \n            # The format of the image must be defined\n            # Currently this example uses the IM URI convention\n            # used in disk.0.image.url\n            # see: http://imdocs.readthedocs.org/en/latest/radl.html?highlight=uri#system-features\n            #image: ubuntu-16.04-vmi\n            #image: centos-7-1708-vmi\n            #image: ubuntu-16.04_2nic\n            #image: centos-7_2nic\n            image: centos-7-galaxy-base\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                #location: /export\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: 1 GB\n\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"additional_description\": \"vfergervdssd\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e995fc-3829-c758-8400-024283ff312a','2019-06-23 21:16:00','2019-06-24 07:39:01','446b1c20-95fc-11e9-8ead-fa163e0663d5','vault 1','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.102.63/galaxy\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e995fc-3829-c758-8400-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e995fc-3829-c758-8400-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e995fc-3829-c758-8400-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: true\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: luks\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/d1f0449c-6389-4181-ab89-ef62740f4ef6\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"flavor\": \"galaxy-no-tools\", \"admin_email\": \"ma.tangaro@gmail.com\", \"instance_flavor\": \"medium\", \"instance_description\": \"vault 1\", \"additional_description\": \"vault 1\", \"version\": \"release_18.05\", \"vault_wrapping_token\": \"s.7EJiHbJm8hFheZLMfC9uSz1q\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage-encryption\": \"No\", \"storage_size\": \"50 GB\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99652-0437-a17b-8400-024283ff312a','2019-06-24 07:31:00','2019-06-24 07:41:14','133f8270-9652-11e9-9f65-fa163e0663d5','prova toggle off','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99652-0437-a17b-8400-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99652-0437-a17b-8400-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99652-0437-a17b-8400-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: true\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: luks\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"instance_description\": \"ELIXIR-ITALY\", \"storage_size\": \"50 GB\", \"flavor\": \"galaxy-no-tools\", \"instance_flavor\": \"medium\", \"vault_wrapping_token\": \"not_a_valid_wrapping_token\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"admin_email\": \"ma.tangaro@gmail.com\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"additional_description\": \"prova toggle off\", \"version\": \"release_18.05\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99652-424d-0891-8400-024283ff312a','2019-06-24 07:32:00','2019-06-24 07:41:15','4de2d954-9652-11e9-b51f-fa163e0663d5','','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99652-424d-0891-8400-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99652-424d-0891-8400-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99652-424d-0891-8400-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: true\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: luks\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\", \"storage_size\": \"50 GB\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"instance_description\": \"ELIXIR-ITALY\", \"vault_wrapping_token\": \"not_a_valid_wrapping_token\", \"version\": \"release_18.05\", \"additional_description\": \"\", \"admin_email\": \"ma.tangaro@gmail.com\", \"instance_flavor\": \"medium\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99652-72fd-7b2e-8400-024283ff312a','2019-06-24 07:34:00','2019-06-24 07:41:15','7dc10772-9652-11e9-9fe8-fa163e0663d5','test encryption on','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99652-72fd-7b2e-8400-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99652-72fd-7b2e-8400-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99652-72fd-7b2e-8400-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: true\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: luks\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/fbffd710-cb27-4f93-a5f7-fb9ed882fab4\", \"storage_size\": \"50 GB\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"instance_description\": \"ELIXIR-ITALY\", \"vault_wrapping_token\": \"s.9kMf9GU0qcRXrgu7x9NrQ1gq\", \"version\": \"release_18.05\", \"additional_description\": \"test encryption on\", \"admin_email\": \"ma.tangaro@gmail.com\", \"instance_flavor\": \"medium\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99653-e884-30cd-8400-024283ff312a','2019-06-24 07:44:00','2019-06-24 08:11:20','effe736e-9653-11e9-ae05-fa163e0663d5','','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99653-e884-30cd-8400-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99653-e884-30cd-8400-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99653-e884-30cd-8400-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: luks\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"vault_wrapping_token\": \"not_a_valid_wrapping_token\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\", \"instance_flavor\": \"small\", \"version\": \"release_19.01\", \"flavor\": \"galaxy-no-tools\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"admin_email\": \"ma.tangaro@gmail.com\", \"instance_description\": \"ELIXIR-ITALY\", \"additional_description\": \"\", \"storage_size\": \"50 GB\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99654-1707-3c13-8400-024283ff312a','2019-06-24 07:45:00','2019-06-24 08:11:21','1ff9d2ca-9654-11e9-9f65-fa163e0663d5','','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99654-1707-3c13-8400-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99654-1707-3c13-8400-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99654-1707-3c13-8400-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: luks\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"flavor\": \"galaxy-no-tools\", \"storage_size\": \"50 GB\", \"instance_description\": \"ELIXIR-ITALY\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"version\": \"release_19.01\", \"instance_flavor\": \"small\", \"admin_email\": \"ma.tangaro@gmail.com\", \"vault_wrapping_token\": \"not_a_valid_wrapping_token\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"additional_description\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99654-5b33-a0c3-8400-024283ff312a','2019-06-24 07:47:00','2019-06-24 08:11:21','62cdf5fe-9654-11e9-becb-fa163e0663d5','','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99654-5b33-a0c3-8400-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99654-5b33-a0c3-8400-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99654-5b33-a0c3-8400-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: luks\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"storage_encryption\": \"True\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"version\": \"release_19.01\", \"admin_email\": \"ma.tangaro@gmail.com\", \"instance_flavor\": \"small\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"instance_description\": \"ELIXIR-ITALY\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\", \"additional_description\": \"\", \"vault_wrapping_token\": \"not_a_valid_wrapping_token\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e9965a-a3c5-e81f-8400-024283ff312a','2019-06-24 08:32:00','2019-06-24 09:44:41','abd7a500-965a-11e9-a582-fa163e0663d5','encryption false','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.99/galaxy\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9965a-a3c5-e81f-8400-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9965a-a3c5-e81f-8400-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9965a-a3c5-e81f-8400-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: luks\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"encryption false\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"vault_wrapping_token\": \"not_a_valid_wrapping_token\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e9965a-be38-feb4-8400-024283ff312a','2019-06-24 08:33:00','2019-06-24 09:44:41','cab3349e-965a-11e9-becb-fa163e0663d5','encryption on','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.102.102/galaxy\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9965a-be38-feb4-8400-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9965a-be38-feb4-8400-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9965a-be38-feb4-8400-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: luks\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"encryption on\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"vault_wrapping_token\": \"s.vR2We2oEPKkThhjHXg54PBqk\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/108b8943-08eb-424c-9de6-5c4e620986d6\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99663-6fb1-e97b-8400-024283ff312a','2019-06-24 09:35:00','2019-06-24 09:44:41','7c547e80-9663-11e9-ae05-fa163e0663d5','','DELETE_COMPLETE','{}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99663-6fb1-e97b-8400-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99663-6fb1-e97b-8400-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99663-6fb1-e97b-8400-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: luks\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"admin_email\": \"fasas@safsa\", \"instance_flavor\": \"small\", \"additional_description\": \"\", \"version\": \"release_18.09\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"instance_description\": \"ELIXIR-ITALY\", \"flavor\": \"galaxy-no-tools\", \"storage_size\": \"50 GB\", \"vault_wrapping_token\": \"not_a_valid_wrapping_token\", \"instance_key_pub\": \"saff\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99664-dee9-f097-8400-024283ff312a','2019-06-24 09:45:00','2019-06-24 11:00:57','','deve andare in errore','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99664-dee9-f097-8400-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99664-dee9-f097-8400-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99664-dee9-f097-8400-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\n\ntopology_template:\n \n  node_templates:\n   \n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            #private_ip: false\n            ports:\n              user_port:\n                protocol: tcp\n                source: 9000\n              other_port:\n                protocol: tcp\n                source: 9001\n              ssh_port:\n                protocol: tcp\n                source: 22\n        scalable:\n          properties:\n            count: 1\n        host:\n          properties:\n            num_cpus: 1\n            mem_size: 2 GB\n        os:\n          properties:\n            type: linux  \n            # The format of the image must be defined\n            # Currently this example uses the IM URI convention\n            # used in disk.0.image.url\n            # see: http://imdocs.readthedocs.org/en/latest/radl.html?highlight=uri#system-features\n            #image: ubuntu-16.04-vmi\n            #image: centos-7-1708-vmi\n            #image: ubuntu-16.04_2nic\n            #image: centos-7_2nic\n            #image: centos-7-galaxy-base\n            image: centos-7-galaxy-base2\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                #location: /export\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: 1 GB\n\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"additional_description\": \"deve andare in errore\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99666-6ca0-83fc-8400-024283ff312a','2019-06-24 09:57:00','2019-06-24 10:59:03','','errore 2','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99666-6ca0-83fc-8400-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99666-6ca0-83fc-8400-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99666-6ca0-83fc-8400-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\n\ntopology_template:\n \n  node_templates:\n   \n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            #private_ip: false\n            ports:\n              user_port:\n                protocol: tcp\n                source: 9000\n              other_port:\n                protocol: tcp\n                source: 9001\n              ssh_port:\n                protocol: tcp\n                source: 22\n        scalable:\n          properties:\n            count: 1\n        host:\n          properties:\n            num_cpus: 1\n            mem_size: 2 GB\n        os:\n          properties:\n            type: linux  \n            # The format of the image must be defined\n            # Currently this example uses the IM URI convention\n            # used in disk.0.image.url\n            # see: http://imdocs.readthedocs.org/en/latest/radl.html?highlight=uri#system-features\n            #image: ubuntu-16.04-vmi\n            #image: centos-7-1708-vmi\n            #image: ubuntu-16.04_2nic\n            #image: centos-7_2nic\n            #image: centos-7-galaxy-base\n            image: centos-7-galaxy-base2\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                #location: /export\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: 1 GB\n\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"additional_description\": \"errore 2\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e9966f-54bf-c1d1-b68d-024283ff312a','2019-06-24 11:00:00','2019-06-24 11:27:10','a26abfae-9671-11e9-ae05-fa163e0663d5','','DELETE_COMPLETE','{}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9966f-54bf-c1d1-b68d-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9966f-54bf-c1d1-b68d-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9966f-54bf-c1d1-b68d-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\n\ntopology_template:\n \n  node_templates:\n   \n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            #private_ip: false\n            ports:\n              user_port:\n                protocol: tcp\n                source: 9000\n              other_port:\n                protocol: tcp\n                source: 9001\n              ssh_port:\n                protocol: tcp\n                source: 22\n        scalable:\n          properties:\n            count: 1\n        host:\n          properties:\n            num_cpus: 1\n            mem_size: 2 GB\n        os:\n          properties:\n            type: linux  \n            # The format of the image must be defined\n            # Currently this example uses the IM URI convention\n            # used in disk.0.image.url\n            # see: http://imdocs.readthedocs.org/en/latest/radl.html?highlight=uri#system-features\n            #image: ubuntu-16.04-vmi\n            #image: centos-7-1708-vmi\n            #image: ubuntu-16.04_2nic\n            #image: centos-7_2nic\n            #image: centos-7-galaxy-base\n            image: centos-7-galaxy-base2\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                #location: /export\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: 1 GB\n\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"additional_description\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99671-d8e9-c2e2-a6d8-024283ff312a','2019-06-24 11:18:00','2019-06-24 11:46:08','','errore 3','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99671-d8e9-c2e2-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99671-d8e9-c2e2-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99671-d8e9-c2e2-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\n\ntopology_template:\n \n  node_templates:\n   \n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            #private_ip: false\n            ports:\n              user_port:\n                protocol: tcp\n                source: 9000\n              other_port:\n                protocol: tcp\n                source: 9001\n              ssh_port:\n                protocol: tcp\n                source: 22\n        scalable:\n          properties:\n            count: 1\n        host:\n          properties:\n            num_cpus: 1\n            mem_size: 2 GB\n        os:\n          properties:\n            type: linux  \n            # The format of the image must be defined\n            # Currently this example uses the IM URI convention\n            # used in disk.0.image.url\n            # see: http://imdocs.readthedocs.org/en/latest/radl.html?highlight=uri#system-features\n            #image: ubuntu-16.04-vmi\n            #image: centos-7-1708-vmi\n            #image: ubuntu-16.04_2nic\n            #image: centos-7_2nic\n            #image: centos-7-galaxy-base\n            image: centos-7-galaxy-base2\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                #location: /export\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: 1 GB\n\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"additional_description\": \"errore 3\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99683-8805-bc3a-a6d8-024283ff312a','2019-06-24 13:25:00','2019-06-24 15:28:23','a0a16364-9683-11e9-9fe8-fa163e0663d5','','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.170.40/galaxy\", \"node_creds\": {\"user\": \"cloudadm\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqAIBAAKCAQEA0IIH9j/CmtSpu0LTX1Z5u57g3HKCGffXN8FMQiZAbpqxMA+M\nzKluoyUFYbtJw70IN6UwKTSU6nUomAoJJX63w5W/2WIQYqNbI3RXnqKD653Zwx5k\nBoANZdLTqEBvwQfXhbjcisyAnT173k/i3XDFygCzfNfpU/1KAF6KggDK83CmPbIH\nwswGqC/1xeTjGAfWErwtxVyDowjp9U37n72qmNZ5XsUzNtWm270qMBJV7fzCKQ2J\nDKPuJX1wEvBDF8N1yYeocmn1+1mXGESXasfPzVwp+NqxLY5HqI5AUaj8tvsEpZj9\n03UN0ARhCIBQ0GDDfpjNqAB8o7iSRZG9R7z6OQIDAQABAoIBAE/SR7wEorplSWkP\n5x1rXITwCMM77wSD9dc5X7k/LZFqFQUCHvPGtT0tkgbdDRsrBbdPvMU5hPzQxy6V\nQPUisrTkYiKVQRKR2PUUt+pZ6sjLkC77Nm2qnfZqJG8X4/Bw0Rg3Me7M5TvM6tur\nl30QjBeN9yiG+6MUpzzG9J1aMlfJCdW0JwF7/Kq3/nPlud+1RRyO44hrFPXs+HLa\nRMXh/DrF8LhfXfsXzruA1+lAlDOYuwYoA5EN8bAFrKZM7gS5lxLt6IXogQ9bHvRJ\nlsw7UnOZETBGky3KIMD208gbG5xul5KseVii43rXBoTReqlR5AGMsX2810wl3eSM\nl9A9mlECggCBANVNkHh+FzQEoF/7WK+T3eRjWgVTFl5/9pyGKoTy8mpUtM05Cai/\n8c8alo46FCtFMZWyrhef7/mlE09146UoulVG+E1l3o4rWhh4Ny5W+8HyEMMBB0eQ\nnPv3f4e7ZQuGf79+UoAqwmWYJ3ToGJ6MPKKq2w2dXa8dyd6Du24x/gAdAoIAgQD6\nPsAjTpgBjvPyXCw1F+ld6s9D1HUrgQcTGf3jI3R3tyKq2Sxrp6KXkfktoKoqVL8l\nvUR/fA3klZAmTrB5eCV8LK0DXEk28DWM79G1OA9KFFvALOCM3O/XWTAPHWTPolo7\nB1ZeGQ7wHbdMOfSAjlDzHDNY24rnzDlPn9ApoQL/zQKCAIB4afol22Cz7+ytYpIV\nRE9ecCvQl7AoFuscP61fMlthZYJP3GQ0jG8wsFzP27+pEb3FOYKIObTaZLM7B11E\nznIqVA82ekyiS5zn9W2JTnd/bGzD+R+n6d6Fa5nmAQcw83PIocJnMjxd6ABWQfQs\nBRTx66wPyoeppRJh+FHmCnjOjQKCAIEAoYpUefZIRelELNW3a+atrQThG0ZRBO5b\n5MbIkBHZI1bDOErNVAl4+iMvGXc3oe/nHLObPjiUt1SdIz10ylT2zbwBS8QNNzvF\nNd+yHiu8IvQVbm8J3aTZ5sgaMAenhiml2akY5dGDRRnJs5lN7pbwRp+Tve6rMosx\nC+d8dwMLbpkCggCAcok8ye3Q2V3puj9Kg3oiiT1A657gAdg5LJFY+9yQVRnnNbCi\nnJg6XGXJV5mAWfBTTSt9+LNqeDuI7YXajGDLBA7waiWdjR7tDHWMsZ2UDKP5nGyA\nAL1lf8fzQF26Zjprc//6L/YM8BEAH5O9iG2IoeUmxwPM9f/b724Db3sNfqM=\n-----END RSA PRIVATE KEY-----\n\", \"token_type\": \"private_key\"}}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99683-8805-bc3a-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99683-8805-bc3a-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99683-8805-bc3a-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n- indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: \'TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\n\n  \'\ntopology_template:\n  outputs:\n    endpoint:\n      value:\n        concat:\n        - http://\n        - get_attribute:\n          - simple_node\n          - public_address\n          - 0\n        - /galaxy\n    node_creds:\n      value:\n        get_attribute:\n        - simple_node\n        - endpoint\n        - credential\n        - 0\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server_metadata:\n          get_input: zabbix_metadata\n        zabbix_server:\n          get_input: zabbix_server\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        host:\n          properties:\n            num_cpus:\n              get_input: num_cpus\n            mem_size:\n              get_input: mem_size\n        scalable:\n          properties:\n            count:\n              get_input: num_instances\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            type: linux\n  inputs:\n    num_cpus:\n      constraints:\n      - valid_values:\n        - 2\n        - 4\n      default: 2\n      description: Number of virtual cpus for the VM\n      type: integer\n    mem_size:\n      default: 3 GB\n      description: Amount of memory for the VM\n      type: scalar-unit.size\n    zabbix_metadata:\n      default: \'\'\n      description: Host metadata to be sent to the Zabbix server\n      type: string\n      required: false\n    os_distribution:\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n      type: string\n    num_instances:\n      default: 1\n      description: Number of VMs to be spawned\n      type: integer\n    zabbix_server:\n      default: \'\'\n      description: IP or DNS name of the Zabbix server\n      type: string\n      required: false\n','','',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99689-4d5b-f98a-a6d8-024283ff312a','2019-06-24 14:06:00','2019-06-24 14:49:16','56a36342-9689-11e9-b72e-fa163e0663d5','','DELETE_COMPLETE','{}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99689-4d5b-f98a-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99689-4d5b-f98a-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99689-4d5b-f98a-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','4d5b241a-a9cc-4fb1-8443-5385844363d8','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"mem_size\": \"3 GB\", \"num_instances\": \"1\", \"num_cpus\": \"2\", \"os_distribution\": \"ubuntu\", \"additional_description\": \"\", \"zabbix_server\": \"\", \"zabbix_metadata\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e9968e-9109-9fa9-a6d8-024283ff312a','2019-06-24 14:44:00','2019-06-24 14:48:42','9b5fe686-968e-11e9-9fe8-fa163e0663d5','','DELETE_COMPLETE','{}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9968e-9109-9fa9-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9968e-9109-9fa9-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9968e-9109-9fa9-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','4d5b241a-a9cc-4fb1-8443-5385844363d8','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"mem_size\": \"3 GB\", \"num_instances\": \"1\", \"num_cpus\": \"2\", \"os_distribution\": \"ubuntu\", \"additional_description\": \"\", \"zabbix_server\": \"\", \"zabbix_metadata\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e9968e-c3a5-8d9a-a6d8-024283ff312a','2019-06-24 14:45:00','2019-06-24 14:49:25','d3544c9e-968e-11e9-a582-fa163e0663d5','','DELETE_COMPLETE','{}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9968e-c3a5-8d9a-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9968e-c3a5-8d9a-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9968e-c3a5-8d9a-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"mem_size\": \"3 GB\", \"num_instances\": \"1\", \"num_cpus\": \"2\", \"os_distribution\": \"ubuntu\", \"additional_description\": \"\", \"zabbix_server\": \"\", \"zabbix_metadata\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e9968f-4233-c76c-a6d8-024283ff312a','2019-06-24 14:49:00','2019-06-24 15:27:49','4ae63ce0-968f-11e9-a8ac-fa163e0663d5','','DELETE_COMPLETE','{\"endpoint\": \"90.147.75.124\", \"node_creds\": {\"user\": \"cloudadm\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqQIBAAKCAQEAvXWF7v9R3PLcN7t608y0WCOg2EYbK05gGXB+Qi+Wd6WIZXsk\niW/ru28iQ+C6lkFcEtCNzgdjtdnAYksR8qGQDyRiMOfE5BvdntSdn5Mth8Eos+tl\nUkexzO8r3iUg8RsOLWhYCUG9Ij2eY6mbqJJrcHDHzZhP2roz2ycRrqi398m2Ivqd\n0353/DeR6CnCYT2JNLya1sajxrI09Q7kt9GbZ+aCDv1rUVdfkr9rECPLs6vGUkCI\nvBASgNCkGFstrSRvLz1yuklbyzKS3lOM4KCcOcsfD7j6ZpnkBDLRNkrG9NvrMKLV\n7ggE9hZ6rmI8nOxBkvNG+k/gbVevCEzfNOcwvQIDAQABAoIBAQCbQpNGv6+LnO7B\nMX+/0FK+pDvs4M7lF26Din+9p5fsZxg26cqQYsrRKIrxC1p9RgS5WnXLMJ0S6ubQ\n5mpH5wTSk+Nv5o+gzAE7Z0vg+NDoHnBHuZGn8x8PLbVKcCzlyWE97vOualQfmlWR\noO3yIEOxuorSvo46VjumzgaclqFkilsZujTgYpTScn7h4oEQ/xD2E7VBMFzjGIx0\nigGIOPGcPEmWjssPd1dddDXpGBip3AWfHbI65H6t/0H+OW5/0M6RMK/iyO4akIP4\n22jsV/w15I1aBlm7mczxD1xRN8sK5L/BtujXHgRRAHvfLgrZp8jnxALK+kqXbRQk\nd7x6ov/BAoIAgQDF/Os1HGPGTqu0r1sF3veXtFHC90AXWzPWkzBU7vzX+N9K5zl0\nhAgOM7FOnSprvl3JwMghzfR+jrfQpGG/HUoK2hnKLRD1IVYlpqJUdRen+Zhw8+JX\ndsucshPxZWycA7je4KUYKTm4wHurh3bKl99bZSB84/BksLnacsZBOMDX8QKCAIEA\n9PjaLXCQ3eDlPITQYY4Pdha72aC0HLPri4zbcG72zDor+ynhSj/rwPt5JywqiyOb\n4omDaoHMKKbgIJV7RoaqmGmZ4lW+IO42EJiMPzRAmWPt9+XVj3Szb216vndJ3Pdw\neUUiauuY3xx8VQYRlTVPKWs6KPsi3lXYaMU7CIktUY0CggCAXBhy/IiRLMypeGnd\nSFTYDPw20B8c9ABbk6Nx5wAoIvpEO95kznsgGCMZhfz7n5S0ocWIEplv8nLGtEnS\nogioyXV8a5wc+Dmije7+MZUqBNvIejon/hFnUyNOvYo1RDlDBIGwqhV7ISKAJGDl\n9AVDQ4s92npY9y1xtliPOgWBRrECggCAUHCms+USrMj8fTLfeik7ynsMlBnBCuvJ\nnLlUFUdaoxU2+/J0l/0FXQk2bzaBgc7fkTO2g3K7p12kmw56vF3cBtAmR7wAArA1\n8J0m8FooHDZEHfLKfaDEiwJYG9Lv3i8iL7AT7SgPurOP4BtuCqDGrcMYBfzxJjDq\nLv0UtWjWCMECggCBALjqdjwAqG8aaNOo7OthWgwrneBOhyhIOqAfVu7CFkMSvVd6\naDotWhar4MXlGPwoVHCaMXX2+9Tg4A5RauDY7zLFWdTh7Vg1BLolA3tH2jXtGrmT\n4uSE316W1Q7V1r/8SQNaY0GiYf7ToHBkByVluraGgTXUVTp6RaPQc+ZVtAnN\n-----END RSA PRIVATE KEY-----\n\", \"token_type\": \"private_key\"}}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9968f-4233-c76c-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9968f-4233-c76c-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9968f-4233-c76c-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"mem_size\": \"3 GB\", \"num_instances\": \"1\", \"num_cpus\": \"2\", \"os_distribution\": \"ubuntu\", \"additional_description\": \"\", \"zabbix_server\": \"\", \"zabbix_metadata\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99694-2971-2e3f-a6d8-024283ff312a','2019-06-24 15:24:00','2019-07-02 16:02:50','2ff1ae06-9694-11e9-b39a-fa163e0663d5','','DELETE_COMPLETE','{\"endpoint\": \"90.147.75.134\", \"node_creds\": {\"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqQIBAAKCAQEA3+WKcTBHW+PsB/NfxoVw6Lxb0d/hJTVV/XOMS8VBp7gnERdy\nZIfKL59cX+YnKbmwTf8CkwF/YQw4NZ2gKl1Mp8A0vMPmWh9uw6V1zLZybcaKSUBU\ni7Z/rNY0YK4K8t1xTsl/3w7OGtuzJ8rTKDko9zfya2KujfznVt3Itg6nQOOlEy00\n9C6MdmEkXdn6WNEail4KmDCKbc5luKJVDpE03VA29YZwMVjmKUUVRz+gcBGRPaKR\nCUts1FqoRkp870k1RJmfOqXVrLdLTRl1mrVW8eApBINeUCKIqLdcAq6Qcora1qP2\nAAbTlCSN8i6UYdehvhCFRac9VOOZl6lig9f5ewIDAQABAoIBAQCkDlir6XlQLqjj\nhoQWPe7myiXpmccqcXNpvIH/fzFFiN0vW+PZH9qZnIaeSlFF9Kbn78ReHUnNvZtu\nRep3QFgLzv2Vl2GxhbiuqQ2xC7q7DzCCzh1lJjtVVLuaX8zr+jCtT15f/kQtT/Bt\nZuPkZEXNJ/R8lRlcNwT4FJieNgx9sTDj5+E5eNxwEVUwcORUiaXlzU/9hnSPXHbA\nXEjHM0L9fMZPG6hTJt9AWBavh82jG/UX2E244SCn0ggCcLIM60I60X6zFkwe+Rf9\n/nGwOxFk5v2tXB2o5Rej7COPsfffzn2dVSxgd2kQ9XNLc4Lwfx5f8ffwrtSHP9xr\nHLPqXnhZAoIAgQDhWLn29fr6XxND//TgleltMMGvGO0Ywhbp/0XmZMqDnOPm/Epm\n5ZH6PUkiL2vXmWpj3dBETgyid7S+/wO64FtYD/CS5ZFD1f9M0OiVw+iXiqB7q6r8\n2bUzem1fkC3csRMvp9n9KhHw4quZlAfnsxLrViunvKe2HTMAaY1/uKXFhQKCAIEA\n/lpSobk1CYQ5Hbuuy4Fa6OUZwni7CK7Z6mbj6eGg+tjzGj43xOqQr+jaYqxG7YxY\nq/3xM1VkWDLkXAfyGAMZF6YoqK6ix0JfL2QpaaRPqb5dq+1YwaZZSQrDr1np0Nkj\n9uJI7m0eRcdSTa8Toq0lwOAmHhA91fd3FtvNjq+ncv8CggCAJ0764YF3DkWXbr0v\nUh3UYh+nKYwHj9ILfTXyU4YxbVPozVolAF37YNNf9n6fKTSxwknnEoMq4QxQkyCY\n3fhU9r+RD47MEDE8H4IxkC5kXErqQ6hmY0T2vswUWB8mYODin+V/uRGln4dqt5eC\n6X/rRPH7G39lIfdl9iRzclwbTqECggCBANmaZH8/eASAPm0VmGE6dZAyEGuz5i9z\nh7Nl+y6ofZSd7r1Q5V1uYAJe8Bbi1Ht+So46XxRPxd0/DOc/VPr+C4WT/czyOwjF\n27Eru9JJZG4QEwt3rytdKZ23u9pUzhiC7KXWyhZQ/EkuUVdspRvTji0IlxO5SW24\nnQXNXnroBBX5AoIAgFYcWbd8YKdmH2vxQoG5JHxJ9tAdp0wPysTlSM/c+Yh0tFFw\nmkEh19iN1pMK+B4gSKbPes/hsN9cy7o0zDlZ2l4gzyXt1kPtCP6q1I2E8V8F3sxk\nhb1B1EwvTld9HZNM6YLG/un47IhZeah2Am8IwK/KquACrl67W/q259mbBtWn\n-----END RSA PRIVATE KEY-----\n\", \"user\": \"cloudadm\"}}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99694-2971-2e3f-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99694-2971-2e3f-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99694-2971-2e3f-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','90.147.75.134','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"additional_description\": \"\", \"zabbix_server\": \"\", \"num_cpus\": \"2\", \"zabbix_metadata\": \"\", \"mem_size\": \"3 GB\", \"num_instances\": \"1\", \"os_distribution\": \"ubuntu\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99696-32bb-09b4-a6d8-024283ff312a','2019-06-24 15:39:00','2019-07-02 16:02:50','3d28a85c-9696-11e9-bb42-fa163e0663d5','','DELETE_COMPLETE','{\"endpoint\": \"90.147.75.138\", \"node_creds\": {\"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqgIBAAKCAQEA97MOWGbMauHGdviMV0//IqAJoY+AltEehFComWjCvDO7o4SX\nu1FodivfQC/8/q0tiInNpADrXjpcCnFqpRG9rrlPj1t2t1CFQ1pYODxcPaCAcAlb\n3Oosf0O7314N0ywlVvltix7NVsdbcHuga+MGgZPIKuQSeoYYBSFulxmpZ0d+mAjX\nbD3dt6KOxy6pWJYX7cD7j9mVOsyoKvG7KA/dN3yD2s13hRjIByt62CJEhi8E2PoC\nvfV4iGG51mEzv5mE1D56i15kkAp3awcnEpY6vI1JUQbQvdyQ/UotXZax/KIiIMvO\ncyCqSNcRUkQF2fSrUylyYz8kch18jtfQ4VlNbQIDAQABAoIBAQCVPhZznySldXl9\n702nwfRoqWKELJF+zWsEsBCVtjA28zioUliVrXwyT0bJRuC5liBsNxNnMIKgGKui\nQynNYX4XS2IrbyF9XA+fQE0NPRkarJ0WZB0sYxACcg49jE7qIJwy5kBhZWK1WZK3\nmFVVC8m8ww0FArw7hJXuaXFXq0eNiK/Crrvn1uSKshgJ7WQfQcfwWWpFwDfJba9h\nc/xbPPXCDf3Fa0pcDnNNnxAXLqBdAxPFAJaZJwE7zjD9WHyPbJuKrv//emAY+7DE\nU1efzFf0e2ieIim4AJk1IxLiwyxPY0VRBJvuEcKqAkgioSIA7QmpUY/0edA7dQ4u\nLzfcnPrFAoIAgQD6dyS+COi9OQOhl1eniZJc7w22HfFdqBRWV+PkQefHetyuFruz\nteWic5sGBRaHO+98Vo01C0S8UI7Ey/8UcttcRVYesNlmVi/M+Q7GH0M3xAUn3MdC\n1axd8R/LRlDbPyjCSJ3AbeU38QVy2ZyZxd4t34tkrsNMq+bu40E2oLOVFwKCAIEA\n/SxEBscVYdWdMNT2e3/lFv8Umu4+gsEFAo+CoMoM0sQMl0dW+VGq+PIro4isTCet\nW/GdeZ6o90Y2wOtH0hys+Mnco6u4w4TOpCS6tHIuIW4GAb3TsE40e8BRQYbx0sF/\nEzLmKDHqg0Wj82hXNWYz/112iXfQ5ANAA8CziVogjBsCggCBAJnHeSmscqlrTg1y\nzICy+MhShgqhC8bDIel5gRRuWo6hosjIcGqAbgN2E2J40UIqzHl88qn0xzkQBPhT\nf8PgWUqnz558Wp54oFSrPiTqoOymT7wP08/3PSNYnnrCK3bRqobO6vxw/OGB/CRt\n87Z+RFHKBN3GZ2a1zM4zfaC6vkf1AoIAgQDemMr/Ao/kQ0NAKh7Fmz+7pm9hgVPo\n9vkGtVNvN/dqYQGJCSqJb6rZ02NXF9YV51TfYGLLChsZvtxpZvTw4lGbNTEPnu6G\nygA+BiU6fqHctrYFVfgILdqra/6FlLaOTZ8DLF98u9arsNFkNDtpMgFJ581PNM+v\nisQACLBSdbHkPQKCAIBmoGZszmxmKTxKlQi7wRNmwCpBkLjhLrwE5flYYFcUBAEY\nQNw5I0LyHtGCQqF5K/539C7FcUY4Vcme5PAQVSoVk3aKs7dUmMFxpGUVD69NQI0+\nVgEGh2lNRPmdv5z6c9iAqzl6gkzNybNsImI7+q3Pgtvjj5Ozw7Zc7HMd+WOcHg==\n-----END RSA PRIVATE KEY-----\n\", \"user\": \"cloudadm\"}}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99696-32bb-09b4-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99696-32bb-09b4-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99696-32bb-09b4-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','90.147.75.138','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"num_instances\": \"1\", \"additional_description\": \"\", \"os_distribution\": \"ubuntu\", \"mem_size\": \"3 GB\", \"num_cpus\": \"2\", \"zabbix_metadata\": \"\", \"zabbix_server\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99696-e14e-8185-a6d8-024283ff312a','2019-06-24 15:43:00','2019-07-19 14:31:43','ed4fb96e-9696-11e9-98a0-fa163e0663d5','vault test','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.146/galaxy\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99696-e14e-8185-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99696-e14e-8185-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99696-e14e-8185-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.146/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: luks\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"instance_flavor\": \"small\", \"additional_description\": \"vault test\", \"vault_wrapping_token\": \"s.ITiDpthkfQgwc9DWXKtSWq7F\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"admin_email\": \"ma.tangaro@gmail.com\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"flavor\": \"galaxy-no-tools\", \"version\": \"release_18.05\", \"storage_encryption\": \"True\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/5b68fbb5-d251-4820-b003-94b8ae2405cd\", \"storage_size\": \"50 GB\", \"instance_description\": \"ELIXIR-ITALY\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,NULL,NULL,''),('11e99c9e-d92c-36d0-a6d8-024283ff312a','2019-07-02 07:56:00','2019-07-02 08:17:11','e15f78e8-9c9e-11e9-a036-fa163e0663d5','prova ','DELETE_COMPLETE','{\"node_creds\": {\"token_type\": \"private_key\", \"user\": \"cloudadm\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqQIBAAKCAQEAsK/CwAejmst6JStbOT3vlQH8+g3VKDbHk8OmgFu366eQ4h/E\nLXfMdmOlSXrcUN9hWpNTIeI2p/WYAx3CV4zyRsw8foQRl4cZanFeUuB+cVG4+67U\nZjUbyoCuuI6CCzCU5X1tXSWBF5KDdJz8H66nc/J9lZb2hYDAvHtNcWT+ZIgJUJg2\nPDdULtRDzMKZj/raGzNDsNWrNEO7Hk/ma2w6HQv7MlCGgpjjYLFIWsrUNV0mWbIz\n3ZK1SwbqK0WHnkOFglo2a+6kP8y513SlKT9hN4ujXpNhk9kiHdw/DJ9uU01Hr22V\nsMuflER6m+YKU2ubXVRVBg72lzuVogafZ14GuwIDAQABAoIBAFxmPkGwfQW5vZHs\nn5NK6Z0SYhre2wdhxnNnEQ71aDSr99/ZXv2sNdf/+nN39fmxKDd27jW9GHozvKB8\nkqK4igcuTcCYDp8gvtDkosBSuK1IYKX2YwtkYLlBHJ5VoHp7mJJ/So84ys7qBycX\n5d4nt1iyiqyNOzTMBX9MOE7B0yv8/C+pErGuMzL3VAN3YEAIqrb9/EPjDHX5iic6\nhtOmfci9Eoj8y5ea+6A42Gtr/tj1ycnYpcwMvGgvk9r3+CvkhLkaqPGOKkmRTcfk\nmUIBywqvtqyvIS4pd6ju5xmOuQPSxzidWcfr5U/WgOYPKZXAWgz0dKB1OaXrZta1\n8slbhNkCggCBALtnYZw3zIIvfl75yucuUsABPrK+zzAI20s4zSZP/s5D+FdHhMmX\nUC99wjZzAnmtEDp0dhoVasK4Zt3V6KjosJONukjqKfsDIPtqC2GLbbavsxZU2yWs\nuPAxx71Ph7Al+3Q2cZMG3CpzKVht4Q5W3ibRFeu6kQZZzGLk7xXvzvdvAoIAgQDx\nXB8EmbmBFlR5jLEzzw38qM+APLt2hf1kQsizhvwk3ySZ8e076z4KxPhui/zU9tu7\nQ8HZ4hItnoYselKmlb/B1TKsBU/Hz7eeHt/sJv6tNWZsNtvi+h2ej+kYHCKbTFOp\nyGFYZV5NXxqLnyDx8NdI3yprM0MfkLQJ0BDe2vefdQKCAIEAlLQE1TPFmGvdR7nI\nUkcErIyQVr9nogL1F6w7xTHmy39NuNvsNxZVL0oH6LK7/RbhcLDm4e2qqFYwcciB\n9D2nl333mlIM+7vQ2Q6dd0puxW6Hmam9txhmK1ok10gbMCADdoSY/ISOATUeUqfl\n1D4DyyNP1JxW5YYt0y87s9l1DgsCggCBAODopQbWcOR3eHRjxGSw1ynP7Lxk25NQ\nvJUHHpsceC2ruiGyLQ0e4wuKDK6GyC1zc8KHG0b7wVC9Xe5odkhBVxU6pCNkN7nM\nOCCiSKt4ku24yx6f6DsUMzGkjOMopJ7uey/FR+DlZQDYVJYyzLJnaVXAj3ihpjTt\n1LcoKfBhP0pZAoIAgHA4i6Q07Mnb1jYPmmUV4rizc6XZoIGrqsmV2Jg02axqqWYC\nxdkB5uOuwe1ADJHT/uWIRJWpwcrgxR/XeHFfQI7ayz8P+GDT5SgxnSerQlGVoI2I\n9koR5zRsla9wyLOQylg3MZjWL0VP/LQRzGM0P+20n00v4FA7FT2H1g+Rtv5+\n-----END RSA PRIVATE KEY-----\n\"}, \"endpoint\": \"90.147.75.90\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99c9e-d92c-36d0-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99c9e-d92c-36d0-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99c9e-d92c-36d0-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"mem_size\": \"3 GB\", \"zabbix_server\": \"\", \"num_instances\": \"1\", \"additional_description\": \"prova \", \"zabbix_metadata\": \"\", \"os_distribution\": \"ubuntu\", \"num_cpus\": \"2\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99ca1-6942-21ba-a6d8-024283ff312a','2019-07-02 08:14:00','2019-07-02 08:46:00','73b2eb88-9ca1-11e9-98a0-fa163e0663d5','prova','CREATE_FAILED','{}','DEPLOYER','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99ca1-6942-21ba-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99ca1-6942-21ba-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99ca1-6942-21ba-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: luks\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"storage_encryption\": \"True\", \"version\": \"release_18.09\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"instance_flavor\": \"small\", \"admin_email\": \"ma.tangaro@gmail.com\", \"storage_size\": \"50 GB\", \"additional_description\": \"prova\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"instance_description\": \"ELIXIR-ITALY\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99ca1-dcfa-27f0-a6d8-024283ff312a','2019-07-02 08:17:00','2019-07-02 08:53:19','','vault 2','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99ca1-dcfa-27f0-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99ca1-dcfa-27f0-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99ca1-dcfa-27f0-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: luks\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"storage_encryption\": \"True\", \"instance_description\": \"ELIXIR-ITALY\", \"instance_flavor\": \"small\", \"storage_size\": \"50 GB\", \"flavor\": \"galaxy-no-tools\", \"admin_email\": \"ma.tangaro@gmail.com\", \"version\": \"release_18.09\", \"additional_description\": \"vault 2\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99ca3-5cfc-bbd1-a6d8-024283ff312a','2019-07-02 08:28:00','2019-07-02 09:00:00','6a04f822-9ca3-11e9-8af8-fa163e0663d5','vault 4','CREATE_FAILED','{}','DEPLOYER','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99ca3-5cfc-bbd1-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99ca3-5cfc-bbd1-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99ca3-5cfc-bbd1-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: luks\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"storage_size\": \"50 GB\", \"version\": \"release_18.09\", \"admin_email\": \"ma.tangaro@gmail.com\", \"additional_description\": \"vault 4\", \"flavor\": \"galaxy-no-tools\", \"instance_flavor\": \"small\", \"storage_encryption\": \"True\", \"instance_description\": \"ELIXIR-ITALY\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"vault_wrapping_token\": \"s.3OKdODOoPCVO85kj9kP5uM8K\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99ca5-2e61-a9bd-a6d8-024283ff312a','2019-07-02 08:41:00','2019-07-02 09:43:27','3ebb14ba-9ca5-11e9-b39a-fa163e0663d5','vault 6','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99ca5-2e61-a9bd-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99ca5-2e61-a9bd-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99ca5-2e61-a9bd-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: luks\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"storage_encryption\": \"True\", \"additional_description\": \"vault 6\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"instance_flavor\": \"small\", \"storage_size\": \"50 GB\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.Mhij50gFCRdhanN1MiVERmsm\", \"version\": \"release_18.09\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99cbe-eec4-6c01-a6d8-024283ff312a','2019-07-02 11:45:00','2019-07-02 12:12:22','f8abae66-9cbe-11e9-8af8-fa163e0663d5','','DELETE_COMPLETE','{}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99cbe-eec4-6c01-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99cbe-eec4-6c01-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99cbe-eec4-6c01-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: luks\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"version\": \"release_18.09\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"vault_wrapping_token\": \"s.9tZwTDV1VxJJtA1GxBeVd7sN\", \"instance_description\": \"ELIXIR-ITALY\", \"storage_size\": \"50 GB\", \"flavor\": \"galaxy-no-tools\", \"instance_flavor\": \"small\", \"admin_email\": \"ma.tangaro@gmail.com\", \"storage_encryption\": \"True\", \"additional_description\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99cc2-02d2-8415-a6d8-024283ff312a','2019-07-02 12:07:00','2019-07-02 12:49:49','','','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99cc2-02d2-8415-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99cc2-02d2-8415-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99cc2-02d2-8415-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: luks\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"flavor\": \"galaxy-no-tools\", \"storage_encryption\": \"True\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"instance_flavor\": \"small\", \"storage_size\": \"50 GB\", \"version\": \"release_18.09\", \"instance_description\": \"ELIXIR-ITALY\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"additional_description\": \"\", \"vault_wrapping_token\": \"s.HJGOFEhNxLz00zoAN8TDB0FP\", \"admin_email\": \"ma.tangaro@gmail.com\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99cc4-4d2f-502a-a6d8-024283ff312a','2019-07-02 12:24:00','2019-07-02 12:52:12','532d01be-9cc4-11e9-98a0-fa163e0663d5','','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99cc4-4d2f-502a-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99cc4-4d2f-502a-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99cc4-4d2f-502a-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: luks\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"instance_description\": \"ELIXIR-ITALY\", \"additional_description\": \"\", \"version\": \"release_18.09\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"flavor\": \"galaxy-no-tools\", \"admin_email\": \"ma.tangaro@gmail.com\", \"storage_size\": \"50 GB\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"vault_wrapping_token\": \"s.qS7o5I4ERqe52WPTfHv2oBr6\", \"instance_flavor\": \"small\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99cc7-a577-88b2-a6d8-024283ff312a','2019-07-02 12:48:00','2019-07-02 16:02:50','ae37f6e2-9cc7-11e9-b04e-fa163e0663d5','','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.167/galaxy\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99cc7-a577-88b2-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99cc7-a577-88b2-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99cc7-a577-88b2-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: luks\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"storage_encryption\": \"True\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"vault_wrapping_token\": \"s.IQ9N0UsLnKAhP73Bat7V2SsF\", \"instance_flavor\": \"small\", \"version\": \"release_18.09\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"flavor\": \"galaxy-no-tools\", \"storage_size\": \"50 GB\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/7f2a211c-2774-4400-b81a-a0652cad5fd7\", \"additional_description\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99e63-7baa-7487-a6d8-024283ff312a','2019-07-04 13:56:00','2019-07-04 14:56:04','89d4213e-9e63-11e9-b04e-fa163e0663d5','','DELETE_COMPLETE','{\"galaxy_url\": \"http://90.147.102.102/galaxy\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99e63-7baa-7487-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99e63-7baa-7487-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99e63-7baa-7487-a6d8-024283ff312a/template\"}]','c0b907df-43a3-4c8a-952a-2b5ca56ec43e','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    galaxy_storage_type:\n      type: string\n      description: Storage type (Iaas Block Storage, Onedata, Filesystem encryption)\n      default: \"IaaS\"\n    userdata_provider:\n      type: string\n      description: default OneProvider\n      default: \"not_a_privder_url\"\n    userdata_token:\n      type: string\n      description: Access token for onedata space\n      default: \"not_a_token\"\n    userdata_space:\n      type: string\n      description: Onedata space\n      default: \"galaxy\"\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        os_storage: { get_input: galaxy_storage_type }\n        token: { get_input: userdata_token }\n        provider: { get_input: userdata_provider }\n        space: { get_input: userdata_space }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    galaxy_url:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"\", \"instance_flavor\": \"xlarge\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDrm8mxOuqwP5XTHf685V9rqRXXg41F4isJvRr4h3MPDs8PgqZBzzjxEFyGpJ/Rgg4ACesGBZy+CbVVGtOveltKvgkpzyHIrh+vMay9z82eK2LMZEfmEPgw1BHdRifPZ1Qb7Zmj1nRk1EMWoNvbBxEc3/MSorWb+2SVMs+42EZ7QxavBmsU7zNU0Nd0e1xiqJ00VDWMnXullp/ieR9M4/XsSlS3oqxsxkAbY3eQYVMsnh64oiRw3lpYBkPyNtC/VSL5Cqig3CMaiK9AW8FjP1GwwqoMjL0H0Mkr0fY8eSSQ9Tcy5AqyaiPn7tmG0fSeNOFwxGkTzrujqlCiOkRSM1Yj marco@MacBook-Pro-di-Marco.local\", \"galaxy_storage_type\": \"encryption\", \"storage_size\": \"500 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"matteo.chiara@unimi.it\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.covacs.refdata\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99f36-2ee3-288f-a6d8-024283ff312a','2019-07-05 15:04:00','2019-07-05 15:35:28','3530904e-9f36-11e9-bb42-fa163e0663d5','','DELETE_COMPLETE','{\"endpoint\": \"90.147.75.83\", \"node_creds\": {\"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEpwIBAAKCAQEAzNSqj3AAELcUFLSum12qH5g+vyFJdGu3CUyEFstyr/q/wIyX\niBysjMviuNvHP5LY7ogD11lUb+SzjMWzph5abLEn//mg3SRHPi/WwWg6vniTGhoa\n6BaUWgU43U2H+c53gs33ySAkUkBFK//Jug8FFY+2j+/4yFqon/qOb2/zVdZFkTof\nBOBxpU9vLeWS84VGMazvjLRh053uH1yh4NxR2NM5oyBQPAAnblyRGjNgSPFhB56S\nZXcC+61UqSB2PlGPNySySu0J+ouIuuksCx0IUOdw56DlAxjAqsoUGSfdgOPoBAb7\nodKyCeDlXQF6XBddljORLuRK0e5LJRYNOOGy2QIDAQABAoIBAEfIE4m2717sOe5T\nr4klFvSBjyO+D5bsFLX+iZ/PZn7DeiWJX6VEnzesT+UGqFngJYPaSLZUSOH5nO6t\nbhq+MmQ65VCwc65sA0eIzlLzKvsLGEoiceF54D137QipHgjuUTWW5somKHRmr5cO\nyewZTWfT+F+S8nWMR+Hglb/51KX0kzl6qCc81fJbVdheNIusnp364uZq0IabWr12\nLdgAwY7Tf7Mos/W52gjqwClZ/xNlUMLWOj8moCWWA0xMGm2lbOvDSzOg5JDdHZFj\noB3tcUQp43UUXCR+wNuPc8cCdjM98OYyBxiw7ksZPRcio4m1NWj82+QMfySDBVZy\nd8ShD/0CggCBANDks8lSSUBZ+Jnm941vnomahf8CZlgywRMtsrrXOFcjxh0zaOAk\nvkUCWULI9XWOYD8NGmmHqXVE0CYPMSjn/U/XwPW1n+M9117eWn5GOKobAPJLeAX+\nBHbeB4BYm8J5O0TfuEbWWSFX31+T2EsF8948ddnb2d2wAv0nZ/q0NeTTAoIAgQD7\nBW4StXG3WajB0Zc8hjIVUgnkswl82v4fm6ijuOwt/Ea4mgYegV+afyGlR9f6YphP\nLPcRNaCHoxxZoltkXlhSIUSmUEJkka6ecpMv/JWjfW+482TFBE+x3tvAz973PfZq\nXENpYZg6rZMrvaN0JpGLecXdkZzJtBdyOQaVbpSuIwKCAIB/FQODULobmiCxkF+9\n/c/XKtimARG+SnJHdp+rJ0+xQ6Q9E4+T/QZ7+SfQh2087TcEZLZSySOAojJ3VPq1\nRh1HO5y6Xpo8ptylbGRlOdczNWZoAR2tl5GjtwOdQ0rPDu3NwsTa44Ap1smf3dPS\nIHbyFpojxapPQcsvs4+AZ6353QKCAIBwMtwhVqKObm/kufbcYasPJo0vgOrzuLqv\njBbTnztJzqIZrxafGfqOhtaWFsetrdYgRZvlQFARcFGiqtQox5a4lxAlOmiCpS8k\nuVeask58Nfvy8i+PdD7e5RraUs95OWPj5HtpJesyBxVqDqh5qSeS7QoI4CXxbiKw\ntlaAAl5IewKCAIB+hzeIuvX/PmbrsSX7odpPTd/MZFd5XyS3JeVhknJo+nGjfNdC\nEQu7VHfhQFnl6OwI9VGQp2/xK//FElJji9XZvpW4MlcxqbxlevL6SNH53BdDrzLO\n3BNmVPCj3JUl4Iqw+bLDeySgwx2ssdvVLG6GJhG7cMlTGVN8ucNaj9NkYQ==\n-----END RSA PRIVATE KEY-----\n\", \"user\": \"cloudadm\"}}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99f36-2ee3-288f-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99f36-2ee3-288f-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99f36-2ee3-288f-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','90.147.75.83','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"zabbix_server\": \"\", \"num_instances\": \"1\", \"zabbix_metadata\": \"\", \"mem_size\": \"3 GB\", \"additional_description\": \"\", \"os_distribution\": \"ubuntu\", \"num_cpus\": \"2\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99f36-4487-2ae6-a6d8-024283ff312a','2019-07-05 15:05:00','2019-07-06 08:30:30','50818592-9f36-11e9-9be1-fa163e0663d5','','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.81/galaxy\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99f36-4487-2ae6-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99f36-4487-2ae6-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99f36-4487-2ae6-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.81/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: luks\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"version\": \"release_18.09\", \"instance_flavor\": \"large\", \"storage_size\": \"50 GB\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"admin_email\": \"ma.tangaro@gmail.com\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"additional_description\": \"\", \"instance_description\": \"ELIXIR-ITALY\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99f38-981e-7ac0-a6d8-024283ff312a','2019-07-05 15:21:00','2019-07-05 15:36:03','9ce8bc46-9f38-11e9-b39a-fa163e0663d5','','DELETE_COMPLETE','{\"endpoint\": \"90.147.75.85\", \"node_creds\": {\"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqQIBAAKCAQEA2KDOmpaGtgfqWi5ZS1nBM6RQ/8/uP5tZO747l7vTHxFxGdqJ\nywq9WB1RdcQzgUvqx0uo0PyJJBLCkqm+FsvMsXjc+aIouQb3Blwx+8627aDYLqhv\n0hzBMNh0K5cDjPqF88ZwAok3u99jmX+Tk3EgukCxht3hU4eLvvM1F7amVXYI0tZV\nkJ2ZI0+C0d58NmL/CvFJtyxcs0FGEEaOZO8nBC05rQM13ZSK3HckeuKZ5ETjuIAO\n8rpYQhM08xDNXkWg3mjWZbt1dMCAv1iCjAFtEyy7jfoEstyqRDOUqJfw3yAJChA6\n1sgwx/LxNfmxT4yYrFvkzHnhpFiObif2NLZGZQIDAQABAoIBAQC0wspjWEOkVUqK\nYa6FH6oFi5FDRKBLVzfIkF5tqH7sp8M2jZL5aEbC5gP5PvSzaUPJdSqy6GcPQNA3\nTYiewQRW+sF5VISikFtEZV4X/k/KTbLWjBpyuyfBuHyHewWtd8aaufTxSMrG7ArS\nJRBhsb5bbGw2W6MP7kT/2zVsSi7Vk5WWy8n4wgXbDktyGVZycAz522IgYvszIc+y\nZvu9uDMLUHb9aV3lNc1XRBUGgAzpC09qmYZvigkFg1Bjw8Ujeknr14wqMeicOUQ9\nxS2ZYGM1ff6KaFoIy7gtEPOLIABcp9fzwVh/qh6MOXBlFM+VbuNmkd4qzCMTCqou\nYKXSvzlpAoIAgQDpbIsAdDOclTW2OsbdQ6zsnfmeEo1DZO2vGWI/cEU9fJvnz5mB\nmG7q99zrdTAldi3BblcnjrJHA2tp5PKXuY/RocoI0BR9oavjLymFK0Tk4xz0GAzD\nJ1M68l1vfF5AVkcRrk8jYccBBfVvbrUtZ2QymjH77cmSMDRxTbKA5EE/TwKCAIEA\n7ZRoXxkn5yDnnRUzuYUhM3A7uhTHkNF7TT4lnu/G2Sgg0Wu2Z8aCuR66UPDZ3VBA\nO7zMuYv4TFfeALTyyox98i/COLZFXoC/NUwOF719wN5/t7E3MKGFcR0VKWBNTBJH\ngcav6QE3FfGSHZ2PrLUqzQ1WCCgIj/Jb1XrQFjP7EgsCggCAfjokMOqlvlcx5ImE\nYMLoEEydX83Idllt7vJbHtMnnkh0RrcM2/gCgy3mWa3Vi2yM8b0phEq2PZCr1Wfp\niALgsww6pOlhK07yFLi8SzdK2ju2vIkE3cO2Tnoh7NfkYAZICFeqlAecBgGi58+G\nSjdPB846mXHNPzCyK1NI5EqKviECggCBAL9wa93dfmre9+N69zAR15wEXwxlvB20\nvz+RyWzV14yaqj82JUhgDGwxF38rZNLR3MCGNQ16fTy/PPOi21VdegtScpWSQjmR\nUwIWY/C7T36/i3iwg0FblhR8k9XAdOjMffRT7uG5ifLTsqLMmL5ZScDrcxylbajY\naSmPieeqQTDbAoIAgGQchl8txwwAmQw2qBU+ADtcwokzRMwIsPjuSTQ8qeKCPXYo\nKBUeroMeXVZV1c3vqW7zqKb28GWSrwFNsAKACmQlIadngcLtBurgO2Ouk1nwjbMf\naTPClsHTDmdatO1eMJAb2IFf2ur86X1v/Y7ZrCqnc36LlIyNDSkcIApe8UPc\n-----END RSA PRIVATE KEY-----\n\", \"user\": \"cloudadm\"}}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99f38-981e-7ac0-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99f38-981e-7ac0-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99f38-981e-7ac0-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','90.147.75.85','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\n\ntopology_template:\n \n  node_templates:\n   \n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            #private_ip: false\n            ports:\n              user_port:\n                protocol: tcp\n                source: 9000\n              other_port:\n                protocol: tcp\n                source: 9001\n              ssh_port:\n                protocol: tcp\n                source: 22\n        scalable:\n          properties:\n            count: 1\n        host:\n          properties:\n            num_cpus: 1\n            mem_size: 2 GB\n        os:\n          properties:\n            type: linux  \n            # The format of the image must be defined\n            # Currently this example uses the IM URI convention\n            # used in disk.0.image.url\n            # see: http://imdocs.readthedocs.org/en/latest/radl.html?highlight=uri#system-features\n            #image: ubuntu-16.04-vmi\n            #image: centos-7-1708-vmi\n            #image: ubuntu-16.04_2nic\n            #image: centos-7_2nic\n            image: centos-7-galaxy-base\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                #location: /export\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: 1 GB\n\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"additional_description\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99fc8-63a3-6928-a6d8-024283ff312a','2019-07-06 08:31:00','2019-07-06 09:25:12','6ff7b594-9fc8-11e9-b39a-fa163e0663d5','','DELETE_COMPLETE','{\"node_creds\": {\"token_type\": \"private_key\", \"user\": \"cloudadm\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEpwIBAAKCAQEApcEtywuR2+cb3Rhriib3Yr08KYJhEmQh9tBmhvzJiBb+jDb2\n7cg1YwryB3Sx+CIraRhp+XJmkjJFsCGyADAM0xwMcgEzx9j+RDe/IlLZroY4ENqo\n8uHAhb8D8ZGaJKHe3DL81GYnCoIRVq8/7UFji751aD9FV06MzJnXbSKgSDbnyG0l\nBcNIfdcUvE3u3VX/P2wR/LzDjrAOxgGClPGS5yvvrX0Y9Zq9J4jjw8Ektqn0hTKx\ndyijwxNNjNTMvVkfKKcPuIdcb8PSLPDSCStRhTz+C/2m/oRxs4ad69YTXygerIL1\nQuH8381cFFN5JHESuHuda/e6AUwvHNCvt/3W7wIDAQABAoIBACqln4Ckg2zO865Z\nQCIVkIUJJ1eOwicXOF3mlNqaY8fuEqRE6BeZ8ZKAGHGuprOvJvgtXebedmGbKa79\nnGzL8CDJELKseIQs4o7uwPC13Gg5BGfhuqJzTzOaSAt5aO2P8GU7gS2s8tKTUJ67\nDHmg31nvMQoXbWHfRf7GflUIGbE6dQfg8WrQGoHxxQDTvoAcmbF8HYUTWm/ccMLz\nQMi34qZM8JmO8kweMV99MdEn7QKXAaz8VJo3nFTlfMwMC0ZdtFROGPTaq505bErW\nV+pSr9qDjSNnxKvhHxoyZUsCd5EV2coiVsklbpmE8KkuaaCrwALn7iosJVEBkLTn\nPgeh8FECggCBAMGb/YX3GoERf/CESEtztW0heyHCbjlnNnd+U5MmA1sJPeoIu1+M\nSf91GasrwAtN2U3kF4OH5h2Va9DHU0h7mlsnMZ7I9uXkO3aeLyzL1nuB+GOLi+8n\n/B3A5V3FMbx8KoNP1r+IqxaUa1EFu1NcPt90BC3LvmLQ2gPfXxHBfxmdAoIAgQDb\nK0hXP/KS+86E1BUS0h+1Vor1238o+HU9SjrUMncjw1ZHX9ZIcM7SE3/+G2yV9Izv\nUjhV0yOyOp9avYmqHVqlAPdpLbHqz5fhjPSOADrH59PtcShEICsvrEin4kP8OebS\nDEwAmRV4+BnlMOt8HwQ/vLWbA8C99E/FTO4oE3aC+wKCAIAH5wkTFcH0MLWrKIsW\n4VMvcCVpfFkpaKgVeoeIww1yAs+PJOoY/U3r6miwzulYzMWo4z1+deaToIy1Cd3B\nYKItRE1HMOa6/XTb45sDVhKcGfL8hS6iBVzKDhyOlkTwb5UApRqb2MU697Xlqbk6\nrtI2JrMg92b++41aiRyFSgOZFQKCAIBWFv9Yfl77i3vIw0Hv3afk5DS7dFfTsRzk\nUVcgaR5RZvZqHOQgGmezL0O0ffM+SAxgKWzFkaVQ6iQUUaVUtCkZ7XJB11guwxKG\n34ZkjQSJ569gcnV9pSExnbwAbimEVv4q/feQuJEtrk8Frxyg6dIScz7mwCeitefr\nuVdHWLXRpwKCAIB1OHSKa1d0Qnexhg05LMOLI4mIh5GOhCCaI9sHx8cvQg2dcBH2\nTnI93vADaREUeDYzro0m3Qcya1+b3b2KSnyLmKvqjRZaf9dgbCD6luDD61jfm2z1\n2JB5GZK2c3F2xjZrBACfSX7vklelexsFHTzhbyyRdkTHhMMKMk18lH2qYQ==\n-----END RSA PRIVATE KEY-----\n\"}, \"endpoint\": \"90.147.75.190\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fc8-63a3-6928-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fc8-63a3-6928-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fc8-63a3-6928-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"mem_size\": \"3 GB\", \"num_instances\": \"1\", \"os_distribution\": \"ubuntu\", \"zabbix_server\": \"\", \"num_cpus\": \"2\", \"zabbix_metadata\": \"\", \"additional_description\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99fcd-08bb-37e8-a6d8-024283ff312a','2019-07-06 09:04:00','2019-07-06 09:25:12','1001f2d0-9fcd-11e9-a036-fa163e0663d5','','DELETE_COMPLETE','{\"node_creds\": {\"token_type\": \"private_key\", \"user\": \"cloudadm\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqAIBAAKCAQEAlJDhZhsySmUjQ3Ryfg00BzrxInapPqaKu0l3R0uhAyvVTU84\nJwnbROsNgx8Khfgn4a55BXQkxm6/3ZS1/JujDIZv/O9NV2tTF1slxfRriN5yfUP+\nR9tYOWDXpEmqwHW5eQ6ZN7Rk/rxfYSgObsjTlEZm7tIm8/H+V40AK9ALzKBCgjoB\nd5l/JhH7Pg29KChpHHB4IfBUVBQzC/3VMdQ9dAtpBd+MhATLAJ16DWsZnbqQLOCV\ntzaoq6UgWIK6YYoprpgYcj5S6wCo7GTh7Cqmy2piBCxtn7B0aHjIP7qaa9naEzUr\nAroIHloMN4CTY9cdDDT0ISN0EVTjJjDdT7TgRQIDAQABAoIBADmTJCbj50t5gn8D\nw9Mh3sXmi8ilX9WNyTnnsLgKkS2fcRxy1PocEcPVq/jisLtWfm4xpWj9p7rW9Lg0\nh4qL7lZOS1wkiT6Vsy/b/PmITZxPSONO1F6YnMovw6JBglDvzp8hjzNNT86Axh3q\n3h0E6yoNVpq7CqmDYOQhGq3gBJKZ+cGQXdpkLSSFD7ZLDhlrKJbwYTdDfiHezdxv\nWn7nPsBI/9u9EWpPVTZ0bAGOISY3M5icLGZBIXKWAjjUNaLbbshQUkLX3CAOMjlx\n63fqvF+XXRASr3Nvg2Ucfsbn0170AO5CLRLu3PFKGa9hzHYxmJLop1WJr7WWRVNg\nKvaRAEkCggCBAMDIbhOq8zC21wZIfYJFN46VsZnG3P5bwN9hXzf70CCFbtztZZCH\ndomsW4n4L3+7alYn2Y/TpOh7bD9zuD1ObVfoHV0nHbRVPRaLCZkAysC9WLShN2pq\nrS8PFonOcJWYYlKSSfy2ArrQRLGll6hwzHy0r19IbPnTOT5R5YQ0Nj63AoIAgQDF\nSI/XMYZ626nzSuOVdNboqCjX3j5SL8Dk4UIyEB6gLB6NN5KWQAAZJ3zrKhNv6M0S\n2jtn/7IrZatai5Uu7WeDLXsrWJKCKV2LP2MY7B5RerV7uGTMoqDJFRYA4f4Og8Om\nr+DOQC1+72LBOaNzgcmLjYP8hc71TQahAKtnEfrc4wKCAIBmK5NTLx2V6sEI3nBO\nEzr/gUxP0HodACm2+ZcKR5WlNrJruhFCyNhE3Kji9TrPOld/87y1Ihja8VaMRlsV\nerQui6DMVsfCZA5tHSDoCuhpv6/8gxioeILyVs++Fz/JuKobUtaNbTUDJw/RCo7W\nwXlOekAbgnnm6VAEPEkkiLta/wKCAIEAjxDN7vplUZcWqe43GF1AtDuuUs1CWIt0\n0QZh4Lg73V/hT/tq/DaxW4x9VHSQ3+jtPqyvw/1zkXELUIBE0WEsXb6PwaFbrbSd\nt6tiC+K/Ictg7LWNs7CD9Q6rhDxe5tu6+Jg26Js14wVqkkFgPRVzuRYJDwliShVv\npzY7FmW9jI0CggCAAsn3ERjxzyw1w9Sq2TIwdzOCaIt6ah6+HuwbTny6wKbna/zD\nK02gPRBSOgIjE1h4I6g12gxexeSCTa/eJvpf9ajSNWptk/b1cbvraDYtPv1gcOZv\nzsMfAbmA4aku6hDVUe3GX0aj2xPgxPlOrlCXXfuTui/UVWr7wlgJDlAEMgw=\n-----END RSA PRIVATE KEY-----\n\"}, \"endpoint\": \"90.147.75.21\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fcd-08bb-37e8-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fcd-08bb-37e8-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fcd-08bb-37e8-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','90.147.75.21','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"os_distribution\": \"ubuntu\", \"zabbix_metadata\": \"\", \"num_cpus\": \"2\", \"num_instances\": \"1\", \"additional_description\": \"\", \"zabbix_server\": \"\", \"mem_size\": \"3 GB\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99fcf-4636-e545-a6d8-024283ff312a','2019-07-06 09:20:00','2019-07-06 09:41:02','5a38eb0e-9fcf-11e9-8255-fa163e0663d5','','DELETE_COMPLETE','{\"endpoint\": \"90.147.75.214\", \"node_creds\": {\"user\": \"cloudadm\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEpwIBAAKCAQEAvR6p1cIlNSEB3DAslYcD7E3gx7t6jerD/b8Xkd4PEc8rD+xg\nUlR6AfSGctYoX3FaAFIl0EhjFqyfhUi7qGUcaKSlm8cWjW5ilsw7E5PCBatIqnCk\n+PL91w6bdifsC9hvb0/SgkzToZvDIONQzMeQYQmXjFn2DCTKRPb3YvoIXLR/JfX4\nbH1f3u2q8+Jc3teK54x2GKPSc/1je+Gq2qS980hMxm9VMQ/XeDSzhcdhm9+ZRtec\nd5RfyK1sy2P0F7YP2xUKhrhoYHoEGNm18oFcc2cafdqkN6twAzXP5HVl3n6lv5N2\nP4BHpO3f6SNyaiBe7p7/9i30lJ2kwAAXNDyWkwIDAQABAoIBAA+YI7D4nVDQM/MQ\nFd0OkQg/M7XEg8qH/TlDNJJWmS+Cwa5Cc37WcGkQ3LVDa3jTQ/Sa0XtnPKR1/4Fi\nCfdMvxbx3KYHuJhY7dA5bvWiTXFiOk+zkiblAoFlNvR7Pj+LzUSEdHtCEoFU8rYX\niGYaXpFh1RlBocRGlFczdhq3O1FJfIFOw+KBOwLPPWQiO0vNTvJzRyUz6zGx8bNx\nRWp5SK7MwXdQOd3Zp8eNE4M6+K8HPKapNVPUzAy9AqvDVa2xn4dkgRKa0HNsWub2\nMglommYmTRjFuBNAAYxl5YbL4wSi05KBtpGi/ozduZq1TuWjBOopXb1DAqF+k+Ff\nMpztOQECggCBAMzea7egOEcGXKNMUlvYW9bcj3cSQRO4cBSLGPdYASpDeaJDaJ33\nEC2DyDAGignCKPmcxi986qb3+7psKR6SdcEKELqe+oTjyhZL+N/ZZ6pQFB1EGzRW\nM/9A/FvYMK5KbDPLQ068dsmDXTQsD2L+AvebyWzbrn4GMiQu795by0bhAoIAgQDs\nUf8ci5nqm9LF7nMKBkPc++nIPWHHX2gB8TYvcsiROCvh1uPLNszNtgqXkYCdrWBr\n2AagF43fZfYhYEWREPAYkw1itPbHtzODh3kjba1RLbaBuPOBpZWIC/ZIbrxja5+a\n0iTmW70eopgiJhtf0NUWWxBSLHbAbuhPfcd1eeUv8wKCAIBKGUisqe6xAcQP7FL9\nlUvicvQRBTE0iMlBJO5qyBHjz3P3FJqKSAo57ChD9pmG3gsj/WhRVMUqjxclXmmg\n/ShKIfHbDhVea2V0mxXxIRk1qLEdxLxyOZuk/0RHk/JHl/N66FH38IKmcDUN4cHO\n9EDufhJkpTB/tI3+OFvZ+SmVAQKCAIBKNpHcAActAxRU7kYYPtFvA3luVcBwIQkD\nmyF+ExjjafV17csJlUMJ0wJOiPYQDlN6apPiEKOQJW//GUGfhecwgHWyqsvY+jJm\nOtQTCS1lkep/oHpwG3TzDXahVo0416J+t0G5SdQBW+RUzQzJsUZJx/0/IRGF6w5v\ncDuEK+yKewKCAIB1nYQGBbjnaSKCXvxZBGNcMhNkxzCOj6q4jEw5wrg9Tu+OhmoL\nRUUhZa9Bp+lLtgH5rtCaKaGcN8to8LAXkcim8t1960KAfszmFKqPPHth3UumWTHc\nK8Bbx9mhjVAn8lJx/xB+RLOLCWqsycBsM1+CKSGPJyt7TE98vqIvR7ut/g==\n-----END RSA PRIVATE KEY-----\n\", \"token_type\": \"private_key\"}}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fcf-4636-e545-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fcf-4636-e545-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fcf-4636-e545-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','90.147.75.214','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"num_cpus\": \"2\", \"os_distribution\": \"ubuntu\", \"additional_description\": \"\", \"mem_size\": \"3 GB\", \"zabbix_server\": \"\", \"num_instances\": \"1\", \"zabbix_metadata\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99fcf-794e-baec-a6d8-024283ff312a','2019-07-06 09:21:00','2019-07-06 09:41:02','7ec3e96a-9fcf-11e9-b04e-fa163e0663d5','','DELETE_COMPLETE','{\"endpoint\": \"90.147.75.217\", \"node_creds\": {\"user\": \"cloudadm\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqQIBAAKCAQEApfF0jQqsNd1+QIak2qaUJmYVJ1xTbTCcrZb1IoW93B2Dednj\ni7/icq+0RP5+EZEB81OaCFPlBMfSszOlGvclZ4vQvI68hsRQDkHt/NR3VEpmseyu\nbYny3EXbHSqDfCfnDtfb5cWWtpXwxeByeraKo/rXbaxZhxHTuQGwscOUBbNSHDI/\naR/Mbyie6LvZ+VVSQfSpdhgFO9F5MTfik9h0UbT9qMguXt4sh4pfdd9LfBidcoOh\n5VOZ9sHF1Tfu75ocbyUpNNng2zYv4+sPWlS/xES7qMTDxfSPMFSuwiLP0ytWpnOd\nva0kTQnykXMfiabMOE62i73L5Fb39nDUQbIF9wIDAQABAoIBADeM+/pXL00c563M\nJRW5G/E6zSwPATKVSm3mEgvLf8JW8vNwmHbo9nJ0FUHfe+5/f4qoWvEcvJb8GbG5\nwTSktZXTPT5R/hSTVUVglr3DlmrWOUiotb+fpXhNvksmNzvx06ypYEir+4cF7MMh\nHtGrl//K8iEZyCKqOhk90pu/oCbD1d9F9DDKEFbkwII4SN1rV3fgULep6eNEup9l\nLPiCPsaUhbJRuCLvOMD8ow4DJiFk8wQ2cvIiCWGima0prpHR58CdNKcGaW5AOfrb\nqH8PyU1ond2NgVwj0Q4vDyTK6Msv4ZlXNivvFTu8xSrT0ffl6j8PXXr9k7hlBkUV\nHSY4JakCggCBAMsny+63MYtjWjqCJ402/IVgvWba+j0IVWUYtLN9fp2rv/ZE1DY8\nIP3o9ZPxAPZMN2zZmsobZfiHda33CX7JHLYAUehEKWkn7OQQJ8f6KbE4PcZ+2iyo\n2KNPvGMIxrxYq0EnrEFVNxxYYlicjeFPBYb2rPZhmTdDWwd060NOka4dAoIAgQDR\nG6247EttY0MfEMUb7dVyZeFKMNqHXhpylmuV5HP2Hu9XzSo8NBAXjEe2AYjhjixy\nwc2PQssD4zbpLyKBDW57F5ciIdBaVYg8DNO6QehsmDXT5O00gWlLXMiirlr+58sX\nzZRuxd29ncrvdUBjyz3i6ad8P5/UNkbVTg7ngR6YIwKCAIEAu4alwVnK2v6/2Agy\nmDCskjXFP39cxB/AK8zNaG2sBcD3Nk08kj+YuKhkn8Y0fCXId6q6LltyGiJ4JzhE\nxIrB/OJ4uOzKSO34xmB/SCIMgDEJHQQVQmotZzqAC+6a/Frg4gjMAZa2g2y2g1Mn\nyFWYJYfoCpn2w0NicJSlYgDRiqUCggCAH2i8623y1nd2eZAXS16qFQjgkjhMWtDz\nwAqAFn++O1XiNZoHogtf72mOy/PnD5o/au1ZZw9tVyQl91ixIhlWYv7kIKhbl3YJ\nhJuYof2MX+NtEmrshlp56mwBZw4xdOB0TRsAFLN73yN4fAdsqJC6tv7JvYwBAes1\nMI0NCBEI+2kCggCBAI9y7OmqqMcHjLd2eRROYVXv4FnAxhqwLLWMIjk7K/MKskEI\nmqMIeZgVolmqJ0ymr5iBMivdOEVHdUInTfnnQr4+aRbXPOUGTzn9pVNqvz8nsMis\nf4wxTgQdTaSys4osTr8Q39/hrhYuoklax/AzpscU9+ZE9534bKHIPHvzj0js\n-----END RSA PRIVATE KEY-----\n\", \"token_type\": \"private_key\"}}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fcf-794e-baec-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fcf-794e-baec-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fcf-794e-baec-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','90.147.75.217','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"zabbix_metadata\": \"\", \"zabbix_server\": \"\", \"num_cpus\": \"2\", \"num_instances\": \"1\", \"additional_description\": \"\", \"os_distribution\": \"ubuntu\", \"mem_size\": \"3 GB\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99fd1-04f8-dbf2-a6d8-024283ff312a','2019-07-06 09:32:00','2019-07-06 09:52:13','0e3f58c6-9fd1-11e9-a036-fa163e0663d5','','DELETE_COMPLETE','{\"node_creds\": {\"user\": \"cloudadm\", \"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqAIBAAKCAQEAsVnPuXUdgsFz8+UD9yq1dTgdQbrMw2Ayr6WqZtJAOoJ7ViQg\nd5h1kpjjaBwEoaTOxZQ/uus8olTDFklPrHroHy0ujni7wCpbdiqEikmgoPCBm00m\nEvhj/3DrQXIiSNgbyTW2M09jhG8FBXVIETotflSLy/aa/fKUklUnfOXke7Tontf+\nrO3W74qjEkZXXnSo5SJprWDaWzBKYBSNoriRMMfT00/4T+z89u462iraypwefNGp\nmmCRLEOSUaRRSMyw2zrbcs+I2EL7GIdxMB5tlIASIliLwFHDQAtdprNz8bWtLniK\n/7UWNIDn/GMn3wnInGeqnzzL7aACHhYCRYz3kwIDAQABAoIBACPIcjACIEUskR+p\nmoY5OMmA2+5SKVRWSYPFEj+StmDXyNjVizN2MGq2rFNqK8kNfqbAxacKJX6/SWlq\nu0eauNDphdY7J+6a3T9XTsy0FFPEkvHpu//h3BNDDkRzKdW2vMx5KNzrbLHg0IuM\nYVEQgvNVTauGgzkvw6hOxBvgKpyGyn8Hxt+a42XAlu6oadg/VLEVcclcljZPukU0\nQgx9egzfL/2nepdIxpec1b0p+gvFhyiKT2dO0kofJ6Bq14//rOxFQ69x6EivPKuv\n4OWugC49uBdpo2TTS0s6GnZ3UhOAzD+tNsAC5Xtm4GdYqbqusCwlOEIu5AB4DPUw\n1TvSXfkCggCBAMKwEG6UpIzVpD+NimMn+SPZvyHXZfJtzmXMIdc2MWykEFDx4h8v\nw6QQwjSwodTOEbVNr4P4bd5XH2vTgMJy6yBde7Vii+e7MQMEPCFsYRRMF691A31K\nHDQMOa1gMt7TToQsS5ElQBpylG+Fkgzg1scNbFgQ8L6hRn6dg3Kv6GsPAoIAgQDp\nNAaVCy8dSgyNxuuIF7c6TlolJWhlbA6w2Uk/cOSkYNyC4ja5krVwqnnnQ2zjkaRQ\n8Z3v706b+CLH2VXz9PgP/6Fzc6/M0UPQkQpsmbhlLM1SuMKPwnSr3WMvwFcaOT0Y\nY2TIf/RxBDm4t2G+e7QQZEP5OFW6fNiRAtAKaZE7PQKCAIAGHRVHA6/vJD5WKJGx\n721pbMsNuv/ejwguNizR30fKC5Tfldjt9cgE/Om8UdejIR15PglG8aQxmTbJYgjn\nEkjD6WubFI8kJcKyP43L1uVth74uqlQDuTINiFy/TwgJ60TJ7cIpuqu6qOJ0ZhNi\nCCV2drtyQIXu1o2qKDQag9+ejQKCAIEA5TbdwWFczc0ayb/bgcjNr+GTeS9rjUTI\nq8rm1BSCp48NLxhp8bzh2fu2FjmPrZ5Zg7X5Jvxwp50dkpFsin0d1ZvNdU0gXpDR\ntw7Y0CXHuKpwpf40PllDlCnmc+j5tCzOgEoxpWEfQnaExap5yGCOfA4RQcS9fq93\nrhC1q4ZX2YECggCABODdbD3/5odDY+wGYtxBV21zqg+OR+stfKx21pLjhXgu8U0o\n8dqEcJK60KS6WxzVCeY9xmVkwu6HWUJDN4WUKhSQLNhqw3xDY6K+kJGNK13bBdLi\nk9XTvHN689RnpXb+A7+dlBQShblfgdtBzpXrzqjQS1sI2tS/GPpY+PvGzUk=\n-----END RSA PRIVATE KEY-----\n\"}, \"endpoint\": \"90.147.75.218\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fd1-04f8-dbf2-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fd1-04f8-dbf2-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fd1-04f8-dbf2-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','90.147.75.218','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"zabbix_server\": \"\", \"os_distribution\": \"ubuntu\", \"mem_size\": \"3 GB\", \"num_instances\": \"1\", \"num_cpus\": \"2\", \"zabbix_metadata\": \"\", \"additional_description\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99fd1-1706-e649-a6d8-024283ff312a','2019-07-06 09:33:00','2019-07-06 09:52:13','1f9bb6fa-9fd1-11e9-8af8-fa163e0663d5','','DELETE_COMPLETE','{\"node_creds\": {\"user\": \"cloudadm\", \"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqQIBAAKCAQEAmIsGTu2i5GFD6//FmGHvfig1llL5l1uWlqiT5DpcASveAqVC\nwvQxluw8nxzBFwIRm78OdNwgD/mlplvzYuW1bucuddwU3abasb+/Nu9lMdbbj0nH\n7rJ5zdBBj2I8MOB/zFWu3DmkMyPScRlZ7gCxQh8qtgbA9HZsUuhOl6YoX4wAWwCz\ndWghJdiu+XZtoARZfgbZszsxLZWk31ZjH0lKjOqgRjxN3yrs+MToJ/45jXgYBMOQ\nEONyf3GhK13ojcN5x6yczZSG3Ji2l32oxFE7o+dKFPMVOUh7B6nRa0Jqh5HuELrv\nzmI2V85MLEAc3kGGj66vFdWPUDGjbbs/YH9NOQIDAQABAoIBAGmsJXqX9LfxCXR7\ngw7FCXuDr1urr2vC7tb/gTQhmYrWML30bgNP1uqOTJCNAtZFgJ08BW++7hcjAjX0\njO594uopDG5pP6ss42MvSe9sd9XG2eKxYedhjC+fjUse6kORwfZzhObap30l26qt\nvTa7FBCSNqxSkWjIgNIOTCOR33YQHF5C3qsH3C/3ITqCGwIWTsYz/zheTxUfi98K\nsT3liyxPoCbIfUtyCfonf1fEzGJKQlRncHHULcOZdxrQdu3Pn3EcKxHxarLAbh/R\nhn2W+dnAij5nohzRwz6zrSihCXnnEJG+l+kHKD7AuS6so6FmA1/vNi1JzyWZFKXJ\n1y8bK4ECggCBAL882lI+KnCRiW8x/voisaKq/5WNqHzPbRSaYKqjOTACgVy3yjWy\ncilcCpyzVWRp+4ASdyX8GH3+vGANA90krPDsuaKXBMwcMPgMiWlAGpG/Rt4Q4ZN2\necR5spRhIF7cyFs1PN1icBagEgSqXqFSS+uTb+vrFwGKSHFId3aVb9etAoIAgQDM\nM5TfLNQue5IM7kmiHBp0+7O8nH9Pb+T7o7MAS+/vIl8WxWLei/+C5pCPNxseRGy7\n3Jct/MSkV+NAX2cpayBLOw73m34cQZVBZ+fOp+jxKbjN0hNmCcn55r+kF4p2smhw\nBx5iUFf5s5/+4ih5E6QzJ0QBe9o59jj7qK3a952tPQKCAIAtGowfc5wM2raAbFlH\n46DjzdLkEfoYHdALWPHNrRuS0DR0isB9c63rRVMXbFCKk1iG91P0uIWKSedh/A/a\nO4kydZK+30F5ZnjCOCq8kSrzDxsGyxJ49it4BH/y8Qlydj4nDOJjEJGBNJWrVgdl\nowRW9noiOVs+uL+nQEE0zcAILQKCAIEArwJmTP+2uj/d5Ic1RGKhqjEu0i+uTP6x\nWZnrCA4NDP6AUJvLKMEDs8S3kIbCDybFqhxc1WUVg2Rvt/QMDktp2hA7u6rgYocy\nzGOpIEx4MHh5kqzBQ2qQWEWTaadjXGd7asgvGkORosh4D5L07RAQYmb8uejUF2kX\nXVgr6MbftGECggCBAJ0Bk3G1ZWWDSseEcFp43WCkphTIVikp9OVGR1TAm3nqceK6\nDSGMaec5R+l6ehYvcFBQNUrDM+nfexLTn6Wli9d4O/iRexl6ED8LrTr2+p1WQd7/\n4t7q5IQ04SDjlatWD5R0lmnscIAzzfM722br+sHqcSsf+xOxgm3leJAtoYDH\n-----END RSA PRIVATE KEY-----\n\"}, \"endpoint\": \"90.147.75.219\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fd1-1706-e649-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fd1-1706-e649-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fd1-1706-e649-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','90.147.75.219','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"additional_description\": \"\", \"mem_size\": \"3 GB\", \"num_instances\": \"1\", \"zabbix_metadata\": \"\", \"zabbix_server\": \"\", \"num_cpus\": \"2\", \"os_distribution\": \"ubuntu\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99fd1-8ef8-ecaa-a6d8-024283ff312a','2019-07-06 09:36:00','2019-07-06 09:52:13','9960e866-9fd1-11e9-b39a-fa163e0663d5','','DELETE_COMPLETE','{\"node_creds\": {\"user\": \"cloudadm\", \"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqAIBAAKCAQEAqT8hQaqc/xZO9IhoF+9asobDO2qTN/kMU19tJxttEx+awcQM\noXYCZqepoP0WC2O/BtWH4KtyPyConK8kDoL1Jkye4+Fpvd1zMq6vYQ9kWf5X8Ywa\nIG7YLQFcLdEOrW7eqZ5oVFsikWCP5zAiIDjrPsXJ8SgZ1QdqOQj/LBosdyHZdcOs\ne0qtomb7tWDQTrr7xD7NxUHFAf0Ai8i37fSO5un8Eb8kVqnJHF8ndtn2gbtvt6AA\nAgV8lerh15H5WkQnWTkEQPELEyOLEyCrzI5Djk/3EFueWrv3xXt84Er6FMdYAPjg\nm1F5rzYFJXdlaQriq0t9UXB4+Ud3vcTab7wVJQIDAQABAoIBAFyaEAYv5aqkeBrP\nr7S437UiixutWlObzqSnZ7+n/+wgtLokHI0TVoj4X5WYJEGjF9gTaT8CT4Y+xkLE\niUPvX1bPQXiJ0yNxUSB/97FxjIS450FgWMM6IsmtHtRquE8ohGfmJktRef51CQeD\njIh43C4CZlWujUPDxNjkFUn6IC4l0AvYpuQI6/lO2A9+YAQANDilPfVy02EydJ2a\n2wBnBErOlLakMFvi/hQXpLX1IhYirZVIOUIQ7Ktex3bWHNa09v0910byKMAyoeYA\nQ1wvEBRynLhAksYwQdY9MCwLGeJVeIgd4FuriH7cYg3xXe1yZI4x+GyTZpFjK8DN\nF0MvCtkCggCBALrYoYQ6+vmic6Ge3m8R976yxZ/Ibnc8R0D7D/NCm2kFkjPKkBrd\nrL6X3fLqfdy5q2gclP6zGlCUMc6ehiwcQ8YtxzMFMlMIJtnP0B4fPeIbjSx8EshO\nFogjn4Rjx9WUnRF7diSW/ROp2pInVFJqlyZhHnA0VwhatyzFrNMWLxnvAoIAgQDn\n4vb86TMEeNdXh5edk2c9hOQB4/miwg5Kd3AvopwRCOqym9lbzVnHzO1uTs5bd8/O\njIJBcgc8/v/rVNIltMk87eXtPgTxZbP8Q3wfL7suqbp1ZsxR5WMcr0YV+iA1AruU\n/9UBB0HvaABcHb1Tg0wgdrxNrWZLDAKy3Ci0odrmKwKCAIEAoJR1m7Mk506amhhz\ninmith3mgoA7j/YaNtqOxr5D2mqTUDeSycQiJltWwOKO8RgRHBUUaCF9SCtU8wKC\nxX41MSk+vbaFnZ6v5RoY/wpSoPSUy9qGOegCrVYQTjODFyf2JYQ58RBiyHd+BYYP\njhVVegKVqlERS3jLXIs3EONL77kCggCASvfx6ipquBNpa38G4Yb6ZcVFAed2mcwr\nWp/qwTvNQSSk3EHOsANf91yllngb9y5xHNIIeqgm9u1qR+cQWehs9ynioCTg7Dp5\nSiF3S43e8mMlSTeG7yM+O9Pe0NQg/YJ4qt9bOg3in0f8dcuXnhxgzE4W6vYYkEK9\nzJ2o+10orCkCggCARPNu9LAQhMRldVfd2IPPgsZgaac+5cTA0r5crf8x5k1Q62+G\nxhhi/2z0j+If+4cV2cvNn1yv4rr4mWwR0pRCslfBfmGp0Y4ke44xgpUoI47t0ycA\nA35Gk51TpXh/sJkK0immobGutD5fKNq1n3vjndASck5TnX2FM+uVs1vciw0=\n-----END RSA PRIVATE KEY-----\n\"}, \"endpoint\": \"90.147.75.225\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fd1-8ef8-ecaa-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fd1-8ef8-ecaa-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fd1-8ef8-ecaa-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','90.147.75.225','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"zabbix_server\": \"\", \"mem_size\": \"3 GB\", \"num_cpus\": \"2\", \"zabbix_metadata\": \"\", \"os_distribution\": \"ubuntu\", \"num_instances\": \"1\", \"additional_description\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99fd3-13ee-22a9-a6d8-024283ff312a','2019-07-06 09:47:00','2019-07-06 09:50:07','1b541aa4-9fd3-11e9-bb42-fa163e0663d5','','DELETE_COMPLETE','{}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fd3-13ee-22a9-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fd3-13ee-22a9-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fd3-13ee-22a9-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"mem_size\": \"3 GB\", \"os_distribution\": \"ubuntu\", \"zabbix_metadata\": \"\", \"zabbix_server\": \"\", \"num_instances\": \"1\", \"additional_description\": \"\", \"num_cpus\": \"2\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99fd3-5839-a81e-a6d8-024283ff312a','2019-07-06 09:49:00','2019-07-06 09:50:08','5ca053c4-9fd3-11e9-b04e-fa163e0663d5','','DELETE_COMPLETE','{}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fd3-5839-a81e-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fd3-5839-a81e-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fd3-5839-a81e-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"mem_size\": \"3 GB\", \"os_distribution\": \"ubuntu\", \"zabbix_metadata\": \"\", \"zabbix_server\": \"\", \"num_instances\": \"1\", \"additional_description\": \"\", \"num_cpus\": \"2\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99fd8-523b-6fb0-a6d8-024283ff312a','2019-07-06 10:25:00','2019-07-06 10:34:32','603641ce-9fd8-11e9-b41f-fa163e0663d5','','DELETE_COMPLETE','{}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fd8-523b-6fb0-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fd8-523b-6fb0-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99fd8-523b-6fb0-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"mem_size\": \"3 GB\", \"zabbix_metadata\": \"\", \"zabbix_server\": \"\", \"os_distribution\": \"ubuntu\", \"num_cpus\": \"2\", \"num_instances\": \"1\", \"additional_description\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e99ffc-9712-13cb-a6d8-024283ff312a','2019-07-06 14:44:00','2019-07-06 21:51:21','a046be32-9ffc-11e9-bb42-fa163e0663d5','','DELETE_COMPLETE','{\"node_creds\": {\"token_type\": \"private_key\", \"user\": \"cloudadm\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqAIBAAKCAQEAhgMdD0Y8MOAwp3EQxqTsvfeU7ApxRLPyQIPVOnbysWZl3dyI\nWl+2zKV8gNKTU4b8zKyxqZc6yqqOUnZTSOjg8O1vioJxV94U3o5SI8Vye3Kwrs07\nCBretF+B2qlb9miFncghJe7MN+Sp4wufIBh5bfQ47WEemeu7BiY0hWtWBoqwk1Uz\nFYNKGVsGen9lbJqymKTBpeMM2b4n/Y7pX0D9KfQLmpv5Y+EFkNCbY+VM2a1xKzr6\nLVbR545k7DUFcJJTw08KbeJl+JzaXacNTzQrYZsU7zBIY1uN0keBKOWMbL0FBPib\nOLfoJ15hK9RS+hA9v1wr6iGXF6/kpumdPRG/ZQIDAQABAoIBACa5FZeJSvEwhr6L\nXDaaB1JpDN4bslkQygo8TcvD/SKnnP27sKa0i4ScuNocfrefBMM7j2aarUFMgS1w\nxWYG7KCRay6RvKCQKmWYqEFv10G2hTktUkZoRTvHcSU21LzhvOI3puRoGRh5eWGC\nxSsoB0ZvUFe/PXFqfTMsrPZ0anofBA9fpRYeDSXdoEeCb983WdigmbM2sj8suXAg\nakqayW0U7I3mDOCQCCjDRBmAENTM9nkDPux2rye9PhZ0NqVOSlSsjeIjd6Ct5Cfi\n84Zu0eeo7NgCrSWWfYFJF2kK0kV5D6njW3XZXat+whXDKNN8k8GzyJS/i+sAxblL\nje31GC0CggCBALUtu8Dj6xk+O/pRDgMEOe5C2ePXduzIM/rVCn1X0ZzaTR6dnS/k\nocvtPreg9nm7WmXCUgix6AIdiJXEgO1R4h1a6p8nnO9V/foLtSQO59RwASU4ZT4Y\nq3hvCydYUslcoQz4PznYavHWMB+tCgFiBFhrAaS8WDFfVgaj7aOGZ8krAoIAgQC9\nWux76rAkXa+jt09aaNIzLHXYFyxyZeHSdvCsLJHA3LMOh7NUbpfpC1v3Wln7PkIF\nZPdhxVSQWsYEh7+Y3PZTDdHe8WkyLO9aqmUmnrhm6oiO7CFQLcpH+hggFsIc8YoW\nwDxzfPnKDzRfM7ESW/AO09pXenZDVcqyR0MzkNoxrwKCAIArJKbO+fcj3bP+mYqS\noVECMZ0dKlPBcrMeCdkjm+PoS/uNTM7/dpwoqWgD5iqLNlgCX1GVjHfI+StrLo3c\n9WC4yMuR9qbiP0HpZxxNZ9dAuSMsr888CDfcx+SKC/g6xvn60qqLpcNhrzVqdZQq\nXCLYwzJy/f6qUx9zGVofVIQmXQKCAIBp6OE8rhe3P29t8qm/t8FaPhPruYpysemM\n/lm+827SoJ7GEcCMCQ+OmXvm7fJGRJxIyCBV3zldRGhdQFA5/90Gt0QbnotoNRnr\nbEMHRt99MNEQn6JCZlotyASWbiREbBUAhKVLMyvDiJ2SYic4TZQHtxb4ttZO8z1c\nWd+MiAiCoQKCAIEAmcSVyFDO0uf9dyFQY+DKKEKhGtopbZYCmAPGgxp9O6Pm9z9Y\n3swNykMpeVo3EoWBMXo1SxkkFlO0FdOZvIGCLtTwepkEOFgfSFrcoKJdQ2m0DZdh\nxU+U8GOtpMDS+b4pF2hO3exaYo7YmqUOpvV4mu0ULzX3ma4LSI4/PTtn8Gc=\n-----END RSA PRIVATE KEY-----\n\"}, \"endpoint\": \"90.147.75.76\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99ffc-9712-13cb-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99ffc-9712-13cb-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e99ffc-9712-13cb-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','90.147.75.76','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"additional_description\": \"\", \"num_cpus\": \"2\", \"mem_size\": \"3 GB\", \"num_instances\": \"1\", \"os_distribution\": \"ubuntu\", \"zabbix_server\": \"\", \"zabbix_metadata\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e9a038-4407-df8b-a6d8-024283ff312a','2019-07-06 21:51:00','2019-07-06 21:54:22','4f734778-a038-11e9-a036-fa163e0663d5','','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a038-4407-df8b-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a038-4407-df8b-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a038-4407-df8b-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: luks\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"\", \"instance_flavor\": \"small\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"storage_size\": \"50 GB\", \"version\": \"release_18.09\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.YBrubhd33SeIOMGBOhsdjWRr\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/0bc2a13c-3866-4be0-99ae-b6beceb3451b\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e9a038-8f57-81b5-a6d8-024283ff312a','2019-07-06 21:53:00','2019-07-06 22:31:27','975623d0-a038-11e9-a8ac-fa163e0663d5','','DELETE_COMPLETE','{\"endpoint\": \"90.147.102.13\", \"node_creds\": {\"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqAIBAAKCAQEAtD4zuM+y6s+rLh1AhT/DXQAWq9kIXxmBrIMwIORd7Wb04P5d\nzz9y0EbdUiaQW8tKsroEqx2s8RMr0I4dLwRu/+mczELUCo3HTHzzCXWJ+/Vch6SR\npsTEYHFA211r3BNTQqvuYdnoJ5s1C8o6a1+kMSR+3pVPamP+rQEtUAlsguKVbCTk\naBkhgrbHtu9IpKNlnN/xGvgbKiTXraUtjcdg6XvU3o9lF7mUZuvRL96Chby+nNse\nVhK94z1JZqjN0v79aVyYg95vn00XRERl7XsVEkOb1pc092uxFghXb+T6PUTqGnKe\n3gaH02iNIh1VD/Gt0wCos4K+CD3oLsS+LrrFiwIDAQABAoIBAB9QdzfyjckRz1Gx\nr1X3H//2VfoBON0c11Sbbi8ovdDTBFRanP22rkHVLfppzMbF6PJoMwtvmm4/wGr5\nZcSXZpl7gsxSB/jVbPyy8J6CFzj5BdxjERMCOIPw6S2za1vO17ZLnJzPeO/4nRyx\nQ7kH4sTO7GPLWQLI4KQ6Ah9Xo8yROh0f4xWPHGr1OMApspIzX776/yu/A7iHhTbi\nO5XTRARLkvEgAR/tsfuHJ7N2lbY5+gK43fK35Sh0gmQNqyThUrgZ6PpLazpqMkrF\nxW+JBU2y3ATrUDLMjs48S/YFLTVCPnBS+ccaumpmdHIDs3winWqw9JKAI/DcD7FF\nCeWJXyECggCBAMMxg9h7cMVtXG9O8epAofUfJVi5sCZjpxJwBWyPSiPpdwY4wd7x\n3aX1cSPEtXqMrR0VtQpKWOf3Nivgqax5ccguXu4BGjPuq8LzM2IDZRN8GglAAB39\n+EvsI6sP9kgClyjRDmrjAf4OM2pilbma0OP6EvJVbr9HrIxCwCfg2RaTAoIAgQDs\nZGdkv2p8JMjtTrU5bf1ZPCZJ/CUeSmXmA1BJJ4aBUMokS4giL8dLGANlXeNwo5W3\n/veoIhQLENGVwP4dM1GXDDXlaeP9rvq1eDtTNSvi8pEjnQkaKiIxV97HNpTp2B9O\nBa77UdaunkqFcPfbfrQzt2tePlCleCAHTuKQwqI4KQKCAIA+hNqE+Syqn5eOs0t6\ny07UkzBEFd2cvihiGG00U0Tc8cdEv+MgxHlI0a92VGgII4zDFxPQgvWs/ppkPWY7\nLv7JrkiLlODOp3BuVbUsfIfgUMyKD+y5roHb13upK8inUeUWlrc2dxVJSUUgmwj3\n1OV5T7zHz6NUMuHKXwrq+vKtbwKCAIEA04wSvyVRzSE6MqxiH6/frrDWbxVXvmDE\nCfBjM+RMSYOcMpjpjfaF+hzWRSudc1rhjFR/GxbMKw71EHgysL0RQgRqYxC9OHQT\n5rxfEtqdmK6M1nsc/y4/hTrmog6lexOvCCqr6jrVzVTYycxL80DTUQjO6/sGPt5e\ng0vEE9oqQ+kCggCARLITLoF3exkjiIjpmD9XcYf61+V3ZMjzz4KS1cX4/7qG1WRw\niCGx7kTumHatpESPJyFTuAjYOtZ1YKEN1VHa5ASZnaN2gQ+pxWKIgSj2Ckk6yz7H\nG9l3Z8NxuVOZcYaRHJCs1Ds+bQChsP5nGfMktZoIYPtlM2ty2vKbvHrJMTg=\n-----END RSA PRIVATE KEY-----\n\", \"user\": \"cloudadm\", \"token_type\": \"private_key\"}}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a038-8f57-81b5-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a038-8f57-81b5-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a038-8f57-81b5-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','90.147.102.13','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"additional_description\": \"\", \"num_cpus\": \"2\", \"mem_size\": \"3 GB\", \"num_instances\": \"1\", \"os_distribution\": \"ubuntu\", \"zabbix_server\": \"\", \"zabbix_metadata\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e9a03e-9c9c-82cd-a6d8-024283ff312a','2019-07-06 22:37:00','2019-07-08 09:39:58','a42b465c-a03e-11e9-8af8-fa163e0663d5','','DELETE_COMPLETE','{\"endpoint\": \"90.147.170.19\", \"node_creds\": {\"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqAIBAAKCAQEA0edA0ZbZgMtguQtWlMAwItzPrFckyRZhq/BqpYgW1P2lLkO1\nlHsgFqp6jVGpd1b6qMf2CZM1IdgQ2aMEYnU23MBSiMGb3v1UZvdKzo19CA7uRw0N\n8v/f57JS7+uKrEntSEGL4sbOUzbSwl4dz0gy2L+DP9QoCnNOinOT9c3LGhOQ22Uf\nBPuAEH5QvFeQ5gtOmKOOBs9k4gQ88rBMTQSSS/fMT4PAVwwHvaa7neGGOYD7MyLD\nx/P/LYSdcY7ma/XSIJx97Kx0OiArd+nbgnQJikFM4/InTdJMu/ZwNONsAJszgjGl\nGodr0VE4TyXad6xp5A8NLI89sQQj4bx0H8N7dwIDAQABAoIBACp/jNMinLUD+Hhe\nwE/rvZNBa9az6iHAo1PhoGYVcLH9DPWaBeijKTMNnzR/pTUhaizEF5+Gq4pHqdm2\ntMuOeeYmFk/UC1ARsIYMaZv6b6czBrFiBkH95oKNy1cCNJh/e0hW5RCsOdgFUJTD\n43s1Xf4egF9rABRlljBYCEwLN6T2lNvKym0Alul/OafDQCLRmfg7GWi9hHEnLR1b\nY+oPCVLKJ1rmpH3rFH2P8i6z+eWcGuzqpPmVv9x05qXDYmfTmR2NBaG+FhRtNgb1\nqjykDYfmWpMiVo2ul4Fs8N8NJYyLX1izC41U5RUyG4YvgHcw3dL+k9V/+WfK6v6w\nlZJxUEkCggCBANI+x0k/AP/IgdlYuox9fM4O50Vum5FwgRLtF6qYNM91Meqm4PMf\n38cNYBMFUxjbS8TXBpBf8A2ztjf2zB9KTsAzZmH6HKwh+xISm3nAqPD+KsOC8Ik7\nbzi0Rt7u5TSsXNRzImuLz0ral2nUVeZLnXUbhComuNw4nxKuIc51nTFLAoIAgQD/\nlW1PCM86dTTgXPCT2eia22bcWBfKIZalHusVyL4F+3WPwi4XE/OyXs/qHz0EokEp\n6lPr3PTFMbZpv/H8GzB5/ZubSVP+6lZnUTVunp3PyzyN3WP6y0UX2YczWtRH2ZRm\nvHBcVe5aiFir1830PGSs0qT0gDeZttIseGRe4LZvBQKCAIAeOeRQxXwRSfRRGQ6I\n0Cm3PjFFrCc1e6Uy4V87qXI+OS0Z/S/uBDEZ3vRnB6bwteZowDkzXHeYoLObzCGA\nhiBYRYt8noaswJ3l9ULg+C/RpdjkDtkiAad10YU228WcEwOtj3ftWkZNDqwiDOLk\nnw5eHbycisCc+I72Eo7Nrd8RjQKCAIArQsq2xwH0niQuGe0qyYait6Joh4y3TQon\ntt0J2em4L4ENrUuJ4nmsZnoA4fq9Dw3Cn4RG9yaDPk/nBHNcPentrCyrkzThgB7R\n7CAEMlr58ie0x5WFvORcDhjha21lIAILhbfrGSx4LH390FBvF83epuT+8bj3jsdy\neYpbuOOIVQKCAIEAzq62OlQOeCuaqJ3Rkre+qruBhy6nzCmM0A31rzjuAsGtAL3A\nQaZYKtAMfUoizQoYSu9ypgbQma7NJm0TcaOtfeXNPZ8/ILzrs2gwVooN5pOfP9eL\nnQ4t9Hkkrj8GSXtcr+KNeCL5FeJvABd5Pm44dEzgXyO8NpZ3BXtdpZ5tnE4=\n-----END RSA PRIVATE KEY-----\n\", \"user\": \"cloudadm\"}}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a03e-9c9c-82cd-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a03e-9c9c-82cd-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a03e-9c9c-82cd-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','90.147.170.19','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"additional_description\": \"\", \"num_cpus\": \"2\", \"mem_size\": \"3 GB\", \"num_instances\": \"1\", \"os_distribution\": \"ubuntu\", \"zabbix_server\": \"\", \"zabbix_metadata\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e9a174-e9af-03e7-a6d8-024283ff312a','2019-07-08 11:38:00','2019-07-08 12:33:33','f1487ad6-a174-11e9-8255-fa163e0663d5','','DELETE_COMPLETE','{\"endpoint\": \"90.147.75.203\", \"node_creds\": {\"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqgIBAAKCAQEA0BqD9Ih6QGxxnkY1yB1knTFWa0fyCj5qJPGqqeXsFqU9OZuy\n69bcgFp9KFT0CqJZKDp5ILejLhMLJGzZblXhwG2P2jxDrc/XN/p3f/WQ/ZXtjiLS\nlDMQM6GSZJY7GZ94X8V4b8nCFhZwdQ3eVPPV9tJFm64CKAWVTCvqaQ5N0ICOP/2n\nca0/6QXilox6kNEHOlS05Vr2fncRPiz3jbD1LM94EU5Od0fBcjxF6WQpmTyW1dxS\nBg2rBUmyRZOPH8B4pd3oCcoh8fpAVUvfQm6BEcH6SxYT5ncisoSBGYB3lrqToLc/\n9hfHksL73d+02li99Jw0fd6v1fwS+1p0WN8qCQIDAQABAoIBAQCdbMGPtcKNg7u7\nmK9Mr/eR9mXCiE1wNGEFi4+oMNeVFfEn6EHEqOhrbIirfwCSHthFV16UQnb9/sf6\nCSG+ltdNQ1SEKfykusq7fQzzTqgdPVLUqEEWfT5vYHWnBAK3Umy0PmTqY/0fyl/O\nHOyo5UBiFBU2PL9C2V5kngAY8woohAlEZFCun4WvOHpSUCuischbNsZnlMWbp9eq\novWOlgzVhYrJ3ASXjgdcs96yHlzvodWxaijADw772Hle0NuERiDmc0lgzMxLixv1\ns1PyQY0vaQ1Dcx1q6zyiSvsZF2eKQssgGmVBINap34U6hT2gMWVfjw4mX9JWH8Z0\nMbnKtInlAoIAgQDVGH/BiZwfjKyZ5zest0LzFrsMV+z+pF9/vU+cV5F5Gwbi+Rez\nHIl75zJ+xPc7EzwiEWUkbG+9lIu/QHuWouQZdj2nic4567CjsVSQovrSztOmaMJ8\nw24ZZ6MlVuSzg7eqbCMajdbgRd7XIq7X73QGnEWVUh+CqgCooG4q7EHLGwKCAIEA\n+gC1om7WiFE++jFbADOc12S7+Rqmd94nT4+GvAcWyW3Ib6vZZmcwj1a2oAG8Tr+t\nGNpBzjCFe35tta3SLoZnt9aeW5aTAByD3wKkBhyDhUcI7XBsjBIm3oTa4EE60IFG\nZKYiwUKRh8YPruKo3xQyl4rLsb9jEsPXH0EzpiV2basCggCBANQLouU1R9PlKcOj\n3zTQz6ARWGO6AqyJaDY2bUfHo4x9JmcpMzoaBXzz3L1kxhdU1puX76tE9BQUAtN3\nGQQWZyAnFsbmS/461/SretjKNQkcomOPDykTVzWUeTWot78iLNs669t6lP1qyYoO\niyl4r138lwk1RQHCpREnQzkXC4lNAoIAgQCwSLfLJeTYkpGZ0huc9MfvifSSHpyr\ngVau30HebBFBT8w6Ei9l6fVv3XFBOngR/06La7tjLQuynN+3cC346IVSOF/JrU9S\nkMjcA/ys4oZLAF/nLZMc4d/OoFfGMbjLNZzxc8SmCc6csqh0ZRc21gMmoJQpbg7q\nOHYEb/F/goMTqQKCAIBR/1ef/xmf5rv5SnrbLksr6cymKgLICQwh32chQh3SSGMX\n5QurECozJU5mkQlBSm3+3g91PW4Flfc8xyLpOUJ/eplri3KoSR7zQNL2EH9CWnGG\nv5gajCf9y9F4cXVM8SnjUScqQI9RzaM9KsWgjvkr0MhQHFd9jbZTn/L9IObBAA==\n-----END RSA PRIVATE KEY-----\n\", \"user\": \"cloudadm\"}}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a174-e9af-03e7-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a174-e9af-03e7-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a174-e9af-03e7-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','90.147.75.203','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"additional_description\": \"\", \"num_cpus\": \"2\", \"mem_size\": \"3 GB\", \"num_instances\": \"1\", \"os_distribution\": \"ubuntu\", \"zabbix_server\": \"\", \"zabbix_metadata\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e9a234-f56f-934e-a6d8-024283ff312a','2019-07-09 10:33:00','2019-07-09 13:58:04','fa52ef38-a234-11e9-b04e-fa163e0663d5','','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.170.153/galaxy\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a234-f56f-934e-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a234-f56f-934e-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a234-f56f-934e-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.170.153/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: luks\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"\", \"instance_flavor\": \"small\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"storage_size\": \"50 GB\", \"version\": \"release_18.09\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.7TCnngfZLOLYDtsfliN4DGOp\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/a2304f29-31c5-4bd1-98cb-fd9fdde7b88b\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,NULL,NULL,NULL),('11e9a246-febd-9bb9-a6d8-024283ff312a','2019-07-09 12:42:00','2019-07-09 13:43:14','084609a6-a247-11e9-9be1-fa163e0663d5','','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.114/galaxy\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a246-febd-9bb9-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a246-febd-9bb9-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a246-febd-9bb9-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.114/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: luks\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"version\": \"release_18.09\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/b6be4284-8802-4085-a562-01f054e82356\", \"additional_description\": \"\", \"flavor\": \"galaxy-no-tools\", \"storage_encryption\": \"True\", \"instance_description\": \"ELIXIR-ITALY\", \"storage_size\": \"50 GB\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"instance_flavor\": \"small\", \"vault_wrapping_token\": \"s.ebz9BI6HqxK8WNmiMTXMR6rj\", \"admin_email\": \"ma.tangaro@gmail.com\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',1,'b6be4284-8802-4085-a562-01f054e82356','',NULL),('11e9a24f-6354-5d9b-a6d8-024283ff312a','2019-07-09 13:42:00','2019-07-09 13:42:00','','vault 7','CREATE_IN_PROGRESS','{}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a24f-6354-5d9b-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a24f-6354-5d9b-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a24f-6354-5d9b-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: luks\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"version\": \"release_18.09\", \"storage_encryption\": \"True\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"admin_email\": \"ma.tangaro@gmail.com\", \"instance_flavor\": \"small\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/326ee23d-0952-4a68-a6c3-4e673dfb75f6\", \"vault_wrapping_token\": \"s.BhTark9UOipUTdAfh6jvCpFl\", \"storage_size\": \"50 GB\", \"flavor\": \"galaxy-no-tools\", \"additional_description\": \"vault 7\", \"instance_description\": \"ELIXIR-ITALY\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',1,'326ee23d-0952-4a68-a6c3-4e673dfb75f6','secret',NULL),('11e9a24f-7f6c-e5cb-a6d8-024283ff312a','2019-07-09 13:43:00','2019-07-09 13:51:07','8a49a77a-a24f-11e9-8255-fa163e0663d5','vault 7','DELETE_COMPLETE','{}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a24f-7f6c-e5cb-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a24f-7f6c-e5cb-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a24f-7f6c-e5cb-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: luks\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"version\": \"release_18.09\", \"storage_encryption\": \"True\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"admin_email\": \"ma.tangaro@gmail.com\", \"instance_flavor\": \"small\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/16100f01-8cac-4f84-b385-f7461136e956\", \"vault_wrapping_token\": \"s.HEjD9JhPFB3inDIWt83NPa2X\", \"storage_size\": \"50 GB\", \"flavor\": \"galaxy-no-tools\", \"additional_description\": \"vault 7\", \"instance_description\": \"ELIXIR-ITALY\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',1,'16100f01-8cac-4f84-b385-f7461136e956','secret',NULL),('11e9a251-6c16-1d61-a6d8-024283ff312a','2019-07-09 13:57:00','2019-07-09 14:17:10','74e39592-a251-11e9-9be1-fa163e0663d5','vault 8','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a251-6c16-1d61-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a251-6c16-1d61-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a251-6c16-1d61-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: luks\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.zqLUnRb1Yrsn8dpoCPyaQcj5\", \"flavor\": \"galaxy-no-tools\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/0c8f909b-5ea2-4740-b62d-dec96019f1b8\", \"additional_description\": \"vault 8\", \"instance_flavor\": \"small\", \"admin_email\": \"ma.tangaro@gmail.com\", \"instance_description\": \"ELIXIR-ITALY\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.09\", \"storage_encryption\": \"True\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',1,'0c8f909b-5ea2-4740-b62d-dec96019f1b8','secret',NULL),('11e9a253-ebea-f616-a6d8-024283ff312a','2019-07-09 14:14:00','2019-07-09 16:56:59','f02cf3e0-a253-11e9-bb42-fa163e0663d5','vault 9','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.181/galaxy\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a253-ebea-f616-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a253-ebea-f616-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a253-ebea-f616-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.181/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"vault 9\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/5a3706a6-ac45-4f26-a747-b82b96fd1ea2\", \"vault_wrapping_token\": \"s.jZbfs3av53t0d7YIzkzjBLRW\", \"version\": \"release_18.09\", \"instance_flavor\": \"small\", \"storage_size\": \"50 GB\", \"instance_description\": \"ELIXIR-ITALY\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"storage_encryption\": \"True\", \"flavor\": \"galaxy-no-tools\", \"admin_email\": \"ma.tangaro@gmail.com\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',1,'5a3706a6-ac45-4f26-a747-b82b96fd1ea2','secret',NULL),('11e9a257-296d-15e5-a6d8-024283ff312a','2019-07-09 14:38:00','2019-07-09 16:54:07','2e929024-a257-11e9-98a0-fa163e0663d5','no vault','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.188/galaxy\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a257-296d-15e5-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a257-296d-15e5-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a257-296d-15e5-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.188/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"instance_flavor\": \"small\", \"storage_size\": \"50 GB\", \"instance_description\": \"ELIXIR-ITALY\", \"version\": \"release_18.09\", \"additional_description\": \"no vault\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"admin_email\": \"ma.tangaro@gmail.com\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,'','secret',NULL),('11e9a26a-90ba-4498-a6d8-024283ff312a','2019-07-09 16:56:00','2019-07-10 07:40:48','993dd9ca-a26a-11e9-8255-fa163e0663d5','vault 10','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.67/galaxy\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a26a-90ba-4498-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a26a-90ba-4498-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a26a-90ba-4498-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.67/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"storage_encryption\": \"True\", \"storage_size\": \"50 GB\", \"additional_description\": \"vault 10\", \"vault_wrapping_token\": \"s.uBwupSPqcV3ZcYLzA0htvFaJ\", \"flavor\": \"galaxy-no-tools\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/6ed31aa3-0b4a-44c7-846a-fb90367e5e73\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"instance_description\": \"ELIXIR-ITALY\", \"version\": \"release_18.09\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"instance_flavor\": \"small\", \"admin_email\": \"ma.tangaro@gmail.com\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',1,'6ed31aa3-0b4a-44c7-846a-fb90367e5e73','secret',NULL),('11e9a26a-9d01-1e15-a6d8-024283ff312a','2019-07-09 16:57:00','2019-07-10 07:36:05','a4d874a2-a26a-11e9-bb42-fa163e0663d5','vault 11','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.68/galaxy\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a26a-9d01-1e15-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a26a-9d01-1e15-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a26a-9d01-1e15-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.68/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"storage_encryption\": \"True\", \"storage_size\": \"50 GB\", \"additional_description\": \"vault 11\", \"vault_wrapping_token\": \"s.hl3rxDL3fgJbmMguWxsPw5Q6\", \"flavor\": \"galaxy-no-tools\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/8d2b9f3e-78e3-4195-955e-ece19b4b597f\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"instance_description\": \"ELIXIR-ITALY\", \"version\": \"release_18.09\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"instance_flavor\": \"small\", \"admin_email\": \"ma.tangaro@gmail.com\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',1,'8d2b9f3e-78e3-4195-955e-ece19b4b597f','secret',NULL),('11e9a26a-ac1f-0d62-a6d8-024283ff312a','2019-07-09 16:57:00','2019-07-09 18:35:01','b82970d8-a26a-11e9-b04e-fa163e0663d5','vault 12','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.7/galaxy\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a26a-ac1f-0d62-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a26a-ac1f-0d62-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a26a-ac1f-0d62-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.7/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"storage_encryption\": \"True\", \"storage_size\": \"50 GB\", \"additional_description\": \"vault 12\", \"vault_wrapping_token\": \"s.nLVoVr82ZBziKKNzVqvK3QAX\", \"flavor\": \"galaxy-no-tools\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/8326c4b5-ec5e-4714-95f8-211d7ecaacb5\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"instance_description\": \"ELIXIR-ITALY\", \"version\": \"release_18.09\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"instance_flavor\": \"small\", \"admin_email\": \"ma.tangaro@gmail.com\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',1,'8326c4b5-ec5e-4714-95f8-211d7ecaacb5','secret',NULL),('11e9a2e6-073c-2318-a6d8-024283ff312a','2019-07-10 07:40:00','2019-07-22 12:35:49','1482dcb8-a2e6-11e9-bb42-fa163e0663d5','vault 12','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.7/galaxy\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a2e6-073c-2318-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a2e6-073c-2318-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a2e6-073c-2318-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.7/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dcf538ee-4ec2-4984-bafe-d92df568e5eb\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"instance_flavor\": \"medium\", \"flavor\": \"galaxy-no-tools\", \"version\": \"release_18.09\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"admin_email\": \"ma.tangaro@gmail.com\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/76abe8c9-ed73-4ce6-8434-795890253f25\", \"vault_wrapping_token\": \"s.fe8dqQNWPLFwsgibr8WkNZRQ\", \"additional_description\": \"vault 12\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"instance_description\": \"ELIXIR-ITALY\", \"storage_encryption\": \"True\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'76abe8c9-ed73-4ce6-8434-795890253f25','secret',''),('11e9a2e6-fa87-006d-a6d8-024283ff312a','2019-07-10 07:47:00','2019-07-10 15:23:50','000b689e-a2e7-11e9-8af8-fa163e0663d5','vault 13','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.75/galaxy\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a2e6-fa87-006d-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a2e6-fa87-006d-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a2e6-fa87-006d-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.75/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"instance_flavor\": \"medium\", \"flavor\": \"galaxy-no-tools\", \"version\": \"release_18.09\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"admin_email\": \"ma.tangaro@gmail.com\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/3578b7d0-45a0-44f1-ac45-be1893b021e5\", \"vault_wrapping_token\": \"s.w0P0ZWYUSzRptcwszP9TxCaO\", \"additional_description\": \"vault 13\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"instance_description\": \"ELIXIR-ITALY\", \"storage_encryption\": \"True\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',1,'3578b7d0-45a0-44f1-ac45-be1893b021e5','secret',''),('11e9a2eb-0cf5-cb8e-a6d8-024283ff312a','2019-07-10 08:16:00','2019-07-10 08:16:00','','','CREATE_IN_PROGRESS','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a2eb-0cf5-cb8e-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a2eb-0cf5-cb8e-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a2eb-0cf5-cb8e-a6d8-024283ff312a/template\"}]','9c3c7f53-7279-4008-82be-60600418c884','','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"zabbix_server\": \"\", \"additional_description\": \"\", \"zabbix_metadata\": \"\", \"mem_size\": \"3 GB\", \"num_instances\": \"1\", \"os_distribution\": \"ubuntu\", \"num_cpus\": \"2\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',NULL),('11e9a2eb-1b08-b369-a6d8-024283ff312a','2019-07-10 08:17:00','2019-07-10 13:02:38','','','DELETE_COMPLETE','{}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a2eb-1b08-b369-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a2eb-1b08-b369-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a2eb-1b08-b369-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','9c3c7f53-7279-4008-82be-60600418c884','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"zabbix_server\": \"\", \"additional_description\": \"\", \"zabbix_metadata\": \"\", \"mem_size\": \"3 GB\", \"num_instances\": \"1\", \"os_distribution\": \"ubuntu\", \"num_cpus\": \"2\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9a2ec-d8c2-fea6-a6d8-024283ff312a','2019-07-10 08:29:00','2019-07-10 13:02:40','','','DELETE_COMPLETE','{}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a2ec-d8c2-fea6-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a2ec-d8c2-fea6-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a2ec-d8c2-fea6-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','9c3c7f53-7279-4008-82be-60600418c884','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"os_distribution\": \"ubuntu\", \"zabbix_metadata\": \"\", \"num_instances\": \"1\", \"mem_size\": \"3 GB\", \"num_cpus\": \"2\", \"zabbix_server\": \"\", \"additional_description\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9a2f7-6ab4-b4ad-a6d8-024283ff312a','2019-07-10 09:45:00','2019-07-10 13:02:43','','','DELETE_COMPLETE','{}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a2f7-6ab4-b4ad-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a2f7-6ab4-b4ad-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a2f7-6ab4-b4ad-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','9c3c7f53-7279-4008-82be-60600418c884','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"os_distribution\": \"ubuntu\", \"num_cpus\": \"2\", \"num_instances\": \"1\", \"mem_size\": \"3 GB\", \"additional_description\": \"\", \"zabbix_server\": \"\", \"zabbix_metadata\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9a2f8-b865-0cb4-a6d8-024283ff312a','2019-07-10 09:54:00','2019-07-10 13:02:45','','','DELETE_COMPLETE','{}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a2f8-b865-0cb4-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a2f8-b865-0cb4-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a2f8-b865-0cb4-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','9c3c7f53-7279-4008-82be-60600418c884','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"zabbix_server\": \"\", \"zabbix_metadata\": \"\", \"os_distribution\": \"ubuntu\", \"num_cpus\": \"2\", \"num_instances\": \"1\", \"additional_description\": \"\", \"mem_size\": \"3 GB\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9a2fe-1d6d-f8eb-a6d8-024283ff312a','2019-07-10 10:33:00','2019-07-10 10:53:00','2922ad52-a2fe-11e9-b04e-fa163e0663d5','rna-workbench','DELETE_COMPLETE','{}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a2fe-1d6d-f8eb-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a2fe-1d6d-f8eb-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a2fe-1d6d-f8eb-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"version\": \"release_18.09\", \"flavor\": \"galaxy-rna-workbench\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"instance_description\": \"ELIXIR-ITALY\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"storage_size\": \"50 GB\", \"admin_email\": \"ma.tangaro@gmail.com\", \"additional_description\": \"rna-workbench\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9a300-909c-2407-a6d8-024283ff312a','2019-07-10 10:50:00','2019-07-10 15:20:15','','','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a300-909c-2407-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a300-909c-2407-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a300-909c-2407-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine from a VM image (FAST).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string \n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    galaxy_storage_type:\n      type: string\n      description: Storage type (Iaas Block Storage, Onedata, Filesystem encryption)\n      default: \"IaaS\"\n    userdata_provider:\n      type: string\n      description: default OneProvider\n      default: \"not_a_privder_url\"\n    userdata_token:\n      type: string\n      description: Access token for onedata space\n      default: \"not_a_token\"\n    userdata_space:\n      type: string\n      description: Onedata space\n      default: \"galaxy\"\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        os_storage: { get_input: galaxy_storage_type }\n        token: { get_input: userdata_token }\n        provider: { get_input: userdata_provider }\n        space: { get_input: userdata_space }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    galaxy_url:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"version\": \"release_18.05\", \"flavor\": \"galaxy-rna-workbench\", \"admin_email\": \"ma.tangaro@gmail.com\", \"additional_description\": \"\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"instance_description\": \"ELIXIR-ITALY\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"storage_size\": \"50 GB\", \"instance_flavor\": \"small\", \"galaxy_storage_type\": \"plain\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9a328-f38d-6567-a6d8-024283ff312a','2019-07-10 15:39:00','2019-07-10 15:39:00','','galaxy express covacs encrypted','CREATE_FAILED','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a328-f38d-6567-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a328-f38d-6567-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a328-f38d-6567-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine from a VM image (FAST).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string \n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    galaxy_url:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"galaxy express covacs encrypted\", \"instance_flavor\": \"small\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.covacs.refdata\", \"vault_wrapping_token\": \"s.0guEGu5Lx6iwZaZUvtGhdBl7\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/a8fbaa12-2850-4c3b-a09f-4ce30ca1ea98\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',1,'a8fbaa12-2850-4c3b-a09f-4ce30ca1ea98','secret','No cloud providers available to deploy'),('11e9a32f-8fe5-c0d0-a6d8-024283ff312a','2019-07-10 16:27:00','2019-07-11 06:39:43','959d4fba-a32f-11e9-9be1-fa163e0663d5','','DELETE_COMPLETE','{\"endpoint\": \"90.147.75.138\", \"node_creds\": {\"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqQIBAAKCAQEArvDKfstyVnencfkVuaAcJ5kTl0dc05xrsrKOU6J6+2FpzF/V\nmgK6mtbvF1BvtPjRKQbB4N2PgSAVG4G9G8VdFfcPyIzXt26lqqane3dq6vDfxvsv\ncr1DJmlXy8mqNvTtlloR/Hok+PvCD1+/mxFip/wM+VCl4Yteba2FiaCf7Yj12loN\nLERqgXc9AqgIG56NLlHbm+/gAjBnMNqSAFvrGqlNJb7McrMA3jWtHvPRJJSW5PMS\nLPHc4/xJ0GFgNig9TrDE0vlycALELyXj1UCb4rBOjieTfDlGbQbuN/xPf3MwR8dO\nB365UxstLKNWaBIJ9Y1fFPLDqv/w7a/Gv/jvowIDAQABAoIBAQCuwlK3eYud/2gh\nvh/K0LxvfkcI37xGlMMtv5vYxr6ucvDavn3GnaVGWyJ7mtoM4mcn4d06QntCFgef\n8+ozXOURtT5qLPCuCPWsVVGIUJJZYwlZYMJUj+cN7zxKkwncXq8dfJrtKiPXKsEA\n1Li3MxXoFC3tvXgIqU5KqIZ3JyO8iGcpnXb3itNFXz6inq0zsO2DLh9g/0a/zQXA\nj5YZQ0qsAQub9LyqXYCcIwk2m9Vfqg99d7g0CTq2bDT36MrhxKAAiOrQuQ7+y7zE\nRG3X80zrTXBDM2yhjhv057lO8KHQmUQsc6fwqZe2LmTOA88LgSz3n2MTswFpd5d5\nNvPQj6GhAoIAgQDJnGQrRzQRWh+06bu5t4k+JFhMzWCw5w7aMC/ESGPqBms0Z/jz\nzRByDriOrWvYg74nQyfudhLnpaD01muSiJmcCAFaWkqI3jw6KsqyuJHPj9u8HVA+\ntmqsA25YOCnvMyaYpG0QOo8AKaV6VPeV1gJ1dFHApzKS4DOgIGLb9xMX8wKCAIEA\n3iKAEXqCq0KiKJ8SGnYf5puJBMtRrkNVTP5U2pB7R4Bgri3h11oxpUi7NFeeJHLO\n9IULZ9zzfd52UKW1/i+xLox/xKalEUZQDnICsdb+akqSDXdmXF/RK5KSoToYr/Hp\n2wZFTO2Tu7Zad7rKlJQ77aPDTT1qdT49hn2LnipU5ZECggCASKvVs3/j9ck9mpGR\nuDy+/KZPKcfx7XIr+VvbK+5IDYgoxmgf5YlqPyKtRcifEhlSxoY/c4YeBF/AZ+CO\nP/B7JjIAgtf++9zXasQX8lnzPRUGyITsct6ADubhtGzyOKWAaQ8DvRDOkOlyG2lb\nIShWFI5MFZxu72BfW32xBMbHnB8CggCBAND4WcyXmNeuHsjiJHC6UXZrOXJGJ3gt\npdCBrqfSpfb04X7acQxbsDqSenJaPs6BJwpHIxy5cmMl5d4mllgi26czy3rfXogq\nwmNkg/5zh/HMZyu9+JDMHwXDpKeB9PmINfyzIHynP4SmnuLl2W//J4V+utst/LmB\nLPYZoz/PCQDRAoIAgFTHXvL0uWKuSGx8JZoaYzQqauMD2k9HBu4OwbhMbDuM2fjt\nLFvqDQkPcZhenauG+86773bsmRYR4AU9UDhJjnBcep+xBDzYEl+D11DJ0+/WiROR\nhYxqhC3m3WvjXMepbUEdu1C9s3sOvXRBJnQxE8l0JX8LY0jiCK1apUpa9D/x\n-----END RSA PRIVATE KEY-----\n\", \"user\": \"cloudadm\"}}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a32f-8fe5-c0d0-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a32f-8fe5-c0d0-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a32f-8fe5-c0d0-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','90.147.75.138','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"additional_description\": \"\", \"num_cpus\": \"2\", \"mem_size\": \"3 GB\", \"num_instances\": \"1\", \"os_distribution\": \"ubuntu\", \"zabbix_server\": \"\", \"zabbix_metadata\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9a330-9dc6-0aa0-a6d8-024283ff312a','2019-07-10 16:34:00','2019-07-10 16:34:00','','galaxy express minimal encrypted','CREATE_FAILED','{}','DEPLOYER','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a330-9dc6-0aa0-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a330-9dc6-0aa0-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a330-9dc6-0aa0-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine from a VM image (FAST).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string \n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    galaxy_url:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"galaxy express minimal encrypted\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.bebSLzowZ2VENIj9EMF3DimV\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/c543a212-1d86-42aa-b26f-8eafeccc6b08\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'c543a212-1d86-42aa-b26f-8eafeccc6b08','secret','Retries on cloud providers exhausted'),('11e9a331-11f9-816c-a6d8-024283ff312a','2019-07-10 16:37:00','2019-07-11 11:52:05','','galaxy minimal express 2','DELETE_COMPLETE','{}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a331-11f9-816c-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a331-11f9-816c-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a331-11f9-816c-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine from a VM image (FAST).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string \n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    galaxy_url:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"galaxy minimal express 2\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9a3c0-c130-f488-a6d8-024283ff312a','2019-07-11 09:46:00','2019-07-11 09:57:40','c940a5c4-a3c0-11e9-b41f-fa163e0663d5','acda','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3c0-c130-f488-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3c0-c130-f488-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3c0-c130-f488-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"version\": \"release_18.09\", \"storage_encryption\": \"True\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/e76cd491-d2ef-4b34-9e26-6fa232840fe0\", \"storage_size\": \"50 GB\", \"flavor\": \"galaxy-no-tools\", \"instance_description\": \"ELIXIR-ITALY\", \"additional_description\": \"acda\", \"vault_wrapping_token\": \"s.ToDRXJoWL4wxn3Y8r0CaUNkq\", \"instance_flavor\": \"medium\", \"admin_email\": \"ma.tangaro@gmail.com\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'e76cd491-d2ef-4b34-9e26-6fa232840fe0','secret',''),('11e9a3c1-7dc2-1e7b-a6d8-024283ff312a','2019-07-11 09:51:00','2019-07-11 10:00:11','82092694-a3c1-11e9-b39a-fa163e0663d5','','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3c1-7dc2-1e7b-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3c1-7dc2-1e7b-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3c1-7dc2-1e7b-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"storage_size\": \"50 GB\", \"instance_flavor\": \"small\", \"instance_description\": \"ELIXIR-ITALY\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"vault_wrapping_token\": \"s.TfwEeWiwA24XU22G30rN4aMG\", \"storage_encryption\": \"True\", \"version\": \"release_18.09\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"additional_description\": \"\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/90503c77-219d-498c-a840-47fae8d79670\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'90503c77-219d-498c-a840-47fae8d79670','secret',''),('11e9a3c2-600b-0a77-a6d8-024283ff312a','2019-07-11 09:58:00','2019-07-11 10:49:22','657464b6-a3c2-11e9-98a0-fa163e0663d5','','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.6/galaxy\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3c2-600b-0a77-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3c2-600b-0a77-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3c2-600b-0a77-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"storage_size\": \"50 GB\", \"instance_flavor\": \"small\", \"instance_description\": \"ELIXIR-ITALY\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"vault_wrapping_token\": \"s.hFsUbPGrpeurnMJd4k5lgS5R\", \"storage_encryption\": \"True\", \"version\": \"release_18.09\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"additional_description\": \"\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/83116b76-6505-4436-8cec-609754955d34\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'83116b76-6505-4436-8cec-609754955d34','secret',''),('11e9a3c2-fb11-a056-a6d8-024283ff312a','2019-07-11 10:02:00','2019-07-11 10:49:22','01ccb732-a3c3-11e9-8255-fa163e0663d5','','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.67/galaxy\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3c2-fb11-a056-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3c2-fb11-a056-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3c2-fb11-a056-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"\", \"vault_wrapping_token\": \"s.O9QBDkmaz4Z94zaCfvCWi21u\", \"storage_size\": \"50 GB\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"instance_flavor\": \"small\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/5f6687ac-cb3a-4cda-ad35-b6ab99bf61c7\", \"version\": \"release_18.09\", \"instance_description\": \"ELIXIR-ITALY\", \"storage_encryption\": \"True\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'5f6687ac-cb3a-4cda-ad35-b6ab99bf61c7','secret',''),('11e9a3c3-2d56-207b-a6d8-024283ff312a','2019-07-11 10:03:00','2019-07-11 10:49:22','38a8811e-a3c3-11e9-9be1-fa163e0663d5','','DELETE_COMPLETE','{}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3c3-2d56-207b-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3c3-2d56-207b-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3c3-2d56-207b-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"storage_size\": \"50 GB\", \"admin_email\": \"ma.tangaro@gmail.com\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.LjniGuuv4CJAsUBvVNjrcRqV\", \"version\": \"release_18.09\", \"instance_flavor\": \"small\", \"flavor\": \"galaxy-no-tools\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/8c301d81-d2ab-45b0-81d6-c3569516aa42\", \"instance_description\": \"ELIXIR-ITALY\", \"storage_encryption\": \"True\", \"additional_description\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'8c301d81-d2ab-45b0-81d6-c3569516aa42','secret',''),('11e9a3c9-3469-49ff-a6d8-024283ff312a','2019-07-11 10:46:00','2019-07-11 10:54:15','3bf4a4e6-a3c9-11e9-8af8-fa163e0663d5','','DELETE_COMPLETE','{}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3c9-3469-49ff-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3c9-3469-49ff-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3c9-3469-49ff-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"vault_wrapping_token\": \"s.FNJeBVSFiqZOe6UR7wIYpu3z\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/75ed4e6d-a0b1-4ecb-aecd-2e68aff7e2a5\", \"flavor\": \"galaxy-no-tools\", \"admin_email\": \"ma.tangaro@gmail.com\", \"storage_size\": \"50 GB\", \"instance_flavor\": \"small\", \"storage_encryption\": \"True\", \"instance_description\": \"ELIXIR-ITALY\", \"version\": \"release_18.09\", \"additional_description\": \"\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'75ed4e6d-a0b1-4ecb-aecd-2e68aff7e2a5','secret',''),('11e9a3c9-ba7c-67fe-a6d8-024283ff312a','2019-07-11 10:50:00','2019-07-12 21:59:25','c2dc0f44-a3c9-11e9-8255-fa163e0663d5','','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.81/galaxy\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3c9-ba7c-67fe-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3c9-ba7c-67fe-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3c9-ba7c-67fe-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.81/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"admin_email\": \"ma.tangaro@gmail.com\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"instance_flavor\": \"small\", \"storage_size\": \"50 GB\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/7ac689ae-3a7e-4aed-9f1f-2586d4dc9f52\", \"vault_secret_key\": \"marco\", \"version\": \"release_18.09\", \"flavor\": \"galaxy-no-tools\", \"vault_wrapping_token\": \"s.ZtWUawjr1CcaC1oOvqal9OoB\", \"additional_description\": \"\", \"instance_description\": \"ELIXIR-ITALY\", \"storage_encryption\": \"True\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'7ac689ae-3a7e-4aed-9f1f-2586d4dc9f52','marco',''),('11e9a3e0-8fad-6cca-a6d8-024283ff312a','2019-07-11 13:34:00','2019-07-11 13:43:30','99603ea8-a3e0-11e9-b04e-fa163e0663d5','','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3e0-8fad-6cca-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3e0-8fad-6cca-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3e0-8fad-6cca-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"additional_description\": \"\", \"num_cpus\": \"2\", \"mem_size\": \"3 GB\", \"num_instances\": \"1\", \"os_distribution\": \"ubuntu\", \"zabbix_server\": \"\", \"zabbix_metadata\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9a3e1-3f60-374b-a6d8-024283ff312a','2019-07-11 13:39:00','2019-07-11 13:51:00','','','DELETE_IN_PROGRESS','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3e1-3f60-374b-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3e1-3f60-374b-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3e1-3f60-374b-a6d8-024283ff312a/template\"}]','9c3c7f53-7279-4008-82be-60600418c884','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"num_instances\": \"1\", \"additional_description\": \"\", \"zabbix_metadata\": \"\", \"zabbix_server\": \"\", \"num_cpus\": \"2\", \"os_distribution\": \"ubuntu\", \"mem_size\": \"3 GB\"}','{\"keepLastAttempt\": \"false\", \"maxProvidersRetry\": 1}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9a3e1-547a-9746-a6d8-024283ff312a','2019-07-11 13:39:00','2019-07-11 13:51:06','','','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3e1-547a-9746-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3e1-547a-9746-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3e1-547a-9746-a6d8-024283ff312a/template\"}]','9c3c7f53-7279-4008-82be-60600418c884','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine from a VM image (FAST).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string \n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    galaxy_url:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"\", \"instance_flavor\": \"medium\", \"vault_secret_path\": \"9c3c7f53-7279-4008-82be-60600418c884/7f20a880-b30a-448f-8d5f-adac4953a9f2\", \"vault_wrapping_token\": \"s.AMS7t2p6DBs9qqxnTHtdlMmd\", \"instance_description\": \"ELIXIR-ITALY\", \"flavor\": \"galaxy-minimal\", \"admin_email\": \"ma.tangaro@gmail.com\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"storage_encryption\": \"True\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\"}','{\"keepLastAttempt\": \"false\", \"maxProvidersRetry\": 1}',0,1,1,'https://iam.recas.ba.infn.it/',1,'7f20a880-b30a-448f-8d5f-adac4953a9f2','secret',''),('11e9a3e1-f54a-f524-a6d8-024283ff312a','2019-07-11 13:44:00','2019-07-11 13:45:00','feb20984-a3e1-11e9-a8ac-fa163e0663d5','','CREATE_FAILED','{}','DEPLOYER','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3e1-f54a-f524-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3e1-f54a-f524-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3e1-f54a-f524-a6d8-024283ff312a/template\"}]','9c3c7f53-7279-4008-82be-60600418c884','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"num_instances\": \"1\", \"additional_description\": \"\", \"zabbix_metadata\": \"\", \"zabbix_server\": \"\", \"num_cpus\": \"2\", \"os_distribution\": \"ubuntu\", \"mem_size\": \"3 GB\"}','{\"keepLastAttempt\": \"false\", \"maxProvidersRetry\": 1}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','','Retries on cloud providers exhausted'),('11e9a3e2-7fac-fadb-a6d8-024283ff312a','2019-07-11 13:48:00','2019-07-11 13:50:42','','','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3e2-7fac-fadb-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3e2-7fac-fadb-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a3e2-7fac-fadb-a6d8-024283ff312a/template\"}]','9c3c7f53-7279-4008-82be-60600418c884','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine from a VM image (FAST).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string \n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    galaxy_url:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"\", \"instance_flavor\": \"medium\", \"vault_secret_path\": \"9c3c7f53-7279-4008-82be-60600418c884/11c37932-de6d-43ed-b638-379e652ff83c\", \"vault_wrapping_token\": \"s.PWrTsFPxUB7pbZYmtLiAqOlm\", \"instance_description\": \"ELIXIR-ITALY\", \"flavor\": \"galaxy-minimal\", \"admin_email\": \"ma.tangaro@gmail.com\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"storage_encryption\": \"True\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\"}','{\"keepLastAttempt\": \"false\", \"maxProvidersRetry\": 1}',0,1,1,'https://iam.recas.ba.infn.it/',1,'11c37932-de6d-43ed-b638-379e652ff83c','secret',''),('11e9a4aa-f4ca-60d7-a6d8-024283ff312a','2019-07-12 13:42:00','2019-07-12 14:16:16','f93e8904-a4aa-11e9-8af8-fa163e0663d5','','DELETE_COMPLETE','{\"node_creds\": {\"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqAIBAAKCAQEAvqRYpC/qYqm7SsH0hsBZ37NFHJctq0Pj5AOjidCbIP5IDUdc\nW+gDEaVyx2TIIXSPJ408msm8HlM5G2V+PxrLiyTYEa06T0cBzqQg6HO6c+A0OQNV\nP7NnqlJHG1yNTZnlGOnStPvgKSVuxNvVgmvHLU0rPqD+l8e3STtFFxv3l6Lroi63\n3cZocJDz32ziQ48h89tLy7abX1kwx58fXa52fYhZjCAvp7oId4vM+QCQUn9q8c6h\nvc2iDqpBUf13z51NzMRJlSR6bQLq+wxmbxVAzSdMIWSwpoNkJgyBs0e8rvaFUxtA\nbhvniwgZLy7vns4162PWA8Ofh5bhZfkPp9ynmwIDAQABAoIBABlZ63ux7349Se2w\nCx9cNtdblIYvyF/tAEITBc1O00I47kXtxmdmW/odwTyot0BTqrG8w2FmEEEMGhz9\niyNDIewX8y+ulIF0VNYw1ztyIEpGd0tZmR2GcvOgS1plHVlDbMa6WU297Nor4yYE\ngcj9IhhxGZ4TdKekZEg1vINNMciVI9BkYcyyu+ZjTjusXt/5UnTbar+xIlWaHJ2v\nvzi1+qLrsnwCk1X6A/vdYvrrMUbjpctgKAsEUTquKVwELI0B9OOMwo2YLCnOnSyx\np+2qgeilpJCGMaqcfh99xXq5nSSJsEAgOvPNqoHBX9SSDScnNcsp4E9VQcT66TRx\nYQkSrXkCggCBAM3/P+o+0LBFje9ubhGZY7iRGn8ZRfv6jMVq2P003BYs+kd6R1rr\n681JSvEw4lBCWH6j6Bs2ZQQqhUkFL46irATCfhFIc1U99MmvZF8MwAjSgZgD2b1n\naVJLPJJyMkkwx2HYeqJwCQis5OdIu3m4OYzOHmxHaAI5o2dZg4EOh/WXAoIAgQDs\n6uyftL16kNj+TX4552jwW2JBE39HoUwTPpDwTBhHFbUvioQpwcmmX0xRtkDZCzgl\nWWMt3wXLEcf3+L9xHbYoPj+UBrNEcGQUr0zU6LWFb3vAGGjIKNxNfFi0KtCo3Ld4\n9vTF8OVNKDlL/ItSJVB0Sap6Le7WUE95Apn/NUKGnQKCAIEApE7+eidUaeVwyxP4\nM4133xXOXqaYDd7RPf51ybHKAt4pW64LEFixovLdFfj56y6gS5MNZfdDJ8mKuq2q\nO0lBkCJaUArMA6gBgoWlt7MB0Yem2svnd43ukjd0vxLbTUndHwx+9OYMLqFJi7mV\n4Aaz0L3vwkpKicvTrHHX1K70f00CggCAOIn33kUr0swufMHRlc/74yBr2kvk3BtK\nJG2R+UavpIcxrh7IW467qNClTfrIjwN2arNiT9ghcczUhAEA7uXASupQEetnbLXF\nrIoJM+Y1K5rnVXh9yQa3TGaYZKazFRlXT67fyz0p+7fVtKSYOwpcoOPTo0TC8rJH\nxQEx7w2uyqECggCAMaDtKdSIdIpvc3fPAyNQxLWBHTklheRUlL08fb9mSN9ofHQc\nef9rysjkYR0ViM/1Oz4ZrpXQFALE3uX/WDXuBaFEkJnmipaydpH+y8+FMOvDKPHv\nAE/1ZFkaOgaoNZPpBFcw2ikiNFuRBeTJjj25c5XOthYfzxpHn+OpeNYY3Ow=\n-----END RSA PRIVATE KEY-----\n\", \"user\": \"cloudadm\", \"token_type\": \"private_key\"}, \"endpoint\": \"90.147.75.68\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a4aa-f4ca-60d7-a6d8-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a4aa-f4ca-60d7-a6d8-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a4aa-f4ca-60d7-a6d8-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','90.147.75.68','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"zabbix_server\": \"\", \"os_distribution\": \"ubuntu\", \"mem_size\": \"3 GB\", \"additional_description\": \"\", \"num_instances\": \"1\", \"num_cpus\": \"2\", \"zabbix_metadata\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9a4b0-1770-fa51-a6d8-024283ff312a','2019-07-12 14:19:00','2019-07-14 21:12:14','2185ffdc-a4b0-11e9-a8ac-fa163e0663d5','','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a4b0-1770-fa51-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a4b0-1770-fa51-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a4b0-1770-fa51-a6d8-024283ff312a/template\"}]','4d5b241a-a9cc-4fb1-8443-5385844363d8','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"additional_description\": \"\", \"num_cpus\": \"2\", \"mem_size\": \"3 GB\", \"num_instances\": \"1\", \"os_distribution\": \"ubuntu\", \"zabbix_server\": \"\", \"zabbix_metadata\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9a4ef-de8b-714e-a6d8-024283ff312a','2019-07-12 21:56:00','2019-07-12 21:56:00','','express test vault','CREATE_FAILED','{}','DEPLOYER','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a4ef-de8b-714e-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a4ef-de8b-714e-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a4ef-de8b-714e-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n  #- indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine from a VM image (FAST).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string \n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    galaxy_url:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"express test vault\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-CoVaCS\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.kRu5iW1dmO4KfhcTo1wCHLLD\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/b4958211-5eb9-4303-a286-3bf6a116081b\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'b4958211-5eb9-4303-a286-3bf6a116081b','secret','Retries on cloud providers exhausted'),('11e9a4f0-98e8-f185-a6d8-024283ff312a','2019-07-12 22:01:00','2019-07-12 22:01:00','','','CREATE_FAILED','{}','DEPLOYER','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a4f0-98e8-f185-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a4f0-98e8-f185-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a4f0-98e8-f185-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n  #- indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine from a VM image (FAST).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string \n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    galaxy_url:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.NQ6G1a2fLAQg2WkZQPu9JJy8\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/10ab0b6e-6346-4bc6-81e2-45b206cb2e57\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'10ab0b6e-6346-4bc6-81e2-45b206cb2e57','secret','Retries on cloud providers exhausted'),('11e9a54d-d4a8-8727-a6d8-024283ff312a','2019-07-13 09:08:00','2019-07-13 09:21:23','e0127334-a54d-11e9-98a0-fa163e0663d5','','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a54d-d4a8-8727-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a54d-d4a8-8727-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a54d-d4a8-8727-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"instance_flavor\": \"medium\", \"instance_description\": \"ELIXIR-ITALY\", \"version\": \"release_18.09\", \"additional_description\": \"\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"flavor\": \"galaxy-no-tools\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/7fa385a3-25c6-4c14-a931-3d7d9401d11e\", \"storage_encryption\": \"True\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"admin_email\": \"ma.tangaro@gmail.com\", \"vault_wrapping_token\": \"s.5jLYIKhs47nBnvIaaQTEOdEI\", \"storage_size\": \"50 GB\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'7fa385a3-25c6-4c14-a931-3d7d9401d11e','secret',''),('11e9a54d-fc69-60c9-a6d8-024283ff312a','2019-07-13 09:09:00','2019-07-13 09:21:23','03b4cd78-a54e-11e9-b39a-fa163e0663d5','','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a54d-fc69-60c9-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a54d-fc69-60c9-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a54d-fc69-60c9-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"admin_email\": \"ma.tangaro@gmail.com\", \"vault_wrapping_token\": \"s.o80rBrQDxN2I4U0rpqzlwVba\", \"instance_flavor\": \"medium\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/3d22caf6-23f2-4269-9e81-bc8d11d92f39\", \"storage_encryption\": \"True\", \"version\": \"release_18.09\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"additional_description\": \"\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"instance_description\": \"ELIXIR-ITALY\", \"flavor\": \"galaxy-no-tools\", \"storage_size\": \"50 GB\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'3d22caf6-23f2-4269-9e81-bc8d11d92f39','secret',''),('11e9a54e-1a16-6cba-a6d8-024283ff312a','2019-07-13 09:10:00','2019-07-13 09:21:23','241f4f2a-a54e-11e9-8255-fa163e0663d5','','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a54e-1a16-6cba-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a54e-1a16-6cba-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a54e-1a16-6cba-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"vault_secret_key\": \"secret\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/9d64fd46-2f5b-4864-ac66-ae28d5c9c359\", \"additional_description\": \"\", \"vault_wrapping_token\": \"s.zzRgRIN6Xgs0fy3QpLunjPo4\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"version\": \"release_18.09\", \"storage_encryption\": \"True\", \"storage_size\": \"50 GB\", \"instance_flavor\": \"medium\", \"admin_email\": \"ma.tangaro@gmail.com\", \"instance_description\": \"ELIXIR-ITALY\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'9d64fd46-2f5b-4864-ac66-ae28d5c9c359','secret',''),('11e9a54f-2bb2-ac82-a6d8-024283ff312a','2019-07-13 09:18:00','2019-07-13 09:25:00','34167fa6-a54f-11e9-98a0-fa163e0663d5','','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a54f-2bb2-ac82-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a54f-2bb2-ac82-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a54f-2bb2-ac82-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/d7041f3e-37fc-43b3-b225-a7aea1c4b716\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"instance_flavor\": \"medium\", \"storage_size\": \"50 GB\", \"storage_encryption\": \"True\", \"vault_secret_key\": \"secret\", \"version\": \"release_18.09\", \"flavor\": \"galaxy-no-tools\", \"instance_description\": \"ELIXIR-ITALY\", \"additional_description\": \"\", \"vault_wrapping_token\": \"s.DZqPgG2FjS77eacF0p3rG4N8\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"admin_email\": \"ma.tangaro@gmail.com\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'d7041f3e-37fc-43b3-b225-a7aea1c4b716','secret',''),('11e9a575-775f-94a6-a6d8-024283ff312a','2019-07-13 13:52:00','2019-07-13 14:13:13','','','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a575-775f-94a6-a6d8-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a575-775f-94a6-a6d8-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a575-775f-94a6-a6d8-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n  #- indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine from a VM image (FAST).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string \n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    galaxy_url:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.TcyAQFnno4CkXkUDgbB2lsh7\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/d79dbf9f-2d67-40d3-a3ab-d5cb984b7447\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'d79dbf9f-2d67-40d3-a3ab-d5cb984b7447','secret',''),('11e9a579-3195-b013-ad4a-024283ff312a','2019-07-13 14:19:00','2019-07-13 14:36:48','','','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a579-3195-b013-ad4a-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a579-3195-b013-ad4a-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a579-3195-b013-ad4a-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n  #- indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine from a VM image (FAST).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string \n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    galaxy_url:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.DfGd4nJeKVD0CWjWBLRN12lg\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/9bce4138-f66f-4b1c-8319-272da5871a63\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'9bce4138-f66f-4b1c-8319-272da5871a63','secret',''),('11e9a57b-bb34-0613-ad4a-024283ff312a','2019-07-13 14:37:00','2019-07-13 14:37:00','','','CREATE_FAILED','{}','DEPLOYER','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a57b-bb34-0613-ad4a-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a57b-bb34-0613-ad4a-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a57b-bb34-0613-ad4a-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n  #- indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine from a VM image (FAST).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string \n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy1:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy1\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.hr410QucHjHKDPZ393oVcuvK\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/6bf0e72d-5c59-4ce5-b95b-b997a777e938\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'6bf0e72d-5c59-4ce5-b95b-b997a777e938','secret','Retries on cloud providers exhausted'),('11e9a57f-249d-50df-85e6-024283ff312a','2019-07-13 15:01:00','2019-07-14 09:31:44','2c03a0b6-a57f-11e9-a8ac-fa163e0663d5','','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.102.84/galaxy\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a57f-249d-50df-85e6-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a57f-249d-50df-85e6-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a57f-249d-50df-85e6-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.102.84/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n  #- indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine from a VM image (FAST).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.dvXFG5yRxu6l9pS3lWxFK31m\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/815bbd29-09a6-4125-a0e2-6beedec682db\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'815bbd29-09a6-4125-a0e2-6beedec682db','secret',''),('11e9a67c-22c1-26fd-85e6-024283ff312a','2019-07-14 21:12:00','2019-07-14 21:13:00','2f48aafc-a67c-11e9-bb42-fa163e0663d5','','CREATE_IN_PROGRESS','{}','DEPLOYER','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a67c-22c1-26fd-85e6-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a67c-22c1-26fd-85e6-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a67c-22c1-26fd-85e6-024283ff312a/template\"}]','4d5b241a-a9cc-4fb1-8443-5385844363d8','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"additional_description\": \"\", \"num_cpus\": \"2\", \"mem_size\": \"3 GB\", \"num_instances\": \"1\", \"os_distribution\": \"ubuntu\", \"zabbix_server\": \"\", \"zabbix_metadata\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9a6d4-6d0a-74ac-85e6-024283ff312a','2019-07-15 07:44:00','2019-07-15 07:45:00','732d8cbc-a6d4-11e9-9be1-fa163e0663d5','','CREATE_IN_PROGRESS','{}','DEPLOYER','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a6d4-6d0a-74ac-85e6-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a6d4-6d0a-74ac-85e6-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a6d4-6d0a-74ac-85e6-024283ff312a/template\"}]','4d5b241a-a9cc-4fb1-8443-5385844363d8','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"additional_description\": \"\", \"num_cpus\": \"2\", \"mem_size\": \"3 GB\", \"num_instances\": \"1\", \"os_distribution\": \"ubuntu\", \"zabbix_server\": \"\", \"zabbix_metadata\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9a89d-2166-fc6f-85e6-024283ff312a','2019-07-17 14:14:00','2019-07-17 14:14:00','','','CREATE_IN_PROGRESS','{}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a89d-2166-fc6f-85e6-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a89d-2166-fc6f-85e6-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a89d-2166-fc6f-85e6-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"num_instances\": \"1\", \"zabbix_metadata\": \"\", \"os_distribution\": \"ubuntu\", \"mem_size\": \"3 GB\", \"zabbix_server\": \"\", \"additional_description\": \"\", \"num_cpus\": \"2\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',NULL),('11e9a89d-2b22-49f7-85e6-024283ff312a','2019-07-17 14:14:00','2019-07-18 08:56:14','348199b6-a89d-11e9-bb42-fa163e0663d5','','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a89d-2b22-49f7-85e6-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a89d-2b22-49f7-85e6-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a89d-2b22-49f7-85e6-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"num_instances\": \"1\", \"zabbix_metadata\": \"\", \"os_distribution\": \"ubuntu\", \"mem_size\": \"3 GB\", \"zabbix_server\": \"\", \"additional_description\": \"\", \"num_cpus\": \"2\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9a89e-c373-b4f3-85e6-024283ff312a','2019-07-17 14:25:00','2019-07-18 09:01:52','c9bb3202-a89e-11e9-a8ac-fa163e0663d5','','DELETE_COMPLETE','{\"node_creds\": {\"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEpwIBAAKCAQEAuFhB8Oak9Q7RrT7jDd+9YqMiKhZMnlwq0YsVmm3a3bPw8XCi\nMBQc9oagXh3zhTpFPMLHvVbX0zYlNNFggVZweRJW5prjRUxNVg95vODQdaupz7J3\np+DqL94MJ1Z9aoT7onromG+YxD7zSmPT4kD+uCW/pB8ahSS8OohQPdIOIQ33UO8N\ndFoUehVL94aEk5gxCzRMXna8+PZRkKjWrHWNj4UqOE7VYdYdO5Zi6fDmVZ+zPyhG\nHWTCbU0xEkOOi1oCRFa97w3bfyrs/pvPBZAavSZYtzE7zyqIM8iDn1aKVjks2PKy\n/lmljK60Yo+iO3o1kChcYQgEV7jpUG+KA+yt4QIDAQABAoIBAFK4R96xoJPWcoAr\nF/fBzlnUmiAIoZjuAsjEgI0rfmq9tACjaiPo4pY9Evkot32xCCCbxsVPkslUIp3w\n1j0zbITnldck6ZbPBmT3zMjUmLY0sZ5hlw/d/Tg9i3abeOuzgLcIMBc2/HYTSVi4\nMvvz7ljzl2suCdh1A4HAaUFUYMKznq6tg6xMadYHpPwlkJBxZ4R3EPkfv5sKQlpl\n+hx70+s0TonwgUto4yXDlZ04rTdl5+TX2JaPlucY4oAHjpVfbbvLBkTvA6yGTgDc\njTcpqcIDkBYZSnR19A5EidV7IZzMOKAxdFGZUeSgGjX7quqbJJpbCE+kUNrseIwc\nfsgUigECggCBANdreCQtP734tphAqY3o+Zp0qA9vnfY2kAweZiCOI7nVhSCpNYby\nfTDwEfG597CVA2eLgdVPzbeTtDgfgekuoYtzSP0/F5hKuZGLGmOwkOe/aX2BZOBZ\nKOuxNlHkJI82p9vyKo0XZKxGULh9xmOHaUFuff4nKNyRXNjBZWkvA3+dAoIAgQDb\nEjUCrk9Z06wvpGLXjekI4ypGirJl3VWUhJLCWpO0MAoevr3W93nyBGzN8SwYpE8j\nxgmhtHK2P2oXGEZkwxwpsjI6AI9lyRvixU+2X2IUzfzEs6CeMk/QSUBdhI20t4sA\nSdzcnQTSSzmAk4icPwRJL1F7qS/vO6iADH0UiPkuFQKCAIBNLAzwON2a+ty/Ensr\ngYjZ0mzaisv2Bnn4PXOsuf8Gdf2pQ7UPUROUUoy7IjofomKD17B9cIdr+pgXewIZ\nPUFWKci+ILodLrfn8gNUL07aFvJ9qbsvvAEy3lttXuPSAmyEGO8xeG3yYYZNcZF+\n2mXUsPal8/VpfxHZ/P6NffAs6QKCAIAGP12tpuTybdvyO+Dpvs1PiJLzEg+GYiqH\nosRAsK6Xq+sN92iYkdQzd7bWpLMaPM1Y+tPZfbjrw6E16WZQh1PtSHywNMXiJDsc\nW34reErmxv0XavwApvSpvv0L7bTQ248mQfT/gabajHSmWw7BTfbEU4oiWa/ZRb1H\ncZO7mzBoBQKCAIACZIVjjXUIs0zOT0NulkBWE+lbDrgQTYhhZzpU9mGb1OWXdzFt\nMQGJhlugwsLLR8njGPBLCSpFZTwKSGXNtldoMTVOUEgdi/Y3CMA5LUg7uh3JP4nt\nonBIaHhMdAKOMvZEUSBxvOAeoQ976SODejvVZil168ACj895CPRcbtpHeA==\n-----END RSA PRIVATE KEY-----\n\", \"user\": \"cloudadm\"}, \"endpoint\": \"90.147.102.223\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a89e-c373-b4f3-85e6-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a89e-c373-b4f3-85e6-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a89e-c373-b4f3-85e6-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"os_distribution\": \"ubuntu\", \"num_instances\": \"1\", \"zabbix_metadata\": \"\", \"additional_description\": \"\", \"zabbix_server\": \"\", \"mem_size\": \"3 GB\", \"num_cpus\": \"2\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9a93a-3db2-18b6-85e6-024283ff312a','2019-07-18 08:58:00','2019-07-18 09:19:49','419fd37c-a93a-11e9-b41f-fa163e0663d5','','DELETE_COMPLETE','{\"node_creds\": {\"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqQIBAAKCAQEArMZ01oCB6GtYreNvs6tTqHDbiyaYorbScto1LK+EOUhJDqnw\nIlbh+N6kXWoQgxc2Loho+GVQKdGgPWvmZJbWvd6SdAZlUJ3dQHnt+J7jHiMp1ev+\nMag7Z21AbDM+Coe+O1jCqOG24mOungAqImmb23jd+xWDCBmR0iWZTduPeJNeoTAp\n2f2gMvxX5xHdlA4QTb14YCh4+0YblqnDHo0yJJMCji58kIsW6WnMvqc4aTdEXce+\nFTyTyxl52I/OL8xcikshzt1Cqsas1WKdFk9RRfc9xtztigPcg0+mWFhDy5Ok7A7S\njB8KlkQPRZaBuKaxpPm61ES6i7lgZuYkQa97QwIDAQABAoIBAHuQOwMlSMMF8pf5\n7msafmwauoicA9Fq2rtVH25j4DZvYgBgvOJyLI4l/HrqXgDC2vcQi7IKEvi1eNo0\njsMltVJ5GVhtMowjOpbgHLcQOvHUyBi7/EFbRZDEa6x2QUqapgwfgKfzNS5XiAxr\npbaSvOqLWIY3bkyerNEUHr215redzYlG5+aeW6A1REPlwU3BTbaf99voBMbaDL8z\n8KT3Kyg2CZairvovHxHjKAsMHucvwgCPf89Pilim8pxzaqJOeyOtx3l/KMzrnmRm\n9MpIKUj/FPIQSceUZ53gFge0MeInamH4+BrpzMQ7X/ZHFYZf6yrwE0zPWOlbsakh\nywOn/RECggCBALU6EXtkaGVunyk05NVOgarV2TNn/Dndivn15LdY5AT2iADgbnN7\nev6paPesgywSJRLE0axoz7RpD83vh1zM1UJoQGOkex1AVfVDqAucyX+ME0S9ngJg\nNKU6Ek7gbzyNB/79uJyGM3ZXoQoxDIigNQnmA4la8GyDRuo2r4oaSQkFAoIAgQD0\nD7Gqh4HtAhQqOMd9HZuKKXA+p/iB7rXV4uCCY5k/tcaoQKcACyS74i1egKJtIQnG\noS28H+TL2Z/0Z3RPURDf2nxgjWHyqckKPZ5sBWLjHxkKhNeaE5FIP9BggOkH0kW1\n+0CU17aDSmw/JzlSzhEO7YMkZK4DSc0UiSLiQ9+FpwKCAIEAkEN7ayiQ2j3nQVwz\n1YG7Qw0c7AkZBc9QNI8D1NhUG4dM2LXP9uoTDOo6/v47JTgEfx5icsa0oT8JL7w/\nmyYLleN7blafErgGNUn4WdYjqP8Oz6fKQsXm4qiJrnSG2ELEXL4I2cES8l/reDt3\naMNvtUN/CTZ1MUyHhSanMl6eSSkCggCAcX1WxZCLpzV/QP70LMb2y/FnA4vCMFFb\nduEwOxGrcofJn/Wocom8BC4xoK86WHqzfAz5InDGSNCi49izqiptKVsE2TUFZfzz\nwnJS17JNgIW2dEC/rSMKPMmH0UhAlGWACxaRumTwtu6FlXxc2JeAMSva/rJehKLt\n3W3DremX6CMCggCBAKNJW8Tw7VZrIF7u7OJJ5NaVYOfzLuT9tYv827+TJcoOnpo1\nADz9IYgW3+D/Ywe9nmhf3ThoRXhYEQ8QNnFiZpTri9rDTGJ4tl3vJQ5X6F2KWKLH\nJyKjttGux/cHwBJt1XYDhsnhuU3CYP6MGtuGmnXe+P4dAgV0IF1bgDQjLg5P\n-----END RSA PRIVATE KEY-----\n\", \"user\": \"cloudadm\"}, \"endpoint\": \"90.147.75.194\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a93a-3db2-18b6-85e6-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a93a-3db2-18b6-85e6-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a93a-3db2-18b6-85e6-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','90.147.75.194','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"num_instances\": \"1\", \"additional_description\": \"\", \"zabbix_metadata\": \"\", \"mem_size\": \"3 GB\", \"num_cpus\": \"2\", \"zabbix_server\": \"\", \"os_distribution\": \"ubuntu\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9a93c-bb60-8e72-85e6-024283ff312a','2019-07-18 09:16:00','2019-07-18 10:44:09','c66079d4-a93c-11e9-b04e-fa163e0663d5','','DELETE_COMPLETE','{\"endpoint\": \"90.147.75.208\", \"node_creds\": {\"user\": \"cloudadm\", \"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqQIBAAKCAQEAmYAqMRT9RTGVz/g/zGWYv+SxpZmK2cjCl21WhdM1YLch2TSm\nhiEc683YqVhYQQvvF/7JgKZ+U4Y3QAsIy0Vdq2Ym0xLoLMtwI84QO6j1i8B1BVGi\n/RDdV6zop98reH26cv33rCghq6hhVvss7s4a0ywiXjRMf9TKYZz9vXOR46anLE8O\nDumiEpzvdIAgDkKI1AQkKEuowXXOu/KtQOnK8okL9BHM/orWw3d03ABNsJvJo3Gc\nQAydV3afua1P+2Zd4JTV4+om0pA/tHS/Pj10x6ASmiMJKBASWBnWLffe8W8i1EU+\n0E2dEjc4+vo5k8rY4sqWxzC2i4RifJ/wlkuKrwIDAQABAoIBAFnkJ1Ek9IjP1+a5\nf0sIeCJwH+RVfW26VtJs0k1+eXTQ6f6UCazkuVYR7v6E4PH+th68M26mkbYCFFrp\n21WGoqscIEJdgR+yZ1Jgezsk397ebukVfLhsZuLQPFMKqx9dqZFrzt2/hrBK4+4X\nG6Ihiq3924aFZAM8LuRpFmMayeWhKwMMBpwmwIUGQdUxAkLe71suIhnJ5i+sbCeM\nb0RwbYlpeh+4LcqUKutJOTVfIazWM6hSsYp3rX0J+EjGRGVs1eKibeylePpylU7E\nbWdOcstZGSspZdKyTMOEq/PLDoEClg1J2fVs1NzCTHZLjnfHPVyWb1YFPgSI43fi\nQJMiP/ECggCBALoXIpN//QIJcCZziT/ZdJesqUC5s3vyNy2JiBNTEg9AaE//ApKT\nROwgfmWriRUgGFNeYWJHElhVop0wLhFBgeQe8XxhIivIc9IJWHLnPUZD/s1YD39x\ncB0roh9LX0H9pPFRXJ3naPFweqC+wURHgaJoXLJrbIOXif+9BKWW+nBnAoIAgQDT\nKsdVFweYbS84hZI+km8yAih46FkB4CZbiEk+iIQYIlRCQY15TTypWDRSYBwH4Mqk\n8D98jfiRpO8uv+joiM3ZC53PP4Imz4WdPR5rEKnJgBNNg6RIq6a+uaKgyIWWXkYs\nk3+YnCqAArqJ6rKiCyb+P6bdGtO4eWX4ocdhdCYGeQKCAIEAglIBXNqdDPgfGk5/\nJ7/Z7v5z6WgjUgHmsnVGXoIme5fXdW5ZFt0bv2FiI0Fl1u2LG5dVC8ZKCqKuJva+\nzEbb+C3TYA+GJrNSqRzyXEWkm7iykIvDDrUaltMfzlqyczx2bqlT+yE8VRk4R6pP\nHsoU9u+vOyQP8ngFpJtyzaRV7rECggCAdMQP6yZL5eZiGSALCRyR7hYxaQIZzaaz\nryOCVNjKKko5S1XSNAQYig+jBvXsKhMMGv5aLLaYf3izZadq08JqCR2aSrJ0dp+D\n47mbK1rQeAKhKdikLCb2kjo2CjA3ZjmFFjsNcEbSXWyk14R2+JGwIyDxVQvzjOtc\nDorupB3EtQkCggCBAKY5hXjehKmADwgwrKEu+1cxHDkSzMJogeXipH1mtTyKpL48\ny63CWQA1qrK0BxtxDqCkXSLNiCMiJmNrXFh181sX0qcAsCfO2qh21QwCoXBvWro7\nLII9PinhtDRQgpkTHe4nYeaAS7XKf9LAPm1HAkCTnJJuhmY6LmbTMlhLxLHY\n-----END RSA PRIVATE KEY-----\n\"}}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a93c-bb60-8e72-85e6-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a93c-bb60-8e72-85e6-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a93c-bb60-8e72-85e6-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','90.147.75.208','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"num_instances\": \"1\", \"additional_description\": \"\", \"zabbix_metadata\": \"\", \"mem_size\": \"3 GB\", \"num_cpus\": \"2\", \"zabbix_server\": \"\", \"os_distribution\": \"ubuntu\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9a948-8142-aa56-85e6-024283ff312a','2019-07-18 10:40:00','2019-07-18 10:59:17','8d4c4e00-a948-11e9-a8ac-fa163e0663d5','prova','DELETE_COMPLETE','{\"endpoint\": \"90.147.75.55\", \"node_creds\": {\"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqAIBAAKCAQEAtHt1/bM8ST1wUWcTA1/0cfjcCf8b27zOQSigBLU14MrKhXgz\nKBACdqIXAnYohOpQDjlkq18zWppNeJCqtERyq3+gx3wT+rkwRomG2lgyCsTN3eLs\n10NJKPd61FyBG1UQj00YHUxc7rxNnswyaQusKsIF9MwSp+rxCZ9uPVpzbktrF5gp\nSkxwhTbP0KcwqsAEUVEKxqOOlhSsgmaPLAZgVyQOBddZnMH6eZKCxSDI+d2xJCB3\neLD1TECVMLOCAxWBl8sQFTnSSGtu+DrWRiGN8pNHJfLivxBivZTjob899WCQRIaV\nDdB8c7CAIB3MBXkMC72n//r7gatx3whsgCH5FQIDAQABAoIBAAdWHW26o3C2tqIY\ndoVkmSMo4ojlfdRo0FmFtTt7wjzpAWJ7iFjQjckUvaqz8uG0RJzPaHAu5n+AVjXY\na5f4UFD4VyjEumsuq++yF3E4tJALf/LNDqORcJ/hr3SCbh0WUB4DHD/UotJxhRY3\nZrUubEkwqd1RjlCVFEc329tSme6ZwL0wx68MswWJPzBRDFMOXlN+EdRCk2jER3zD\nfOBbL/5a41DT+r+QyvYa90BwSjTs8O/R1gX37+5WIkz1nZJud6D+hhxpj49qZ81x\nm8ya0pzIkQtJIxSGj/qdI0gfrH03DnQhzCe5F2hQ6EUJewU56VeuBadfd2mi8FJs\ntxS0QwECggCBANDfmgBBikejhbNUECLn3EdS94GeltIpWxEIJjdE/9cMA48FOVvM\noIAq8438wbQF/cTxJysnm0BW/n3vkACW3Ldb18PIAWDwu4lCs/vnBh20RZlxRaQu\nfCqoMAMGjIDKfC+g/4N1TbM0EaKnO8ZnvUbD+EKSWPQjIDT6qnv5phApAoIAgQDd\nNADEV4U6WTWne8xr7OnBbWYX7G5mxSnSuorBn4YeSU//zGiaTRmMGDzOyS8p+htS\nwbLHVqmDJ2oBboENVYoU20NWA3NBlcS6rCp7N0N9WaxyI/BIyIqPnDSlrJiKuk+n\nDyGQS+YKdWd1Hf//lxwBF2ZTOmbzRnxxa/R5OtLPDQKCAIA80P48GNk0Zq5lOpLA\nNxZyRfv+57guVRBI80B9Uz/S05Ktr+21hu0spFTqALA9xIjRMQ4giJWxtCLBdGFP\nap21Xa6DONb97NoN6zgQnoGvYG/rb4nBdi99FB92og+C6HIkRBJhqmQHS5/e5iaH\nbGk2E5VTfN0dqKSWCG5fTp9FkQKCAIEAsUqP3s5C8uwza8R2qH3fMO/s5vnR1r7p\n8YMf2WZxSW77FouPvzRSaI24lwh6q8tRAPhMwSY9gOgjN3iJKNXJcUP36UWkqAlQ\n/0kkV1OI3Tv1Uhpp6PwKymWpcKwwKuh/FOe0wAGFJBbLT/w2hXVotZs6oTRq9Usm\nTIX5EP1LnzUCggCAf15kQPkPh+6XNu9y7Lcn+j/N4FfLrrEjhk5WlbbJS53z32VS\n9+cR1bab8E4bkiXYokZaBn4oIAumNVMKh+Dpv8Yq6Gyx1VZR4fQZwN/A+KrgHzlu\nR3UNIsIUva1V25O/tqKvv63/GCwe1RPzbJsOUNXv5n+JzAStxcy+yfYTWvo=\n-----END RSA PRIVATE KEY-----\n\", \"user\": \"cloudadm\"}}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a948-8142-aa56-85e6-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a948-8142-aa56-85e6-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a948-8142-aa56-85e6-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"num_instances\": \"1\", \"additional_description\": \"prova\", \"mem_size\": \"3 GB\", \"zabbix_metadata\": \"\", \"num_cpus\": \"2\", \"os_distribution\": \"ubuntu\", \"zabbix_server\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9a948-bc5a-d70a-85e6-024283ff312a','2019-07-18 10:42:00','2019-07-18 10:59:17','c4fd7432-a948-11e9-9be1-fa163e0663d5','oria','DELETE_COMPLETE','{\"endpoint\": \"90.147.75.57\", \"node_creds\": {\"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqAIBAAKCAQEAoCHdnzyWvv5H1dir2gBJ185Hita2NbVXMiQXuo89MTIpTVWz\n27lHSMZ2q8fxZXpGnpOieuDsanfOoO8jGEMcfqLcN7xBU34ksRc6gtMh9PoUA06d\nV32br/hZynYz0NgDql2r5xlYDoB+L5NVYMsvIYeZqrq+gxSZ/Ljn3VdO3Jddz6Of\nkj9EHynESrVp7gxPSkn9za/SGyaK59c0cDrkp4d5t9MSnjEAu2PqE4/NYzL333XY\ncKtNb1W7KpLsbiW54lNTs2LQ7ZlGlZQs10DaY/Kcvi2bH3JdZW8S+BycJ9zyuGlH\nfzRmWNbNGaCvbP/G+1bA2er2BbvW6zIq3zqk7QIDAQABAoIBAQCAtnfzdLoezzli\nlISd+Dlis7YhzTAsv5RVA1nnZRdkodM9DDRD2wuHXa8pqM9KKBz3fefOKVkewypd\nhZqJ9/fBeprUWgeQWwaXKfqoCZlz1keb2Obz2kz4BwH1kUlZByj7GcwBOAflsDa9\newnXgbpikyJbbzuPFVIpJ1+INJN5DxR5h/rFEobNO3uKe0v4GrVCku+tc4qiurFI\nz3x3FZdDLpCQy2XN4TldC6G3vUMW3vNyAcrdh1ikk0xS17jWgDX/ivjwaTAmyl26\nOizuTBxSfrwpxDuL0kSGNXnIv07gNV+sRZP2IFfI+PQ03tQhpHlZ04rcJYdi0N7K\nnTzPq2EpAoIAgQDEBwTDZi5hTVbZMTHnmulDOZXqyqS1PNP9UW1AmfqGUGy8vPEY\nkSMytcj8uMSJd6vRikvFNz8ytScm+ppDbJ11nmezLYvKqYsQ7u2/iNvGnXM0KW5c\neX/gpleGWEWXvTaSjgBZQDKDfOzAQLMnWiakCpLdma+5wtGVZpdvI1rBnwKCAIEA\n0R+FDbJ9My5XfNK+E389iSDsl21voXMoyeOo/wfq3XJ5pk7FcoRf1KixPUBcs+qV\nvyz86hXUJmkQW1Z4QiTqZrtKKmLb7hf+rOfMxjKkC+FY6phrSCxKQIXGymZkjaq/\nkaihSGKyFJPF6FoOHaw6P4iZBY1h31UPW11Mhh37RfMCggCAWUf9EmYCr8yCxs9S\nNHNo1HZw4oxDMkyvHMwuX2MCKJSOwfOoN5E7H8iN7xTUZuv7dKdxVTSRcy3w1B8F\njbn1iXGJN6GB7t8DeMXpwPe7aZ2ir9pC6pln9dCtQoIHyFGkfmFwpTXJC/wk9HdD\nYaP8v3AVbhqmX4vs2wfr5vGKT28CggCAd1I2xvP7AAMHJE/S6KkHYYEJvfVRZpug\nwGFIAgxwdF5nDv+PJaJmU57VUo+w1W+adfSjcqV14Vy9WoBiKcuKe4eN79Vsi9Ph\nGqNAci5e7/BqnaDOReYPj/VE0iPOaA7vM5s2O2klFxyiJcuMll249ptoRITBPX75\nPjZj/XqJ7wUCggCAQuohiJeIksjUUTMVQauvl6BhGyW2Ed/rkgoNn5TUbnS6XFNT\natKX7OjTmu93BdurXBD2ezOlnN4BC7wLbko7GxCigx0PwqzkA14UPCXxP8WtKu8T\nUNOHDx7PT9dQXLqO1iA8S6sHu2c96fVyMJLJ0p4zR/wSipD3i/tHSeUO/7Q=\n-----END RSA PRIVATE KEY-----\n\", \"user\": \"cloudadm\"}}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a948-bc5a-d70a-85e6-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a948-bc5a-d70a-85e6-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a948-bc5a-d70a-85e6-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"mem_size\": \"3 GB\", \"zabbix_server\": \"\", \"num_instances\": \"1\", \"os_distribution\": \"ubuntu\", \"zabbix_metadata\": \"\", \"additional_description\": \"oria\", \"num_cpus\": \"2\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9a960-ac13-2093-85e6-024283ff312a','2019-07-18 13:33:00','2019-07-22 12:35:50','b5c74a3e-a960-11e9-b39a-fa163e0663d5','encrypted test 2','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.99/galaxy\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a960-ac13-2093-85e6-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a960-ac13-2093-85e6-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9a960-ac13-2093-85e6-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.99/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"encrypted test 2\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.3bPjvKkYhHNBS4SVmc3WnMpH\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/65eda97d-3d49-4e90-a192-c1c96e26a59c\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'65eda97d-3d49-4e90-a192-c1c96e26a59c','secret',''),('11e9aa78-39a3-94e5-85e6-024283ff312a','2019-07-19 22:54:00','2019-07-19 23:25:00','401db6ec-aa78-11e9-a8ac-fa163e0663d5','api1','CREATE_FAILED','{}','DEPLOYER','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aa78-39a3-94e5-85e6-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aa78-39a3-94e5-85e6-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aa78-39a3-94e5-85e6-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"api1\", \"instance_flavor\": \"small\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"version\": \"release_18.09\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.O2e6hCUprxTeQzTJBNYEAKWo\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/30a85738-5d04-41d4-81d7-a0503fd6a6f5\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'30a85738-5d04-41d4-81d7-a0503fd6a6f5','secret','Retries on cloud providers exhausted'),('11e9aab6-8a93-26b4-85e6-024283ff312a','2019-07-20 06:20:00','2019-07-20 07:08:44','933563b4-aab6-11e9-a8ac-fa163e0663d5','api2','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.81/galaxy\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aab6-8a93-26b4-85e6-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aab6-8a93-26b4-85e6-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aab6-8a93-26b4-85e6-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.81/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n    iam_client_id:\n      type: string\n      description:\n      default: iam_client_id_for_luks_client\n      required: false\n    iam_client_secret:\n      type: string\n      description:\n      default: iam_secret_for_luks_client\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        iam_client_id: { get_input: iam_client_id }\n        iam_client_secret: { get_input: iam_client_id }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"api2\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"version\": \"release_18.09\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.LGlegl8WXHjLnnvntat9wYN1\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/bb42cb3c-a2e1-4008-a083-d1e888784a86\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'bb42cb3c-a2e1-4008-a083-d1e888784a86','secret',''),('11e9aabc-9bdc-4bc5-85e6-024283ff312a','2019-07-20 07:04:00','2019-07-20 07:19:37','a1a642a0-aabc-11e9-bb42-fa163e0663d5','mail test 1','DELETE_COMPLETE','{\"endpoint\": \"90.147.75.90\", \"node_creds\": {\"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqAIBAAKCAQEAsKlLsNLjAmiWlA2DLNx2F0z9XjI+G4UtTmIMiuX8yOkpJHRz\n5fzlQVlWMSq0y7/wwf9bkOQymUd2UIOYfznNPT3308Svuwcm+HUgjg/PzHv+S/6Y\ndneINZ/mHrE0bGVnhkfWcs4Wah6YZEFLvcw0V7sPfmYvtPWC5ynh1sGDab+3HLlU\n6g5UGyhIz59uN2r5qXLAFg6XMnA9a+XJAITkGlVn2hZw3M30LP9FRpZbadx3ZXQL\nhga+AY7CmrJMEOlkdie2kQSomd1jL9T0urDMouLZK0r7bBA7i5eH0AmakYtkTnvG\npAtgvuUPOHuIEyRUwl25XqsBJEZeDME4frcuqwIDAQABAoIBACSMAYKlPh1jcbNT\nUE3ZlfygCtKP5lVfKc5LbnjVt4QA6GgIR2nO9cadKr2lLh3wqWgY4eKJswYOyKVD\ndCrt1E3VIg4HZKt2gVNpN8Dr+Hs/M46ZLwVjGSSu3bZ/xm6eU9ptximeBPkTN0eW\nUosDUdjMdBocHcZ7/AbCnVwGUJ9xlx5jpN08kP5iFoEWtj555nGjPmj54axEqeXA\n7fcLdfnC0TM6v+2bejHC2B3KodV8Tkd6rIHDE+xZLSRvpR0Grlix0dfOSvZer87Q\n16s3b9aKT1k54zXEJSxCXDr3M5rIaXTASMYCPTdRfRx+ORDT2zumCv5xZrDwQr72\nxhk0ETECggCBALjQwg6m/9awNfNSyNIjMfc55soZEA/s6vz2aOXNQo83Ayr1mYQf\nkF3s12fd1YkEp8ff+VCjrThUJHRGpejTGWIwDhjgV65PCxGnBo316N8zGkd637Eu\nOCWJiX2MEXG8JBVHp5rtXCwn/ZU0ApirSsJpSF7DTwV8EW6Tr5wKUVqtAoIAgQD0\ntITnAVvJrrZF3njkkBW4inpmXmtGirJ9U3wjNczUWudi4cUbaIxAnfDryP+q7hi1\nCfljwVB2/4fPHBsCvhmCREjFzV+fiJwMeVk/1Uzy81luxDjBA9BAS7PtPOsVHwrb\n01Lz0V08MDYhWUOyXBaFZ4XW/cOVzU99QJ8EHc1xtwKCAIEAsexf9mU1xgSsW81m\nAk/ZyY3XrtbEDODkNZYv1JRwMJoglZoOKhGNFa9ujNMWwStXL2hjiAubNrBizAI7\ntVKNjGaBG9fW8butB1iKSd7lSwPSl+AmPFgnu5OWZuSS4rDi+A2cwN0kMGpridmh\nakL13QYoovpaOAiCa7cIiCuyuJ0CggCAeMVzZnOUMpjo2tju/5dhMQAfYtCsz1b6\nusHuXY5a9l+bHYFh/6H8vpN06Vn9XQY/6XHvxN0O8nwxMfWkGxlpi5JZ/E3dKOaK\nZdmqQ8fpP2r9M57ih9hy+piiR68uMvFsMYw9v5oQEvmUbacZszih4Nt0AeSimBeJ\naL7w/F4dHEcCggCAD9SKp7ImkxHjpcyZpTQG01JnS1r8cwiuV+gxIAeW6Bmo9wHB\nJWwu/LyEO8SOgw3jsFiuzA3WMJJe3NZnlQxue/gCwTAUQd30E309AwNVqRMOBDTs\nNvtiQvbTpNC65p9fLCI0NKWGdbx4Y7QObMVsRlY1sDQ6clijrC+EoYXPZEY=\n-----END RSA PRIVATE KEY-----\n\", \"user\": \"cloudadm\"}}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aabc-9bdc-4bc5-85e6-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aabc-9bdc-4bc5-85e6-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aabc-9bdc-4bc5-85e6-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','90.147.75.90','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"additional_description\": \"mail test 1\", \"num_cpus\": \"2\", \"mem_size\": \"3 GB\", \"num_instances\": \"1\", \"os_distribution\": \"ubuntu\", \"zabbix_server\": \"\", \"zabbix_metadata\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9aadb-cc9e-80b5-bd44-024283ff312a','2019-07-20 10:47:00','2019-07-20 10:57:46','d58bedee-aadb-11e9-bb42-fa163e0663d5','api3','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aadb-cc9e-80b5-bd44-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aadb-cc9e-80b5-bd44-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aadb-cc9e-80b5-bd44-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"api3\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"version\": \"release_18.09\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.WOkmm4ihfFlfXaJXdUzkUpqi\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/a723a931-7cbf-4725-acbf-9f91df1e9a54\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'a723a931-7cbf-4725-acbf-9f91df1e9a54','secret',''),('11e9aadc-cb49-81ea-bb40-024283ff312a','2019-07-20 10:54:00','2019-07-20 10:59:00','d9d18a34-aadc-11e9-b41f-fa163e0663d5','docker2','CREATE_FAILED','{}','DEPLOYER','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aadc-cb49-81ea-bb40-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aadc-cb49-81ea-bb40-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aadc-cb49-81ea-bb40-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  TOSCA test for launching a Galaxy Server also configuring the bowtie2\n  tool using Galaxy Tool Shed.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: m1.medium\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: ma.tangaro@gmail.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: GALAXY_ADMIN_API_KEY\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: release_18.05\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: \'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDrm8mxOuqwP5XTHf685V9rqRXXg41F4isJvRr4h3MPDs8PgqZBzzjxEFyGpJ/Rgg4ACesGBZy+CbVVGtOveltKvgkpzyHIrh+vMay9z82eK2LMZEfmEPgw1BHdRifPZ1Qb7Zmj1nRk1EMWoNvbBxEc3/MSorWb+2SVMs+42EZ7QxavBmsU7zNU0Nd0e1xiqJ00VDWMnXullp/ieR9M4/XsSlS3oqxsxkAbY3eQYVMsnh64oiRw3lpYBkPyNtC/VSL5Cqig3CMaiK9AW8FjP1GwwqoMjL0H0Mkr0fY8eSSQ9Tcy5AqyaiPn7tmG0fSeNOFwxGkTzrujqlCiOkRSM1Yj marco@MacBook-Pro-di-Marco.local\'\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"bgruening/galaxy-stable\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalDocker\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            #private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base \n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"additional_description\": \"docker2\", \"instance_flavor\": \"m1.medium\", \"storage_size\": \"50 GB\", \"admin_email\": \"ma.tangaro@gmail.com\", \"admin_api_key\": \"GALAXY_ADMIN_API_KEY\", \"user\": \"galaxy\", \"version\": \"release_18.05\", \"instance_description\": \"INDIGO Galaxy test\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDrm8mxOuqwP5XTHf685V9rqRXXg41F4isJvRr4h3MPDs8PgqZBzzjxEFyGpJ/Rgg4ACesGBZy+CbVVGtOveltKvgkpzyHIrh+vMay9z82eK2LMZEfmEPgw1BHdRifPZ1Qb7Zmj1nRk1EMWoNvbBxEc3/MSorWb+2SVMs+42EZ7QxavBmsU7zNU0Nd0e1xiqJ00VDWMnXullp/ieR9M4/XsSlS3oqxsxkAbY3eQYVMsnh64oiRw3lpYBkPyNtC/VSL5Cqig3CMaiK9AW8FjP1GwwqoMjL0H0Mkr0fY8eSSQ9Tcy5AqyaiPn7tmG0fSeNOFwxGkTzrujqlCiOkRSM1Yj marco@MacBook-Pro-di-Marco.local\", \"export_dir\": \"/export\", \"storage_encryption\": \"False\", \"vault_url\": \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\", \"vault_wrapping_token\": \"not_a_wrapping_token\", \"vault_secret_path\": \"subject/depuuid\", \"vault_secret_key\": \"secret\", \"flavor\": \"bgruening/galaxy-stable\", \"reference_data\": \"True\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','','Retries on cloud providers exhausted'),('11e9aadd-bbec-4afd-bb40-024283ff312a','2019-07-20 11:01:00','2019-07-20 11:51:13','c6a21d10-aadd-11e9-9be1-fa163e0663d5','docker3','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.170.35/galaxy\", \"node_ip\": \"90.147.170.35\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aadd-bbec-4afd-bb40-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aadd-bbec-4afd-bb40-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aadd-bbec-4afd-bb40-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.170.35/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  TOSCA test for launching a Galaxy Server also configuring the bowtie2\n  tool using Galaxy Tool Shed.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: ma.tangaro@gmail.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: GALAXY_ADMIN_API_KEY\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: release_18.05\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: \'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDrm8mxOuqwP5XTHf685V9rqRXXg41F4isJvRr4h3MPDs8PgqZBzzjxEFyGpJ/Rgg4ACesGBZy+CbVVGtOveltKvgkpzyHIrh+vMay9z82eK2LMZEfmEPgw1BHdRifPZ1Qb7Zmj1nRk1EMWoNvbBxEc3/MSorWb+2SVMs+42EZ7QxavBmsU7zNU0Nd0e1xiqJ00VDWMnXullp/ieR9M4/XsSlS3oqxsxkAbY3eQYVMsnh64oiRw3lpYBkPyNtC/VSL5Cqig3CMaiK9AW8FjP1GwwqoMjL0H0Mkr0fY8eSSQ9Tcy5AqyaiPn7tmG0fSeNOFwxGkTzrujqlCiOkRSM1Yj marco@MacBook-Pro-di-Marco.local\'\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"bgruening/galaxy-stable\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalDocker\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            #private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base \n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"additional_description\": \"docker3\", \"instance_flavor\": \"small\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"version\": \"release_18.09\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"bgruening/galaxy-stable\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9aae5-ff9c-f5d0-bb40-024283ff312a','2019-07-20 12:00:00','2019-07-20 12:27:58','0d60de96-aae6-11e9-bb42-fa163e0663d5','vault1','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aae5-ff9c-f5d0-bb40-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aae5-ff9c-f5d0-bb40-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aae5-ff9c-f5d0-bb40-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"vault1\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"version\": \"release_18.09\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.wskCXZTMOQlbzXfevoMPutA4\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/c8e7fe23-ce4e-450f-b46f-6bf43121a243\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'c8e7fe23-ce4e-450f-b46f-6bf43121a243','secret',''),('11e9aae9-7e40-84fb-bb40-024283ff312a','2019-07-20 12:25:00','2019-07-20 12:43:59','8c3aa44c-aae9-11e9-b39a-fa163e0663d5','luksctl1','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aae9-7e40-84fb-bb40-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aae9-7e40-84fb-bb40-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aae9-7e40-84fb-bb40-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"luksctl1\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"version\": \"release_18.09\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.hAdeqDFTveMu0lVmlZdQXFxH\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/8384c849-cd35-47a7-8b5b-92f14276a234\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'8384c849-cd35-47a7-8b5b-92f14276a234','secret',''),('11e9aaeb-bdd1-2f5b-bb40-024283ff312a','2019-07-20 12:41:00','2019-07-20 13:54:20','c9ffd354-aaeb-11e9-8255-fa163e0663d5','luksctl2','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.118/galaxy\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aaeb-bdd1-2f5b-bb40-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aaeb-bdd1-2f5b-bb40-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aaeb-bdd1-2f5b-bb40-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.118/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"luksctl2\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"version\": \"release_18.09\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.eJYiW6WkYLW8FpA3YhdB81ra\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/d4981031-238e-4e95-b163-2e48c7fcf45d\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'d4981031-238e-4e95-b163-2e48c7fcf45d','secret',''),('11e9aaf5-9030-d6cc-bb40-024283ff312a','2019-07-20 13:52:00','2019-07-20 14:49:18','97cc3a4e-aaf5-11e9-b41f-fa163e0663d5','api3','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.136/galaxy\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aaf5-9030-d6cc-bb40-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aaf5-9030-d6cc-bb40-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aaf5-9030-d6cc-bb40-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.136/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"api3\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"version\": \"release_18.09\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.BEyFPsSkXCI0FywOWptxqFRY\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/39dae5ac-0c44-4914-ad72-82c29956d19a\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'39dae5ac-0c44-4914-ad72-82c29956d19a','secret',''),('11e9aafd-7a55-c62f-bb40-024283ff312a','2019-07-20 14:48:00','2019-07-20 16:28:08','888cf8fe-aafd-11e9-b41f-fa163e0663d5','api4','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.102.31/galaxy\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aafd-7a55-c62f-bb40-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aafd-7a55-c62f-bb40-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aafd-7a55-c62f-bb40-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.102.31/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"api4\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"version\": \"release_18.09\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.gmQI988ieMQz6C7mN9rKGdVb\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/4bf06c0e-2e65-4a6c-9150-e75e7b7ef241\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'4bf06c0e-2e65-4a6c-9150-e75e7b7ef241','secret',''),('11e9ab0b-0bab-0cbd-bb40-024283ff312a','2019-07-20 16:25:00','2019-07-21 15:22:25','16d9cec2-ab0b-11e9-a036-fa163e0663d5','api5','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.203/galaxy\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ab0b-0bab-0cbd-bb40-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ab0b-0bab-0cbd-bb40-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ab0b-0bab-0cbd-bb40-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.203/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"api5\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"version\": \"release_18.09\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.mmBywnFmUaKau5L0so6e1vL2\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/9bbfe9db-3cee-4350-b124-25cf3747aa37\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'9bbfe9db-3cee-4350-b124-25cf3747aa37','secret',''),('11e9abb4-f2da-d064-bb40-024283ff312a','2019-07-21 12:42:00','2019-07-21 14:57:47','ff305b9c-abb4-11e9-a8ac-fa163e0663d5','cvmfs fix reboot','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.102.53/galaxy\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9abb4-f2da-d064-bb40-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9abb4-f2da-d064-bb40-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9abb4-f2da-d064-bb40-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.102.53/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"cvmfs fix reboot\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"version\": \"release_18.09\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9abcb-061a-efe4-bc29-024283ff312a','2019-07-21 15:20:00','2019-07-21 16:10:00','19504558-abcb-11e9-b04e-fa163e0663d5','fixes galaxycloud','CREATE_FAILED','{}','DEPLOYER','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9abcb-061a-efe4-bc29-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9abcb-061a-efe4-bc29-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9abcb-061a-efe4-bc29-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"fixes galaxycloud\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"version\": \"release_18.09\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.PIdGtywpQ693bcHIv0oOYGaN\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/5f33a973-a55a-407f-a095-692b4d50beab\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'5f33a973-a55a-407f-a095-692b4d50beab','secret','Retries on cloud providers exhausted'),('11e9abf2-fef5-885c-bc29-024283ff312a','2019-07-21 20:06:00','2019-07-21 20:30:35','0ccef0b8-abf3-11e9-a8ac-fa163e0663d5','fixes2','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9abf2-fef5-885c-bc29-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9abf2-fef5-885c-bc29-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9abf2-fef5-885c-bc29-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_io:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ] ] }\n','{\"additional_description\": \"fixes2\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"version\": \"release_18.09\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.QkI7ggCK0wZSqeXTdKt9wgYz\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/26715c7d-36e6-4372-bcd9-63a908ccfa54\"}','{\"keepLastAttempt\": \"true\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'26715c7d-36e6-4372-bcd9-63a908ccfa54','secret',''),('11e9abf6-1621-0cea-bc29-024283ff312a','2019-07-21 20:28:00','2019-07-21 22:26:40','218fbf48-abf6-11e9-9be1-fa163e0663d5','fixes3','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.102.31/galaxy\", \"node_io\": \"http://90.147.102.31\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9abf6-1621-0cea-bc29-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9abf6-1621-0cea-bc29-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9abf6-1621-0cea-bc29-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.102.31/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_io:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ] ] }\n','{\"additional_description\": \"fixes3\", \"instance_flavor\": \"small\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"version\": \"release_18.09\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.1kqOMp2jHkTF1LM1D4SplllJ\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/47f59732-6109-41be-b267-cdaba5aff4bb\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'47f59732-6109-41be-b267-cdaba5aff4bb','secret',''),('11e9ac06-106a-1667-bc29-024283ff312a','2019-07-21 22:22:00','2019-07-22 10:42:07','1a4c1a00-ac06-11e9-98a0-fa163e0663d5','fixes3','DELETE_COMPLETE','{\"node_io\": \"http://90.147.75.129\", \"endpoint\": \"http://90.147.75.129/galaxy\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac06-106a-1667-bc29-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac06-106a-1667-bc29-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac06-106a-1667-bc29-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.129/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_io:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ] ] }\n','{\"additional_description\": \"fixes3\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"version\": \"release_18.09\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.zdZi5inRi0ouMx5zqXYmAqDk\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/2d0b5f1e-a08b-4bf3-b346-29c125913d8c\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'2d0b5f1e-a08b-4bf3-b346-29c125913d8c','secret',''),('11e9ac4a-dbfe-8a41-bc29-024283ff312a','2019-07-22 06:35:00','2019-07-22 06:57:00','ea5897e8-ac4a-11e9-b04e-fa163e0663d5','test mail','DELETE_COMPLETE','{\"endpoint\": \"90.147.75.81\", \"node_creds\": {\"user\": \"cloudadm\", \"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqAIBAAKCAQEApEh0qpqghYlTEcrLA8oyyhag2r4it2An7TzBWSr+xLuilzem\n51Vwo0DisK2RNOLwptXBWGYp2i+vNEK17AxtvQg02XTk9AQbRDvaVSpIpT2WteuU\nRXMrF89izdJpKjs8Xow/ueeF1trpFBreB9Courp2U9o4n3oOzmpoyBQtM5MHUd+x\nwFUIYGq7R+N/0gomoGH8MKX982sD5OA5naHG4qk18ASrZbAzPicyUF5RaaoMUq7N\n6Nr0zRAhN8trcczz0XW3lxTUR4GBBja4bKlMKgRezQRJqnWvC4VxyVXgR5IURlqL\n+kmFvQPP8BEIU7KKMdS9pTEIWd9FHh0AJaX/YQIDAQABAoIBAFxOuf8CUx+1QY/F\nuryuaEtU250NKMSQqt6KPLm1huFT7M+63XUudNPGKZnMbMKioUWc5b6d6PZHxNJA\niafQc/i7G7b0D5FsnUWBu/QOhjMSoBQoAm/jflsqlAHCMIUiM5GMjGIQzQskhcJe\nNlN90tDY5JPJEffJxXgGIkoJzDwlgTVK33CeuUuAAL/AK7IQB0MniM/OSH1t06C1\nGH/dQhNaQEN6E/ZpOESWRnFyoGyCMJCJoob4ZKU8CEe4giKglsFZUebWBdQs81fS\nlMnRiGY0OzVKM1wyoh/Lz3SrvP6KSyUkwzH1dTbL6DxzGMuVkIXYXgIDAZCpPpfh\n71OhWWECggCBALg0/xJiiazXgiCIr8OaJX6E/dR5jwXZVppVYWR4ZINywKC3zU3p\nzRUXRmBGW24uDH/kpS2t8ie8ZF0n0xgAGMeK9wLlwuZ7hyKeIm6o8Cz8/+nYnvXx\n5k1Q4LhBOMeWY4rsWhCz+M83sgX0nXLfo9F8q65xsSqq1Nb53U64+E0PAoIAgQDk\nT5IdlxdtQsSXaWFfNohTNwprSwjI+CptzCrYHT8HlxZw3NK0TAV/YjsCJhcB8FlU\nBC9sZFKrJ+nn9tN+zYG4P0OsvQ42P8BA5Z5n7vLHsaEPuSCUzXxRMbtBHrMGfWiI\nPkAMVG/rU4kT8utJ0ywO43t0koo9wzW0YGvpx8XMjwKCAIAVZ1sICNkUc0oUe61o\nnf2jUNKpoKJEvLc6YZdadD7Bo1DMm+7IEdWZkMXFpAc1qzYamjezMhYEFfjXdiwq\nCsDWVshS1t2pqErQc+1uTET0BUW7J0d5Lm1jKHWkEzgEwO26E7J3ZGIRudf+pyiw\nU1oWmlTchStf2M+4VvonDokTcwKCAIB56zf2zzl2YkJDLMYPpzpTXcAVnaMaVtOp\ngG6cq7l93yPfrzxhhXsmFBm4wwhkQ6ogIIAGnOg8d/sDoR49x5ZvAnGsK+UL+S08\nOqJFlCdXljaRA+YvMDAj16/MTY2CeLO6lat0Kh7+BsTbv0wAR2FurfG+RYbHBpiG\nMztNQx4QZwKCAIEAr13qrBwNJgYBtkuuuKiXfGyFlbd7Ki4/wuvH8wNuFrCSzQDP\n0OVF+YJXzmWN098COwL5M2c8yTKeEsJrdW7q75po+wBZn1CvSEu6BNVK5bzjt+m8\naT3fckiB04DeqKAvhvtLzyFIu+7hMzcDoRXkgbFfjOvImJzW7AafDQi/Y1c=\n-----END RSA PRIVATE KEY-----\n\"}}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac4a-dbfe-8a41-bc29-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac4a-dbfe-8a41-bc29-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac4a-dbfe-8a41-bc29-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','90.147.75.81','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\n\ntopology_template:\n \n  node_templates:\n   \n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            #private_ip: false\n            ports:\n              user_port:\n                protocol: tcp\n                source: 9000\n              other_port:\n                protocol: tcp\n                source: 9001\n              ssh_port:\n                protocol: tcp\n                source: 22\n        scalable:\n          properties:\n            count: 1\n        host:\n          properties:\n            num_cpus: 1\n            mem_size: 2 GB\n        os:\n          properties:\n            type: linux  \n            # The format of the image must be defined\n            # Currently this example uses the IM URI convention\n            # used in disk.0.image.url\n            # see: http://imdocs.readthedocs.org/en/latest/radl.html?highlight=uri#system-features\n            #image: ubuntu-16.04-vmi\n            #image: centos-7-1708-vmi\n            #image: ubuntu-16.04_2nic\n            #image: centos-7_2nic\n            image: centos-7-galaxy-base\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                #location: /export\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: 1 GB\n\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"additional_description\": \"test mail\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9ac4d-84ec-03b7-bc29-024283ff312a','2019-07-22 06:54:00','2019-07-22 07:08:52','8f917714-ac4d-11e9-8af8-fa163e0663d5','node mail test','DELETE_COMPLETE','{\"endpoint\": \"90.147.102.122\", \"node_creds\": {\"user\": \"cloudadm\", \"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqAIBAAKCAQEAoGccY381yFogD3Lt+9ikCwNd/ZM73R9TRR6Ittd8+ZEQr2RM\netCxYbEBI0SkyfndGjjOAe8tPlH4oJmq75dxp6TsfdB75BpyxDHOtVILCyNdpGp1\nIJAILcNEBaSsgUIJ5Xvw4UAWgpFwcxtRX/7tus6jlsV7sOVpjFSemxIEiZKm7lde\nIXv7bsSHKD3df2/lPDL9JJVPWwuAzevI2aC+KwXAlFW6nk1wpvIoQ7eEnmx7h9+c\nWhxX3FJ+ElHVCf9oVbLxSn8DIeFPla3+6WrdCXVN/RZpSs3SQhOV3maA0TuFBPiE\nYPo7Koe9YingvdpPLVU5/xoDPFpapQku9gDRAwIDAQABAoIBAGoY6eEyIov8eRpe\n5eVgvdj/CCuTONShRL4CXWG7lVGqT4QD7saJxdqdbug6HlnuqP4QNst2vdFr/O2V\n10gVPzspTrhFr70IdYMqgtTSiLV8VhNLy1+XhaFneFXXP7dbzBn76i/D6V/B/cRV\nfHTnta2Lww8WXyN6C1+kFSjzOQcZaTjCcOD37p0mJ9HfH2J98gmb+zwTjmTESX0h\noSwMvWveRPoJmq7/cCZQrk56ZRo1v8xIJLCEK7UOkVIF/5X37NemwRp0FLC13UXX\nO4BIfhSsffWTcC0lvISrxZ4gxMgzo/L/F0OK7c2EjoT6aoPWo94EP3cttZJi2b0u\nncznZ9ECggCBALZRUpHQjdIqvY6B4mTRw9qgYQ62KlG9c/rHGgnWdkTujXuJW1oK\n0AH3EMspI3RnrCn8pJM0z93PyyyBozlWdCMSUI/DueQ4aMoedF00/pAya1LEqEzZ\nCql0bMIQbZ1T7d/qtrQZhmyFZCMo2F85EHDNjXGCPBHl4JqKJpVn6fHLAoIAgQDh\nOnZ//ADs9SvzuvfRy6iT4Ux/CNHo8zx1Vcai0LKR/RxkVyyL7mG19/PnSXnl9kHt\ngOh1X3mnJ3xfll4C78QQv2K7GEUg9mONAkS7ah6OqA0N7EULmquv0FM+is5YdIHm\n/jYbc/8xrDe7+JN94R77NQSAUb/cfZjv2ewDbUJWqQKCAIEAq0a6y0Gh+k8sxTQ/\n+3cVB86jX67DEwdoba+eRp+zfA6f2+6uY2jFAROaM0HyjOjYVJmEAscagMc1mBox\nvSv67vfFt0mo2T4lM7xolSez/sNfD+KwOYGtAoTdp3LHh4XRcwqNmaRhJJIsANve\naZayW0bAGmK/DBFpb8VZegKlRQECggCAQ7yPcwJZTOqXY1/xtDjp5D+3/+SpLMQq\nhKddbA4UBm/3H/5PuW3iGRYPVpn0fULIpSNFxjcGoUzwzNauQ3fUoazNhrNP5w/y\n9K+f+DV8Jy9Hbc6HHWxRAjlHL+ITGOtBPjVqFGuYbln7ER87THpuFOLnDaiIaUmk\nu03w+z7a2rECggCAGvdG3H5b7UIb8oja64pnPLW7cTRCIFtZyquvjsrFk/0abLT1\neB7+Rs7/dyROWP7l9v5sViOiYHGKaqDKfWxmLvq1eyy6iQi5pwIlEggkbyXECwCX\nIwd6fjEIODp60d1FPbWy+U2pYeaIKkNz23wfmqcLRLlCO9mpX8Ur3UpVDVs=\n-----END RSA PRIVATE KEY-----\n\"}}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac4d-84ec-03b7-bc29-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac4d-84ec-03b7-bc29-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac4d-84ec-03b7-bc29-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','90.147.102.122','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\n\ntopology_template:\n \n  node_templates:\n   \n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            #private_ip: false\n            ports:\n              user_port:\n                protocol: tcp\n                source: 9000\n              other_port:\n                protocol: tcp\n                source: 9001\n              ssh_port:\n                protocol: tcp\n                source: 22\n        scalable:\n          properties:\n            count: 1\n        host:\n          properties:\n            num_cpus: 1\n            mem_size: 2 GB\n        os:\n          properties:\n            type: linux  \n            # The format of the image must be defined\n            # Currently this example uses the IM URI convention\n            # used in disk.0.image.url\n            # see: http://imdocs.readthedocs.org/en/latest/radl.html?highlight=uri#system-features\n            #image: ubuntu-16.04-vmi\n            #image: centos-7-1708-vmi\n            #image: ubuntu-16.04_2nic\n            #image: centos-7_2nic\n            image: centos-7-galaxy-base\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                #location: /export\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: 1 GB\n\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"additional_description\": \"node mail test\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9ac51-19d1-0d59-bc29-024283ff312a','2019-07-22 07:19:00','2019-07-22 07:46:33','205e6178-ac51-11e9-8255-fa163e0663d5','mail2','DELETE_COMPLETE','{\"node_creds\": {\"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqAIBAAKCAQEAwTro9xvB8LTSImJlp3lKG3c6pjLd9+tWWBHLir+ZZuyWgY4o\nIa8s2yMruoaq89mjnIkkmPHVuK5FAdkvmQSSIsdalgyCU42MV/TpXMmbR4G0QTol\nQutkIvIbXf/Y9pQT5OpNMpDj2yoHrfo6ZBOgA95zJANPTl3yHWlsSVt3f1Mcp3MT\nDVxfktZfeIJNQ7xpZK22ASO4TZZgO251ASNNkAyUIyiBIP/efyeC/ehlxM5S/tlV\nm4agRjBRTQyMAm/AvbZ9PDRI8GJrK+vKvVnog9prnKPS75h9PWl5HGm+4EnPF0Ro\nlY66R2n9NJPd5Bi6GIs5FXxQPoQsEDpvxBiDrwIDAQABAoIBAHegPewF3jpj55fr\n7N0SxONeHAwaf7rlkk3xrl5WoeTLYZ4RYR0BczazfnX6u0k+GwFlEigxx8uO8B/l\n0obcApDPdHBijCioABPQBs0v7xcE4JBlK/5S9mqAEptOMobtQ6e7ulEszDO5wIlf\n2dhtIepjREsuVWHB3YuB4c1EeCV1O+sESRIcDo/ucMd+qhcLL4T1GBOJAy3G58nD\np9t1Rmhfax3MjdcpQoeUWj4fg+vNKpmccOYCZTwLfQtL8aY8jgb21j5srHmr2ii+\n+yf94KPfI4sBcD3O/uksNygNq3ZLzNJHq51y0kgohfRCvl2SNcERy8erfq6nxxPV\ngVgHhkECggCBAMJgfRtnH9SSOSw/Jgpk+C1NDj8mG1jZ7WHf64ZNOciSnJFAnjna\nllJyendmAIukWei60tUN4noSKm8HrcLyRZgzJISiu1AQK+HB4rfWMjQi4nW67yK8\nA7RZwKLalVQ6NtW2gLNvsSbNwY3/3KGv6T6YnyrogK63uQhuxX0fYQ8PAoIAgQD+\nfVkxG8ioBtXX5I5ue+y4UKhvs+zW6b55aN9W0SgK1O5QZazJuMk6X2B3dAfd5EEQ\nnsBHfH1k37P6a1KaFKMMhfiqQfcLk0pbOVsbEvZo77GHqhYwb8EmPst35Sladvva\n3tiuckQSN3IyPMtCCC24UPmfOxbpWRI2XcuPDJFBYQKCAIEAtaEh5lRDiwejwvOz\nIS1eNj51nI6IKUtiJP3vAAzzfLd688OU1myp4Jq2UxGOWu4VUYIZdhpGUVjeK+fZ\n93sZivHnIsVJELQ7vPXGW5AcU1lxkR8/S46yS3k+py5nMVBAYwzpUEKDH8ZOIdk/\nGhrdca99s8OUUy68COQxSAzlTgMCggCASljAV9JwGnZ0vq+s1KYrj+UwcAG2bUq4\nNKvoo2pTMmbmgGJTylLLptv6SKuDKNXoFDzsm3XJBFE+OShlZ1IkGCKDdOn0jFMp\nY+ErtoshpaJw0NtlxBzB5rRtqMcv/5fHGDgGQWBsdo3wNLECCHZvNOujIVuX4+/7\nnBpmv5HCVcECggCAfvdXO1Ng7z8lnlM8ylu5jcs1W52jt7BHDj/zm+fAdjzLDR+N\nYx6AZ698F5h03UtczdtOhkZsqnbxMFRp/Ro1tRiT8q/Gmy60nGPd71Vp3CKZg0X8\nI0ZREVLIwyoafsGY9L5m873STvhRC5WuRq7UaYEMMrxY9fxDh6KM2bzQ28U=\n-----END RSA PRIVATE KEY-----\n\", \"user\": \"cloudadm\"}, \"endpoint\": \"90.147.102.125\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac51-19d1-0d59-bc29-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac51-19d1-0d59-bc29-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac51-19d1-0d59-bc29-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','90.147.102.125','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"num_instances\": \"1\", \"mem_size\": \"3 GB\", \"num_cpus\": \"2\", \"zabbix_metadata\": \"\", \"os_distribution\": \"ubuntu\", \"zabbix_server\": \"\", \"additional_description\": \"mail2\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9ac54-2a00-3e2c-bc29-024283ff312a','2019-07-22 07:41:00','2019-07-22 08:06:21','3370e044-ac54-11e9-b04e-fa163e0663d5','mail3','DELETE_COMPLETE','{\"node_creds\": {\"user\": \"cloudadm\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqAIBAAKCAQEAsSy+dABIJai8vekj2QkFXkwHlaoMoxzjqit8Nop9Et82j+jN\npYWfsmtoNeKAQ9YouPsrfZCqV6q+hKoPNtSK/CsrcvdNNh7zW29vGDluVvg3cVuD\nWELXnesNhWlO2GtVQL385hpSohPY+WMboDtnrg1j/CxQyOrO2QcneVjF//OyZ3pj\nvNer2DHtZHJmfqns3XwQafNnTqewiNbG9yiyrZOAeUyiv+M+rbLVPSYERTwDm+fc\nZUYi/zpN9ckVJaLYqPQmQ/ZPE8zQtKJqVzPdORHO6Fl0K/AQxCcJ23DUohfnD3op\np+jDxCk5TIqB3FxZprU0l2/iE7Td4ZGRDxKokwIDAQABAoIBACFRLK9brjWGuZds\n1BToIV5OJc77H009DYLekokfGc4Gs5f0S1eo/RLsJ7iaU0xuZVIDyXXfUmkR7qm7\n4QiKh2hMJeuEnbxjrZewKNABXMJ2AtcKQnTCfRFxNiW0W+NOq8V09K3AnXFlEhQz\nkupawXB1jCvLmZVusl8VfVLQYstylCxL/ZTQzuMUVBT8EXzhCsRRWdhwlRdtFScd\ntlJDyPMWnyGgnC8TmGPbpLvxZxCqPyJy49yhMUQgWtuAZI1x/qGNPsHniLZoR2sw\nODQJ9ueqIOpEW/5zTG5KLkPYfgGD7lOr9MfyzQLQDiGa0Po7JQ4Yv2eCA4x8U4dN\nody/LgECggCBANOFa8MYPMxfO8cEYl1aNATxL6SDv1KvJFDgR+zNvxtQ0xoaiYVz\ngDWuwzTpPjmAjl02psE6KxkOhNWKhqxXVl8yXl3xbB/ESMOJWf1YJ8c3fWHSVXpZ\nOE2MqBXqN0jA3FD+XNcnwVEfmXLKVkjey3fnNFzxk9nHykCUf+LqLWHBAoIAgQDW\nbmSA4sooQvgpVtYnXhKJq7w3LttPCP4AmXWQIQ9J8if3hecjSZD+tDzN8+Rn7nH+\n3zAw3WUIVYvdCzkaKiSsPZaGHg/9ADo6y+c5JI8Ovlato329G+9KNHNPDMDchLal\nR9LH/eC36AIrrXliA+DUQv9GJvOmSBjP6RZ5qju3UwKCAIAu7LtyZY8fW8U8KonT\n4e4GZqdGHQA1zKsG0irCqwZJfg3HDboShAQeZK3jsBbg1NdAcJ5f4ZKsFV98rCWi\nWCHOLrNmredpyLbHwlHXdVYlyPak2++gm+h0s86aRgKLvlViFnvsM2Kcp6D4KVEp\nC1wiNoWUVPeS6dLBrvAMHB2DQQKCAIAvyHHE9sStrB64t40JQMFIxGgws9RTDGHt\nqES2VWeexsN5OPGEv4P7/hX+nvaq4kusy/dlLDCzZrzACRw0ZGe/qgm84T4W1tIj\nAAUKiscGNgwCrYf7eBoeowl++AySF1DMC/FAd6Z31M+HBCUkXlDfe/5+l3d7+lzt\nF7fWbMTZ2QKCAIEAq7GbR4fV3gJZ0gDxRwSakeCpW21gigCfGZfCoXrnkucbE/pB\nYDAsI3l/9G4wkkJVRs2XOp5mMqbeu+4gAvHXIuie1/nAmScvjI/uGwD6HPTdV7QI\nzLUpMx2TrZQt7EbdSLx6Vg38nD48Wsb7ccRk+rGsOep6xSrFXqo9OFIJsdI=\n-----END RSA PRIVATE KEY-----\n\", \"token_type\": \"private_key\"}, \"endpoint\": \"90.147.102.136\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac54-2a00-3e2c-bc29-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac54-2a00-3e2c-bc29-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac54-2a00-3e2c-bc29-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','90.147.102.136','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"os_distribution\": \"ubuntu\", \"num_cpus\": \"2\", \"zabbix_metadata\": \"\", \"num_instances\": \"1\", \"additional_description\": \"mail3\", \"zabbix_server\": \"\", \"mem_size\": \"3 GB\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9ac57-2234-5d66-bc29-024283ff312a','2019-07-22 08:03:00','2019-07-22 08:18:58','2d46598a-ac57-11e9-a8ac-fa163e0663d5','mail4','DELETE_COMPLETE','{\"endpoint\": \"90.147.102.223\", \"node_creds\": {\"user\": \"cloudadm\", \"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqgIBAAKCAQEA6+U9yvvdzez/ZnvYcvYOZpJnCtVHsDcBKt421OwEH7+aPrHm\nihtIlUGX/NbMy/bAHrG5S8F37YD8mohQvyCTeo0hh+S6bfbFXkbdoRsmGlAxaWvY\nRKQ+IALmjcXSu1p4ttvTOHhSWT00JjYkkfthi3WSGc+pRD7xZpHGNpzwJEfzlowE\njUUFGl7S1W22nJwx6npo/rotkc7zUWxCdwqbM6zfYc0NCNJQSqY6OAD+cCWt7LOT\nzGVH7Nm22ydXlxSzSNb25Gqk9IpcGTafEHdr/XZaEwke4JxeUg2ALvalSbKjoAlh\nIn4PNF4prt02DfQys32HKZIoZssv0NGnFj70NwIDAQABAoIBAFtt0YJwFmrvFZpq\nG92K4s/8pHV9brisyQYNdKEYDQ0lHSp5l0omAv7emoMD2gKf05zR82iaRtpF6SIX\n/Xvmq2KPetSJ4Xwnbh35R4Ne22jNdilPBFaudenAVg3TA7db/HebQgWcFQbDgwfg\nalIuZYNBAWyBoTBzWOsRSwr1ztmwTwNpqww9sgGG+K3KB310zr/mb5CHkNOwsSnr\nVeLoHEe/MR9aXF/QY3StvsJ2RZlSqWsZ+PBgtkQD7k+uigKsJnM/n9humk1e47jK\n+aFkrfyPbscuOCl4TW7Ifx/dHLYZLG53obnwOl8UWlXJ1xuakiz2jiTtHyJXY9iU\n4cM9FxECggCBAPHPm24Vapjfyh2hS1FfVqevnoLKCabBVRFlsvoEAiwRX2+oBf1f\niLtmnkFvySmwVs3GkpZ+ZBLfsNWob791zp/XkXRwOBtvi1vaNyxa+gW3maj53YAe\nuTnzKn+7MhJrPsB8y9hsb0t76KGi7U65LXz9ejvAHm7m7VSPimaa0dUvAoIAgQD5\nvMYiFZoe1cHjEAGl6tFVp3YacTVtF4NbjNdZQfD9cQ9a6yLtkxZUnELgE/dzMemY\ni3FIgXp0CzZr81iWvK4fn4fGFDoWqr9lRkwwvhLOnyRTQ0SFMRZH001o67Kg4sRy\nvM2uwEw4Gia5hREkn4fQJrOYDYjtyACLUu2hvKefeQKCAIEAgqqi3OupvI5Bk51T\nK9eO5fIaf6ZZbMjQBSSlgECmQ9XnclijU/VJ16puHgIf++0UGwIQuE34GdLSpcHt\nENLCItHEAd2aFAlEjw/t/IP00x4RZKQQs2jmwo/KCVfIiPd242EMbhi6U1nTrXRz\nM7URBZebc6ovR9J1sNoX+bXzaXUCggCBAIQr+Xy+jBP3s6a1qPmj3miDuYjjE5CK\nGjZQwwR1VtL7jFHlElZEO1RKY0Zuqs7nwqa+XhUumZ1i9cmKP/9/GnSYHOaje97V\nPXifDOHbJt798N60QkZvpUgcN+Loo2Bsw+WpsP3kvjIO/SHAoEMOv3VVlkVKHIck\nC82w9R1dWCWZAoIAgQCpz+0asMph7XhTWOIfvTOuI65YjH7o0Qxzxh09CmynfKxE\nXVao60JwZyuf/TF/BRRCBni4NAzcjyo6hJm/ARcWnhtbuhj1lg1GnKIUXm9VNeNE\n0bQ3nr9rO6+qy6+nDNAd0lgWrOKbS53SbJaKjP9msximBxCjUr1GieMKdJjZvw==\n-----END RSA PRIVATE KEY-----\n\"}}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac57-2234-5d66-bc29-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac57-2234-5d66-bc29-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac57-2234-5d66-bc29-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','90.147.102.223','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"zabbix_server\": \"\", \"additional_description\": \"mail4\", \"zabbix_metadata\": \"\", \"num_instances\": \"1\", \"os_distribution\": \"ubuntu\", \"num_cpus\": \"2\", \"mem_size\": \"3 GB\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9ac58-e682-ebf9-bc29-024283ff312a','2019-07-22 08:15:00','2019-07-22 08:29:55','ed9e6df2-ac58-11e9-8255-fa163e0663d5','mail5','DELETE_COMPLETE','{\"endpoint\": \"90.147.102.31\", \"node_creds\": {\"user\": \"cloudadm\", \"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqQIBAAKCAQEAyNpDJUgiBTcQBed3EjcKhcZlZlQUrPhW4pxtI9an8/hzHSEm\n9mrR20MadZ1a50A0o3CFtU7ENmy1QJ1nxrKUSQYsy4TbqEgIENdwTf4YslcRAHBf\nf/pWuQ81kFb2+symKf/3inp3ZteCQdEZ0EAMnLSmb81SscvJEerecKyTIpXQCJ8g\ntgMN34oUygoSKSKOdyTHmviI9ZrAJTY3erZ4kpZK5mQtM2jMDMlvvtOgFbr1Wma+\nMdEX2e+hGRxZX7YOw8iSvXN5BgM7QFWGVsmNqSHvnjU+6XSuX9NQtc5UaVt2w9zL\nIa5Ch7vvNYxKAR3epeG+dlwJ3GIxqmgxmtKwgQIDAQABAoIBAG1l9Iyp7V3J0ABn\nQoO5VxHmLfS+d0R/P1POv+N1V6Wa/ZgwJnixVfyHYDIPsyOh5Qngj/NhI55BN7gq\nBAxF2F6t7lgr1Tijg0EpFxJkBC+fHLOQgXPDdtj1X8dulrekIB1gPgQ/ECoD1/7h\nVZ4IRNZVzxG2VARjavFHbEESvlFnMQ7xxfF8cmKxTBpQKBEsrPfHXCfdSLUX+Kzw\nupkNwNHNuL/Sai/GSXDD8AaIU9ao/VZQvYXHe580vCh/icc8iCzVAGxZR+zx/vRB\nbmyfu7r7wmyX+cK8f+XirSSIO9aqQdid4qFLVvxs8ERFX0cuoClqAfnUsMN8OhIN\nE6faDcECggCBAN/slSEUyR/1p9FDt9KThnCItRoP/lUs9Dm5MVz23nhyyDnFDRYN\nWbifqHQ/WzbqsMM9IYIRnbCv8x/Dn9jNZXiQkKJgK2P07LHultUgJFkhPE0phcYP\nrwtWDYZqdIlaG1PuoFB2ZyB2l1JtpFxKCUSBY2QWs0mcZoB5N2JtQbivAoIAgQDl\nn6IeIQl6fAt3a/TT0+IgMcL0sQFtXp6foYnKfrwpNO3GrV2siIIZzTDP0a8SFSVc\nsLvbANbK1LoZn2oC/XFolBXDmnybC9pwQnsWUb0gmlFJH3gA+m4Q8s4HvzTXkypj\nTM3lu9DicQsMMPk62YUAUwIAJ7rOE15G8vJYm/gVzwKCAIBgG0pmSGWKMgU067uZ\nxXeOFR6lcPfX1tN7cuCc5dfWGm2VXd2f+Vrowp2qRwb/Kvty0GnxSV5E1z+iAnQ4\nuO80L9fj2SLGY/iy5ZQXJRR0rK8U7x1bRJ/8XZKwfkBGM0ZHX8OuxSK97ChGWIiS\nk7QmkuH1s0h/74CO43fB5uKuQQKCAIEAjsJdf0/Y3b7LPjbvItdjidKGO6zkj0O5\naNN8oFmE0DWo8tGMIJ1KDZKFm17o8lwVO3hhgroV0ErLXOzAcxVw8azHjzG38IlB\nCHQ8pFazN9bZXJXk/O61iXH7Z9OXncNQIiZ5CDBpoK7ZSH4WJWFhEB+Lad9Jg5+F\nCKU4yKBHb/8CggCBAMBv8PWL2gZWVsZNzuy2d6eUoGfXooHrVFNMnzP55foiuRO/\nYnhGwW/WKmDldpVfgHzkziFRdja/8kd6roDkALtc2fI8KdcKjdbaE6L7ZASwVCqw\ncyZFi2zaiW69q8muxpQBscinGodl4P+CV/cH6Ub0uHbfEuskZXCuYWsnfcIT\n-----END RSA PRIVATE KEY-----\n\"}}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac58-e682-ebf9-bc29-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac58-e682-ebf9-bc29-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac58-e682-ebf9-bc29-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','90.147.102.31','tosca_definitions_version: tosca_simple_yaml_1_0\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/stable/v3.0/custom_types.yaml\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\ntopology_template:\n  inputs:\n    num_cpus:\n      type: integer\n      description: Number of virtual cpus for the VM\n      default: 2\n      constraints:\n      - valid_values: [ 2, 4 ]\n    mem_size:\n      type: scalar-unit.size\n      description: Amount of memory for the VM\n      default: 3 GB\n    num_instances:\n      type: integer\n      description: Number of VMs to be spawned\n      default: 1\n    os_distribution:\n      type: string\n      default: ubuntu\n      description: Operating System distro - valid values ubuntu, centos\n    zabbix_server:\n      type: string\n      description: IP or DNS name of the Zabbix server\n      required: no\n      default: \"\"\n    zabbix_metadata:\n      type: string\n      description: Host metadata to be sent to the Zabbix server\n      required: no\n      default: \"\"\n  node_templates:\n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      properties:\n        zabbix_server: { get_input: zabbix_server }\n        zabbix_server_metadata: { get_input: zabbix_metadata }\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n        scalable:\n          properties:\n            count: { get_input: num_instances }\n        host:\n          properties:\n            #instance_type: m1.small\n            num_cpus: { get_input: num_cpus }\n            mem_size: { get_input: mem_size }\n        os:\n          properties:\n            image: ubuntu-16.04-vmi\n            #distribution: { get_input: os_distribution }\n            #type: linux\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"num_instances\": \"1\", \"num_cpus\": \"2\", \"mem_size\": \"3 GB\", \"os_distribution\": \"ubuntu\", \"additional_description\": \"mail5\", \"zabbix_metadata\": \"\", \"zabbix_server\": \"\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','','');
INSERT INTO `deployments` VALUES ('11e9ac66-c6ab-f2ce-bc29-024283ff312a','2019-07-22 09:55:00','2019-07-22 11:18:14','d62ffa10-ac66-11e9-8af8-fa163e0663d5','docker_stable','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.170.136\", \"node_ip\": \"90.147.170.136\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac66-c6ab-f2ce-bc29-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac66-c6ab-f2ce-bc29-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac66-c6ab-f2ce-bc29-024283ff312a/template\"}]','c0b907df-43a3-4c8a-952a-2b5ca56ec43e','provider-RECAS-BARI','http://90.147.170.136','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  TOSCA test for launching a Galaxy Server also configuring the bowtie2\n  tool using Galaxy Tool Shed.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: ma.tangaro@gmail.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: GALAXY_ADMIN_API_KEY\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: release_18.05\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: \'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDrm8mxOuqwP5XTHf685V9rqRXXg41F4isJvRr4h3MPDs8PgqZBzzjxEFyGpJ/Rgg4ACesGBZy+CbVVGtOveltKvgkpzyHIrh+vMay9z82eK2LMZEfmEPgw1BHdRifPZ1Qb7Zmj1nRk1EMWoNvbBxEc3/MSorWb+2SVMs+42EZ7QxavBmsU7zNU0Nd0e1xiqJ00VDWMnXullp/ieR9M4/XsSlS3oqxsxkAbY3eQYVMsnh64oiRw3lpYBkPyNtC/VSL5Cqig3CMaiK9AW8FjP1GwwqoMjL0H0Mkr0fY8eSSQ9Tcy5AqyaiPn7tmG0fSeNOFwxGkTzrujqlCiOkRSM1Yj marco@MacBook-Pro-di-Marco.local\'\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"bgruening/galaxy-stable\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalDocker\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            #private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base \n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ] ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"instance_description\": \"ELIXIR-ITALY\", \"flavor\": \"bgruening/galaxy-stable\", \"additional_description\": \"docker_stable\", \"admin_email\": \"pietro.mandreoli@gmail.com\", \"storage_size\": \"50 GB\", \"vault_secret_key\": \"secret\", \"refdata_cvmfs_repository_name\": \"elixir-italy.covacs.refdata\", \"version\": \"release_18.05\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDrm8mxOuqwP5XTHf685V9rqRXXg41F4isJvRr4h3MPDs8PgqZBzzjxEFyGpJ/Rgg4ACesGBZy+CbVVGtOveltKvgkpzyHIrh+vMay9z82eK2LMZEfmEPgw1BHdRifPZ1Qb7Zmj1nRk1EMWoNvbBxEc3/MSorWb+2SVMs+42EZ7QxavBmsU7zNU0Nd0e1xiqJ00VDWMnXullp/ieR9M4/XsSlS3oqxsxkAbY3eQYVMsnh64oiRw3lpYBkPyNtC/VSL5Cqig3CMaiK9AW8FjP1GwwqoMjL0H0Mkr0fY8eSSQ9Tcy5AqyaiPn7tmG0fSeNOFwxGkTzrujqlCiOkRSM1Yj marco@MacBook-Pro-di-Marco.local\", \"instance_flavor\": \"small\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9ac6d-201d-13ec-bc29-024283ff312a','2019-07-22 10:40:00','2019-07-22 11:29:20','2a2f5f06-ac6d-11e9-b39a-fa163e0663d5','api5','DELETE_COMPLETE','{\"node_io\": \"http://90.147.170.170\", \"endpoint\": \"http://90.147.170.170/galaxy\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac6d-201d-13ec-bc29-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac6d-201d-13ec-bc29-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac6d-201d-13ec-bc29-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.170.170/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_io:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ] ] }\n','{\"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/17a491ad-0d3a-4924-993a-a7dd14f6827c\", \"additional_description\": \"api5\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_secret_key\": \"secret\", \"version\": \"release_18.09\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"instance_description\": \"ELIXIR-ITALY\", \"storage_encryption\": \"True\", \"flavor\": \"galaxy-no-tools\", \"storage_size\": \"50 GB\", \"admin_email\": \"ma.tangaro@gmail.com\", \"vault_wrapping_token\": \"s.lBSvkYz5lHrcKwkjIHzJ4W00\", \"instance_flavor\": \"medium\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'17a491ad-0d3a-4924-993a-a7dd14f6827c','secret',''),('11e9ac73-00c6-4151-bc29-024283ff312a','2019-07-22 11:22:00','2019-07-29 08:38:56','07d6680e-ac73-11e9-b39a-fa163e0663d5','prova_cvmfs','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.170.224\", \"node_ip\": \"90.147.170.224\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac73-00c6-4151-bc29-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac73-00c6-4151-bc29-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac73-00c6-4151-bc29-024283ff312a/template\"}]','c0b907df-43a3-4c8a-952a-2b5ca56ec43e','provider-RECAS-BARI','http://90.147.170.224','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  TOSCA test for launching a Galaxy Server also configuring the bowtie2\n  tool using Galaxy Tool Shed.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: ma.tangaro@gmail.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: GALAXY_ADMIN_API_KEY\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: release_18.05\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: \'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDrm8mxOuqwP5XTHf685V9rqRXXg41F4isJvRr4h3MPDs8PgqZBzzjxEFyGpJ/Rgg4ACesGBZy+CbVVGtOveltKvgkpzyHIrh+vMay9z82eK2LMZEfmEPgw1BHdRifPZ1Qb7Zmj1nRk1EMWoNvbBxEc3/MSorWb+2SVMs+42EZ7QxavBmsU7zNU0Nd0e1xiqJ00VDWMnXullp/ieR9M4/XsSlS3oqxsxkAbY3eQYVMsnh64oiRw3lpYBkPyNtC/VSL5Cqig3CMaiK9AW8FjP1GwwqoMjL0H0Mkr0fY8eSSQ9Tcy5AqyaiPn7tmG0fSeNOFwxGkTzrujqlCiOkRSM1Yj marco@MacBook-Pro-di-Marco.local\'\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"bgruening/galaxy-stable\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalDocker\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            #private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base \n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ] ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"instance_description\": \"ELIXIR-ITALY\", \"flavor\": \"bgruening/galaxy-stable\", \"additional_description\": \"prova_cvmfs\", \"admin_email\": \"pietro.mandreoli@gmail.com\", \"storage_size\": \"50 GB\", \"vault_secret_key\": \"secret\", \"refdata_cvmfs_repository_name\": \"elixir-italy.covacs.refdata\", \"version\": \"release_18.09\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDrm8mxOuqwP5XTHf685V9rqRXXg41F4isJvRr4h3MPDs8PgqZBzzjxEFyGpJ/Rgg4ACesGBZy+CbVVGtOveltKvgkpzyHIrh+vMay9z82eK2LMZEfmEPgw1BHdRifPZ1Qb7Zmj1nRk1EMWoNvbBxEc3/MSorWb+2SVMs+42EZ7QxavBmsU7zNU0Nd0e1xiqJ00VDWMnXullp/ieR9M4/XsSlS3oqxsxkAbY3eQYVMsnh64oiRw3lpYBkPyNtC/VSL5Cqig3CMaiK9AW8FjP1GwwqoMjL0H0Mkr0fY8eSSQ9Tcy5AqyaiPn7tmG0fSeNOFwxGkTzrujqlCiOkRSM1Yj marco@MacBook-Pro-di-Marco.local\", \"instance_flavor\": \"small\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9ac73-aa28-39cf-bc29-024283ff312a','2019-07-22 11:27:00','2019-07-23 07:12:18','b1390d66-ac73-11e9-b39a-fa163e0663d5','api6','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.170.236/galaxy\", \"node_io\": \"http://90.147.170.236\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac73-aa28-39cf-bc29-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac73-aa28-39cf-bc29-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac73-aa28-39cf-bc29-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.170.236/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_io:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ] ] }\n','{\"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/857daafb-6136-4c1d-9834-9376271de9d4\", \"additional_description\": \"api6\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_secret_key\": \"secret\", \"version\": \"release_18.09\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"instance_description\": \"ELIXIR-ITALY\", \"storage_encryption\": \"True\", \"flavor\": \"galaxy-no-tools\", \"storage_size\": \"50 GB\", \"admin_email\": \"ma.tangaro@gmail.com\", \"vault_wrapping_token\": \"s.UaeC6W62ymZnGFhwCqlkbheJ\", \"instance_flavor\": \"medium\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'857daafb-6136-4c1d-9834-9376271de9d4','secret',''),('11e9ac8f-5452-95c9-bc29-024283ff312a','2019-07-22 14:45:00','2019-07-23 07:33:13','','Gaslini','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac8f-5452-95c9-bc29-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac8f-5452-95c9-bc29-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac8f-5452-95c9-bc29-024283ff312a/template\"}]','9ab9b24b-1e70-4bfd-b1c1-25eb81d944e1','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"storage_size\": \"500 GB\", \"vault_wrapping_token\": \"s.bFKBlQMpeLwinlWYUXmYJgp7\", \"additional_description\": \"Gaslini\", \"storage_encryption\": \"True\", \"admin_email\": \"davidecangelosi@gaslini.org\", \"instance_flavor\": \"large\", \"version\": \"release_18.05\", \"vault_secret_key\": \"secret\", \"vault_secret_path\": \"9ab9b24b-1e70-4bfd-b1c1-25eb81d944e1/b41ba907-bfef-4b4c-8392-b8239f4a9805\", \"refdata_cvmfs_repository_name\": \"elixir-italy.covacs.refdata\", \"instance_description\": \"IRCSS Istituto Giannina Gaslini\", \"flavor\": \"galaxy-CoVaCS\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDXX1yWFKqehs1GGlAa2cMygRG0omALM6a1LNZfjn+AHJYtBbKuScA11wxmXfc1sWaW0d9zNSQbugE3quF0Y5riMA++QMlY/2cuSKlJkq8O/O2KRxQ6re2Rm7tNuOYewmTCT65u93fJMvXbUDKKo3jGQb0R7N/TKlSmxiAMVuULUyyH5lVIHABiJqC9Dx5MzsZ4ycwxnH+mal0Vby1C36Nl7ivDUoF5jactqEj/1phcUVDR5pklHV0nB1QpBaubvI58XDcfNt/PU7OsLyDo0VuIqihDgiXLvPdNggP40tKIZhCF8ZTx1qugbvM+uzSuxY/81Y08GCtuMbT+7Zk3I9Nr andreacornero@s14100-marray2.local\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',1,'b41ba907-bfef-4b4c-8392-b8239f4a9805','secret',''),('11e9ac95-f770-f3eb-bc29-024283ff312a','2019-07-22 15:32:00','2019-07-22 18:27:57','','api7','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac95-f770-f3eb-bc29-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac95-f770-f3eb-bc29-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ac95-f770-f3eb-bc29-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/541c7e3b-5393-4408-9bd4-035ba46713ca\", \"version\": \"release_18.09\", \"storage_size\": \"50 GB\", \"instance_flavor\": \"medium\", \"storage_encryption\": \"True\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"flavor\": \"galaxy-no-tools\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"additional_description\": \"api7\", \"vault_wrapping_token\": \"s.5jQ5mm7IiqAqlYcst3ghloXX\", \"vault_secret_key\": \"secret\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'541c7e3b-5393-4408-9bd4-035ba46713ca','secret',''),('11e9ad14-8b43-d37f-bc29-024283ff312a','2019-07-23 06:38:00','2019-07-26 11:49:09','90cc3110-ad14-11e9-8255-fa163e0663d5','api8','DELETE_COMPLETE','{\"node_ip\": \"90.147.170.28\", \"endpoint\": \"http://90.147.170.28/galaxy\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ad14-8b43-d37f-bc29-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ad14-8b43-d37f-bc29-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ad14-8b43-d37f-bc29-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.170.28/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"additional_description\": \"api8\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.mnYaHicWmBaL9SAN4aj3gVnm\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/83594085-7b4e-44a1-ba1f-5baa341d293d\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'83594085-7b4e-44a1-ba1f-5baa341d293d','secret',''),('11e9ad18-0ec5-1c56-8b13-024283ff312a','2019-07-23 07:04:00','2019-07-23 07:31:04','1972c364-ad18-11e9-a036-fa163e0663d5','covacs express','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.219/galaxy\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ad18-0ec5-1c56-8b13-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ad18-0ec5-1c56-8b13-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ad18-0ec5-1c56-8b13-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.219/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n  #- indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine from a VM image (FAST).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"covacs express\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.W3WbcCpfcPhepPjleHUYXT0t\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/97a03917-be2a-4422-b6c3-f80478a5e085\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'97a03917-be2a-4422-b6c3-f80478a5e085','secret',''),('11e9ad18-22a0-e1d3-8b13-024283ff312a','2019-07-23 07:04:00','2019-07-23 10:34:49','29405068-ad18-11e9-b39a-fa163e0663d5','covacs express 2','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.225/galaxy\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ad18-22a0-e1d3-8b13-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ad18-22a0-e1d3-8b13-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ad18-22a0-e1d3-8b13-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.225/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n  #- indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine from a VM image (FAST).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"covacs express 2\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-CoVaCS\", \"refdata_cvmfs_repository_name\": \"elixir-italy.covacs.refdata\", \"vault_wrapping_token\": \"s.KMB0HowQ4cnRvxGMFmeFTE7l\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/dacea628-ebc1-430a-a1b1-449680464eb8\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'dacea628-ebc1-430a-a1b1-449680464eb8','secret',''),('11e9ad1c-2046-c86f-8b13-024283ff312a','2019-07-23 07:33:00','2019-07-23 07:52:00','259325ae-ad1c-11e9-b04e-fa163e0663d5','IGG Galaxy Service','CREATE_COMPLETE','{\"endpoint\": \"http://90.147.170.48/galaxy\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ad1c-2046-c86f-8b13-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ad1c-2046-c86f-8b13-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ad1c-2046-c86f-8b13-024283ff312a/template\"}]','9ab9b24b-1e70-4bfd-b1c1-25eb81d944e1','provider-RECAS-BARI','http://90.147.170.48/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n  #- indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine from a VM image (FAST).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"additional_description\": \"IGG Galaxy Service\", \"instance_flavor\": \"large\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDXX1yWFKqehs1GGlAa2cMygRG0omALM6a1LNZfjn+AHJYtBbKuScA11wxmXfc1sWaW0d9zNSQbugE3quF0Y5riMA++QMlY/2cuSKlJkq8O/O2KRxQ6re2Rm7tNuOYewmTCT65u93fJMvXbUDKKo3jGQb0R7N/TKlSmxiAMVuULUyyH5lVIHABiJqC9Dx5MzsZ4ycwxnH+mal0Vby1C36Nl7ivDUoF5jactqEj/1phcUVDR5pklHV0nB1QpBaubvI58XDcfNt/PU7OsLyDo0VuIqihDgiXLvPdNggP40tKIZhCF8ZTx1qugbvM+uzSuxY/81Y08GCtuMbT+7Zk3I9Nr andreacornero@s14100-marray2.local\", \"storage_encryption\": \"True\", \"storage_size\": \"500 GB\", \"version\": \"release_18.05\", \"instance_description\": \"Gaslini\", \"admin_email\": \"davidecangelosi@gaslini.org\", \"flavor\": \"galaxy-CoVaCS\", \"refdata_cvmfs_repository_name\": \"elixir-italy.covacs.refdata\", \"vault_wrapping_token\": \"s.3HCZNe4ASA6dnbjmtXNkO0gx\", \"vault_secret_path\": \"9ab9b24b-1e70-4bfd-b1c1-25eb81d944e1/60245421-87fb-4e11-9d9d-6d944404038a\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'60245421-87fb-4e11-9d9d-6d944404038a','secret',''),('11e9adf1-3529-8e3e-8b13-024283ff312a','2019-07-24 08:58:00','2019-07-24 10:40:10','40f95cde-adf1-11e9-bb42-fa163e0663d5','rna workbench docker','DELETE_COMPLETE','{}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9adf1-3529-8e3e-8b13-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9adf1-3529-8e3e-8b13-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9adf1-3529-8e3e-8b13-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  TOSCA test for launching a Galaxy Server also configuring the bowtie2\n  tool using Galaxy Tool Shed.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: ma.tangaro@gmail.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: GALAXY_ADMIN_API_KEY\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: release_18.05\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: \'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDrm8mxOuqwP5XTHf685V9rqRXXg41F4isJvRr4h3MPDs8PgqZBzzjxEFyGpJ/Rgg4ACesGBZy+CbVVGtOveltKvgkpzyHIrh+vMay9z82eK2LMZEfmEPgw1BHdRifPZ1Qb7Zmj1nRk1EMWoNvbBxEc3/MSorWb+2SVMs+42EZ7QxavBmsU7zNU0Nd0e1xiqJ00VDWMnXullp/ieR9M4/XsSlS3oqxsxkAbY3eQYVMsnh64oiRw3lpYBkPyNtC/VSL5Cqig3CMaiK9AW8FjP1GwwqoMjL0H0Mkr0fY8eSSQ9Tcy5AqyaiPn7tmG0fSeNOFwxGkTzrujqlCiOkRSM1Yj marco@MacBook-Pro-di-Marco.local\'\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"bgruening/galaxy-stable\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalDocker\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            #private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base \n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ] ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"additional_description\": \"rna workbench docker\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"quay.io/bgruening/galaxy-rna-workbench:19.01\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9adff-41d1-1d2b-8b13-024283ff312a','2019-07-24 10:39:00','2019-07-24 13:38:34','4ac5091c-adff-11e9-bb42-fa163e0663d5','docker2','DELETE_COMPLETE','{}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9adff-41d1-1d2b-8b13-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9adff-41d1-1d2b-8b13-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9adff-41d1-1d2b-8b13-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  TOSCA test for launching a Galaxy Server also configuring the bowtie2\n  tool using Galaxy Tool Shed.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: ma.tangaro@gmail.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: GALAXY_ADMIN_API_KEY\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: release_18.05\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: \'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDrm8mxOuqwP5XTHf685V9rqRXXg41F4isJvRr4h3MPDs8PgqZBzzjxEFyGpJ/Rgg4ACesGBZy+CbVVGtOveltKvgkpzyHIrh+vMay9z82eK2LMZEfmEPgw1BHdRifPZ1Qb7Zmj1nRk1EMWoNvbBxEc3/MSorWb+2SVMs+42EZ7QxavBmsU7zNU0Nd0e1xiqJ00VDWMnXullp/ieR9M4/XsSlS3oqxsxkAbY3eQYVMsnh64oiRw3lpYBkPyNtC/VSL5Cqig3CMaiK9AW8FjP1GwwqoMjL0H0Mkr0fY8eSSQ9Tcy5AqyaiPn7tmG0fSeNOFwxGkTzrujqlCiOkRSM1Yj marco@MacBook-Pro-di-Marco.local\'\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"bgruening/galaxy-stable\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalDocker\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            #private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base \n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ] ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"storage_size\": \"50 GB\", \"additional_description\": \"docker2\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"flavor\": \"quay.io/bgruening/galaxy-rna-workbench:19.01\", \"vault_secret_key\": \"secret\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"instance_flavor\": \"medium\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9ae17-d363-93f0-8b13-024283ff312a','2019-07-24 13:34:00','2019-07-25 12:40:29','dfb12be2-ae17-11e9-bb42-fa163e0663d5','ciao','DELETE_COMPLETE','{\"endpoint\": \"90.147.75.181\", \"node_creds\": {\"token_type\": \"private_key\", \"user\": \"cloudadm\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqQIBAAKCAQEAti0P4YjIn+2lkRNZqAjqp+lkdWpQU6pcuQerLnVlrca6/ju9\nuaMVcKGSJYM3X9u4YWpDDU90q6BwIPNh6s+YYIxol1Okf8uKk4v148P1tVj1mVX4\no5vYBH+0hIZkU/XnaujLigWHZrgtvBbqrJUSZs4PdGWQ27DglJAwqgxPsBZWmwzS\nkburDd5En1T51H8BlGWyQUye96Haq5UoeNad3IVydWTFv0/rleizmS36n5LqWZ9F\ndgD4ZhiH5r7RpQxqukuC/IaTM0ncJDuKY8YJ+5vFlNuvGu9bfBJSsYUpGAfcFy0Z\n6pxbE9inlymyFPatwDsSQ6wZb28MsN4vCeN12wIDAQABAoIBAQCal7bITsjhXkuH\nxwHoJFjs0JPdR7COrx0sLyPGsvzr8J6yK4QeyhPhllps1uLgx5W5pPDtlKWPFwDQ\nFXjcR/ooxD3lXKdVgyY/ex/Yfmw9zhXsXxY10IQJnU1UwK7WyO/uu0ot/+8c7eJx\noIjYl1AcSXS385BvvbN2nr2NMBFXfMySlgvPGTsponPFh8Ixdwr4vJBf9JCC55EA\njPcD229ZW1zug8aZcXl4RrOh7XA+JoZU8Ec/nSOhS/oEUCTV4O2IETGLVzIWWbc7\nP28LCnF1yKKkxtGvEhsuTKBKLZiiM8LXuiaxPpEDFDu4/KIqLBDPv8GaAuopGS6o\nTQZhlf8BAoIAgQDBXSWBuhij8l+72hxZemx4JCFhDlcYyyIcgWtQXkKsDMDgYV4l\n9Bw+xhuJQRlFJB2ofqH7KP1hY1zqEvE79n+aVsENQUHETe9DVu2lZ3gBNx/RTQ8Z\nFeLbzrsYwMEEMYdZpsBWOaSkLDfsLB0/qtgC981/nMdGgRFqGIyZ3AA5QQKCAIEA\n8TAn3ASkR1Ogf8RGbYu3ZHB7EjwUBcHjtvJIAYv/ZSdj6YU22dfZ2qH4uuhuVOQ4\n7RFXN3cYJFD/YM57J7/GsmPcGBUZwL0a06A6IuoNEnqoh3uiGMSwPbig6TTkuLfJ\njow95KS6BZMLMLN0Y9/BzGoY9epdUxnzlFrutCo2bBsCggCAFbWdhmkcZxvJP9AH\nKsyh7QMxdDIl+TSlScoGAGn01lhAN3D3Hw+/NBUN9mUGr0qUwdwl14sMl6iOQAGM\ncA0G2o8u8YwIFEAjws25tL5fLNPBkMA0F77rT35wZyENCql85sXgBk5Ge+AzDyMM\nzZ8izYKA4fj6LqJDEERdVNDsfYECggCBANGgejRnsGTyEWCbNl9F/SqF/OHXZ8ut\nPn8my2DUzjCb8OHpT8g9LHMzLh09oY+VIMkjtjtV/pyp7Zy1OiNNMqSf2I7x4AU+\nF0/yRjVMWfpCs7G1yihe45NxoiGvQFAwJTYJPE46whfQOvykLLgVpbpGSNWMUnrE\n5ol+E1RyEAUbAoIAgGAFFCOb/AEnp1b+gpx8w8JfQj40jppvYF/Q47q59d9h4rgR\nrHWt3NP8TIncarOzVZAAmGTqH5ykxCAqIqX8MA+WQr3045O6MxYXE97kEBEaCb9B\nv/L6d2KQ8MWXHHDXsNHo61mDQ9E4X1r4qeoW/x0e7+enLw2Jt7FMRH8+7P/Z\n-----END RSA PRIVATE KEY-----\n\"}}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ae17-d363-93f0-8b13-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ae17-d363-93f0-8b13-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9ae17-d363-93f0-8b13-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','90.147.75.181','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\n\ntopology_template:\n \n  node_templates:\n   \n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            #private_ip: false\n            ports:\n              user_port:\n                protocol: tcp\n                source: 9000\n              other_port:\n                protocol: tcp\n                source: 9001\n              ssh_port:\n                protocol: tcp\n                source: 22\n        scalable:\n          properties:\n            count: 1\n        host:\n          properties:\n            num_cpus: 1\n            mem_size: 2 GB\n        os:\n          properties:\n            type: linux  \n            # The format of the image must be defined\n            # Currently this example uses the IM URI convention\n            # used in disk.0.image.url\n            # see: http://imdocs.readthedocs.org/en/latest/radl.html?highlight=uri#system-features\n            #image: ubuntu-16.04-vmi\n            #image: centos-7-1708-vmi\n            #image: ubuntu-16.04_2nic\n            #image: centos-7_2nic\n            image: centos-7-galaxy-base\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                #location: /export\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: 1 GB\n\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"additional_description\": \"ciao\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9aedd-69fd-1648-8b13-024283ff312a','2019-07-25 13:09:00','2019-07-26 15:48:09','71d1dd94-aedd-11e9-8af8-fa163e0663d5','nocrypt','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.80/galaxy\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aedd-69fd-1648-8b13-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aedd-69fd-1648-8b13-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aedd-69fd-1648-8b13-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.80/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n  #- indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine from a VM image (FAST).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n','{\"version\": \"release_18.05\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"storage_size\": \"50 GB\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"additional_description\": \"nocrypt\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"instance_description\": \"ELIXIR-ITALY\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9aef2-28af-33b5-8b13-024283ff312a','2019-07-25 15:37:00','2019-07-26 11:49:10','36af6226-aef2-11e9-bb42-fa163e0663d5','docker','DELETE_COMPLETE','{\"node_ip\": \"90.147.170.44\", \"endpoint\": \"http://90.147.170.44\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aef2-28af-33b5-8b13-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aef2-28af-33b5-8b13-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9aef2-28af-33b5-8b13-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.170.44','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  TOSCA test for launching a Galaxy Server also configuring the bowtie2\n  tool using Galaxy Tool Shed.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: ma.tangaro@gmail.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: GALAXY_ADMIN_API_KEY\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: release_18.05\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: \'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDrm8mxOuqwP5XTHf685V9rqRXXg41F4isJvRr4h3MPDs8PgqZBzzjxEFyGpJ/Rgg4ACesGBZy+CbVVGtOveltKvgkpzyHIrh+vMay9z82eK2LMZEfmEPgw1BHdRifPZ1Qb7Zmj1nRk1EMWoNvbBxEc3/MSorWb+2SVMs+42EZ7QxavBmsU7zNU0Nd0e1xiqJ00VDWMnXullp/ieR9M4/XsSlS3oqxsxkAbY3eQYVMsnh64oiRw3lpYBkPyNtC/VSL5Cqig3CMaiK9AW8FjP1GwwqoMjL0H0Mkr0fY8eSSQ9Tcy5AqyaiPn7tmG0fSeNOFwxGkTzrujqlCiOkRSM1Yj marco@MacBook-Pro-di-Marco.local\'\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"bgruening/galaxy-stable\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalDocker\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            #private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base \n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ] ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"instance_flavor\": \"medium\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"admin_email\": \"ma.tangaro@gmail.com\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"instance_description\": \"ELIXIR-ITALY\", \"flavor\": \"bgruening/galaxy-stable:19.01\", \"additional_description\": \"docker\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9afa0-cd07-5a5f-8b13-024283ff312a','2019-07-26 12:27:00','2019-07-26 13:43:43','','galaxyctl api 1','DELETE_COMPLETE','{}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9afa0-cd07-5a5f-8b13-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9afa0-cd07-5a5f-8b13-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9afa0-cd07-5a5f-8b13-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"flavor\": \"galaxy-no-tools\", \"admin_email\": \"ma.tangaro@gmail.com\", \"storage_size\": \"50 GB\", \"instance_flavor\": \"medium\", \"instance_description\": \"ELIXIR-ITALY\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"additional_description\": \"galaxyctl api 1\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"version\": \"release_18.09\", \"vault_secret_key\": \"secret\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9afa8-6deb-14ac-8b13-024283ff312a','2019-07-26 13:22:00','2019-07-26 13:43:44','77e32f14-afa8-11e9-bb42-fa163e0663d5','galaxyctl_api 2','DELETE_COMPLETE','{}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9afa8-6deb-14ac-8b13-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9afa8-6deb-14ac-8b13-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9afa8-6deb-14ac-8b13-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"additional_description\": \"galaxyctl_api 2\", \"admin_email\": \"ma.tangaro@gmail.com\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"instance_description\": \"ELIXIR-ITALY\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"flavor\": \"galaxy-no-tools\", \"instance_flavor\": \"medium\", \"vault_secret_key\": \"secret\", \"version\": \"release_18.09\", \"storage_size\": \"50 GB\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9afac-5f77-e75e-8b13-024283ff312a','2019-07-26 13:50:00','2019-07-26 15:48:09','68030b1a-afac-11e9-8255-fa163e0663d5','galaxyctl_api fix 1','DELETE_COMPLETE','{\"node_ip\": \"90.147.75.21\", \"endpoint\": \"http://90.147.75.21/galaxy\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9afac-5f77-e75e-8b13-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9afac-5f77-e75e-8b13-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9afac-5f77-e75e-8b13-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.21/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"admin_email\": \"ma.tangaro@gmail.com\", \"version\": \"release_18.09\", \"instance_description\": \"ELIXIR-ITALY\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"additional_description\": \"galaxyctl_api fix 1\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"instance_flavor\": \"medium\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9afbd-5a91-91ff-8b13-024283ff312a','2019-07-26 15:52:00','2019-07-26 16:22:27','64430bb8-afbd-11e9-a8ac-fa163e0663d5','express','DELETE_COMPLETE','{\"node_ip\": \"90.147.75.49\", \"endpoint\": \"http://90.147.75.49/galaxy\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9afbd-5a91-91ff-8b13-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9afbd-5a91-91ff-8b13-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9afbd-5a91-91ff-8b13-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.49/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n  #- indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine from a VM image (FAST).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"flavor\": \"galaxy-minimal\", \"admin_email\": \"ma.tangaro@gmail.com\", \"instance_flavor\": \"medium\", \"storage_size\": \"50 GB\", \"additional_description\": \"express\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9afc0-fa94-1138-8b13-024283ff312a','2019-07-26 16:18:00','2019-07-27 07:20:41','','galaxyctl_api 2','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9afc0-fa94-1138-8b13-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9afc0-fa94-1138-8b13-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9afc0-fa94-1138-8b13-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n  #- indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine from a VM image (FAST).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"flavor\": \"galaxy-minimal\", \"admin_email\": \"ma.tangaro@gmail.com\", \"instance_flavor\": \"medium\", \"storage_size\": \"50 GB\", \"additional_description\": \"galaxyctl_api 2\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b03f-0987-223f-8b13-024283ff312a','2019-07-27 07:20:00','2019-07-27 08:07:22','139c6416-b03f-11e9-a8ac-fa163e0663d5','express test','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.6/galaxy\", \"node_ip\": \"90.147.75.6\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b03f-0987-223f-8b13-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b03f-0987-223f-8b13-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b03f-0987-223f-8b13-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.6/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n  #- indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine from a VM image (FAST).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"additional_description\": \"express test\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b047-e55c-797c-8b13-024283ff312a','2019-07-27 08:24:00','2019-07-27 08:46:26','ec6bd62a-b047-11e9-8255-fa163e0663d5','express crypt','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.102.73/galaxy\", \"node_ip\": \"90.147.102.73\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b047-e55c-797c-8b13-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b047-e55c-797c-8b13-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b047-e55c-797c-8b13-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.102.73/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n  #- indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine from a VM image (FAST).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/a78aca45-9152-4c0a-9f22-5309ae5b9253\", \"storage_encryption\": \"True\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"additional_description\": \"express crypt\", \"instance_flavor\": \"medium\", \"admin_email\": \"ma.tangaro@gmail.com\", \"vault_wrapping_token\": \"s.9IgteNg7lpX2enTfMZSYkrLd\", \"instance_description\": \"ELIXIR-ITALY\", \"version\": \"release_18.05\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'a78aca45-9152-4c0a-9f22-5309ae5b9253','secret',''),('11e9b04b-1d88-a190-8b13-024283ff312a','2019-07-27 08:47:00','2019-07-27 09:08:48','23e4e95e-b04b-11e9-8af8-fa163e0663d5','express crypt 2','DELETE_COMPLETE','{\"node_ip\": \"90.147.75.76\", \"endpoint\": \"http://90.147.75.76/galaxy\"}','NONE','[{\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b04b-1d88-a190-8b13-024283ff312a\", \"rel\": \"self\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b04b-1d88-a190-8b13-024283ff312a/resources\", \"rel\": \"resources\"}, {\"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b04b-1d88-a190-8b13-024283ff312a/template\", \"rel\": \"template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.76/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n  #- indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine from a VM image (FAST).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"instance_flavor\": \"medium\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/cc4ed648-8e9a-44db-b978-a9ef2c962c1e\", \"storage_encryption\": \"True\", \"vault_wrapping_token\": \"s.yeyC6rjdHCYiFiKVnqHWAF4g\", \"admin_email\": \"ma.tangaro@gmail.com\", \"instance_description\": \"ELIXIR-ITALY\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"version\": \"release_18.05\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"additional_description\": \"express crypt 2\", \"flavor\": \"galaxy-minimal\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'cc4ed648-8e9a-44db-b978-a9ef2c962c1e','secret',''),('11e9b057-d81f-15f2-bc63-024283ff312a','2019-07-27 10:18:00','2019-07-27 14:15:24','e1e2ec88-b057-11e9-8255-fa163e0663d5','new refdata 1','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.86/galaxy\", \"node_ip\": \"90.147.75.86\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b057-d81f-15f2-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b057-d81f-15f2-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b057-d81f-15f2-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.86/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"additional_description\": \"new refdata 1\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"version\": \"release_18.09\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b078-f7ba-a84d-bc63-024283ff312a','2019-07-27 14:15:00','2019-07-27 14:21:35','0641a396-b079-11e9-b39a-fa163e0663d5','express test 2','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b078-f7ba-a84d-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b078-f7ba-a84d-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b078-f7ba-a84d-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n  #- indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine from a VM image (FAST).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"additional_description\": \"express test 2\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b079-0951-d4fd-bc63-024283ff312a','2019-07-27 14:15:00','2019-07-27 14:52:19','0ecd2968-b079-11e9-b04e-fa163e0663d5','refdata test 1','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.170.153/galaxy\", \"node_ip\": \"90.147.170.153\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b079-0951-d4fd-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b079-0951-d4fd-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b079-0951-d4fd-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.170.153/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"additional_description\": \"refdata test 1\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"version\": \"release_18.09\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b079-af72-fa6b-bc63-024283ff312a','2019-07-27 14:20:00','2019-07-27 14:48:07','bb6c4622-b079-11e9-98a0-fa163e0663d5','express test 2','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.170.170/galaxy\", \"node_ip\": \"90.147.170.170\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b079-af72-fa6b-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b079-af72-fa6b-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b079-af72-fa6b-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.170.170/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n  #- indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine from a VM image (FAST).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"additional_description\": \"express test 2\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b07d-d2f2-35ce-bc63-024283ff312a','2019-07-27 14:50:00','2019-07-27 15:31:12','eec6daba-b07d-11e9-b04e-fa163e0663d5','cluster 2','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.170.21/galaxy\", \"node_ip\": \"90.147.170.21\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b07d-d2f2-35ce-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b07d-d2f2-35ce-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b07d-d2f2-35ce-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.170.21/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy from scratch with cluster support (SLOW).\n  The basic configuration includes CentOS 7, SLURM, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    wn_num:\n      type: integer\n      description: Number of WNs in the cluster\n      default: 2\n      required: yes\n    fe_instance_flavor:\n      type: string\n      description: front end flavor (num_cpu, memory, disk)\n      default: small\n    wn_instance_flavor:\n      type: string\n      description: worker nodes flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB\n    hybrid:\n      type: boolean\n      description: Flag to specify that this cluster will work in an hybrid environment\n      default: false\n      required: false\n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"ELIXIR-ITALY\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n\n  node_templates:\n\n    galaxy_portal:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: lrms_front_end\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy_portal\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy_portal\n        - dependency: galaxy_tools\n\n    lrms_front_end:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Slurm\n      properties:\n        wn_ips: { get_attribute: [ lrms_wn, private_address ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_server\n\n    lrms_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            dns_name: slurmserver\n            network_name: PUBLIC\n            ports:\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        host:\n          properties:\n            instance_type: { get_input: fe_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: centos-7_2nic\n            #image: ubuntu-16.04-vmi\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n    wn_node:\n      type: tosca.nodes.indigo.LRMS.WorkerNode.Slurm\n      properties:\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        public_front_end_ip: { get_attribute: [ lrms_server, public_address, 0 ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: galaxy_portal\n\n    galaxy_wn:\n      type: tosca.nodes.indigo.GalaxyWnCvmfsReferenceData\n      properties:\n        export_dir: { get_input: export_dir }\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        flavor: { get_input: flavor }\n        version: { get_input: version }\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: wn_node\n\n    lrms_wn:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        scalable:\n          properties:\n            count: { get_input: wn_num }\n        host:\n          properties:\n            instance_type: { get_input: wn_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: centos-7_2nic\n            #image: ubuntu-16.04-vmi\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ lrms_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ lrms_server, public_address, 0 ] }\n','{\"additional_description\": \"cluster 2\", \"fe_instance_flavor\": \"medium\", \"wn_num\": \"1\", \"wn_instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b07f-9c9a-1747-bc63-024283ff312a','2019-07-27 15:02:00','2019-07-27 15:47:26','a3e8ca2e-b07f-11e9-98a0-fa163e0663d5','galaxy docker 1','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.170.32\", \"node_ip\": \"90.147.170.32\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b07f-9c9a-1747-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b07f-9c9a-1747-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b07f-9c9a-1747-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.170.32','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy official docker image  on a single Virtual Machine.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: ma.tangaro@gmail.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: GALAXY_ADMIN_API_KEY\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: release_18.05\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: \'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDrm8mxOuqwP5XTHf685V9rqRXXg41F4isJvRr4h3MPDs8PgqZBzzjxEFyGpJ/Rgg4ACesGBZy+CbVVGtOveltKvgkpzyHIrh+vMay9z82eK2LMZEfmEPgw1BHdRifPZ1Qb7Zmj1nRk1EMWoNvbBxEc3/MSorWb+2SVMs+42EZ7QxavBmsU7zNU0Nd0e1xiqJ00VDWMnXullp/ieR9M4/XsSlS3oqxsxkAbY3eQYVMsnh64oiRw3lpYBkPyNtC/VSL5Cqig3CMaiK9AW8FjP1GwwqoMjL0H0Mkr0fY8eSSQ9Tcy5AqyaiPn7tmG0fSeNOFwxGkTzrujqlCiOkRSM1Yj marco@MacBook-Pro-di-Marco.local\'\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"bgruening/galaxy-stable\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalDocker\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            #private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: ubuntu-16.04-vmi \n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ] ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"additional_description\": \"galaxy docker 1\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"instance_description\": \"prova marco\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"bgruening/galaxy-stable:19.01\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b083-2db7-1be7-bc63-024283ff312a','2019-07-27 15:28:00','2019-07-27 16:40:41','35ff103c-b083-11e9-b04e-fa163e0663d5','elastic cluster 1','DELETE_COMPLETE','{\"galaxy_url\": \"http://90.147.102.13/galaxy\", \"cluster_ip\": \"90.147.102.13\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b083-2db7-1be7-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b083-2db7-1be7-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b083-2db7-1be7-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy from scratch with elastic cluster support (SLOW).\n  The basic configuration includes CentOS 7, SLURM, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\n\ntopology_template:\n  inputs:\n    wn_num_max:\n      type: integer\n      description: Maximum number of WNs in the elastic cluster\n      default: 1\n      required: yes\n    wn_num_min:\n      type: integer\n      description: Minimum number of WNs in the elastic cluster\n      default: 0\n      required: yes\n    fe_instance_flavor:\n      type: string\n      description: front end flavor (num_cpu, memory, disk)\n      default: medium\n    wn_instance_flavor:\n      type: string\n      description: worker nodes flavor (num_cpu, memory, disk)\n      default: medium\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB\n    hybrid:\n      type: boolean\n      description: Flag to specify that this cluster will work in an hybrid environment\n      default: false\n      required: false\n\n    galaxy_storage_type:\n      type: string\n      description: Storage type (Iaas Block Storage, Onedata, Filesystem encryption)\n      default: \"IaaS\"\n    userdata_provider:\n      type: string\n      description: default OneProvider\n      default: \"not_a_privder_url\"\n    userdata_token:\n      type: string\n      description: Access token for onedata space\n      default: \"not_a_token\"\n    userdata_space:\n      type: string\n      description: Onedata space\n      default: \"galaxy\"\n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    version:\n      type: string\n      description: galaxy version to install\n      default: release_17.05\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \'ELIXIR-IT SLURM (elastic)\'\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: \'your_ssh_public_key\'\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n\n  node_templates:\n\n    elastic_cluster_front_end:\n      type: tosca.nodes.indigo.ElasticCluster\n      properties:\n        deployment_id: orchestrator_deployment_id\n        iam_access_token: iam_access_token\n        iam_clues_client_id: iam_clues_client_id\n        iam_clues_client_secret: iam_clues_client_secret\n        hybrid: { get_input: hybrid }\n      requirements:\n        - lrms: lrms_front_end\n        - wn: wn_node\n\n    galaxy_portal:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        os_storage: { get_input: galaxy_storage_type }\n        token: { get_input: userdata_token }\n        provider: { get_input: userdata_provider }\n        space: { get_input: userdata_space }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: lrms_front_end\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy_portal\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy_portal\n        - dependency: galaxy_tools\n\n    lrms_front_end:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Slurm\n      properties:\n        wn_ips: { get_attribute: [ lrms_wn, private_address ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_server\n\n    lrms_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            dns_name: slurmserver\n            network_name: PUBLIC\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        host:\n          properties:\n            instance_type: { get_input: fe_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: centos-7_2nic\n            #image: ubuntu-16.04_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n    wn_node:\n      type: tosca.nodes.indigo.LRMS.WorkerNode.Slurm\n      properties:\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        public_front_end_ip: { get_attribute: [ lrms_server, public_address, 0 ] }\n        hybrid: { get_input: hybrid }\n      capabilities:\n        wn:\n          properties:\n            max_instances: { get_input: wn_num_max }\n            min_instances: { get_input: wn_num_min }\n      requirements:\n        - host: lrms_wn\n        #This component install slurm.\n        #Galaxy send jobs to slurm as {{ galaxy }} user.\n        # So the user has to be created before the slurm installation.\n        # Galaxy user creation is done in galaxy_wn.\n        - dependency: galaxy_wn\n\n    galaxy_wn:\n      type: tosca.nodes.indigo.GalaxyWnCvmfsReferenceData\n      properties:\n        export_dir: { get_input: export_dir }\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        flavor: { get_input: flavor }\n        version: { get_input: version }\n        reference_data: { get_input: reference_data }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n      requirements:\n        - host: lrms_wn\n        # The worker node has to be configured after the galaxy_portal component\n        # since the {{ export_dir }} and the external volume is created there.\n        #This is mandatory for wn_num_min > 0, while can be ignored for pure elastic clusters.\n        - dependency: galaxy_portal\n\n    lrms_wn:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        scalable:\n          properties:\n            count: { get_input: wn_num_min }\n        endpoint:\n          properties:\n            # Needed on ReCaS Cloud.\n            # The name of the private network is hard-coded here to append the right interface.\n            # This configuration broke the portability.\n            network_name: private_net\n        host:\n          properties:\n            instance_type: { get_input: wn_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: centos-7_2nic\n            #image: ubuntu-16.04_2nic\n\n  outputs:\n    galaxy_url:\n      value: { concat: [ \'http://\', get_attribute: [ lrms_server, public_address, 0 ], \'/galaxy\' ] }\n    cluster_ip:\n      value: { get_attribute: [ lrms_server, public_address, 0 ] }\n','{\"additional_description\": \"elastic cluster 1\", \"fe_instance_flavor\": \"medium\", \"wn_num\": \"1\", \"wn_instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b085-87e9-18bc-bc63-024283ff312a','2019-07-27 15:45:00','2019-07-27 16:29:19','96f38d8a-b085-11e9-a8ac-fa163e0663d5','docker test 2','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.170.49\", \"node_ip\": \"90.147.170.49\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b085-87e9-18bc-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b085-87e9-18bc-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b085-87e9-18bc-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.170.49','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy official docker image  on a single Virtual Machine.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: ma.tangaro@gmail.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: GALAXY_ADMIN_API_KEY\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: release_18.05\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: \'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDrm8mxOuqwP5XTHf685V9rqRXXg41F4isJvRr4h3MPDs8PgqZBzzjxEFyGpJ/Rgg4ACesGBZy+CbVVGtOveltKvgkpzyHIrh+vMay9z82eK2LMZEfmEPgw1BHdRifPZ1Qb7Zmj1nRk1EMWoNvbBxEc3/MSorWb+2SVMs+42EZ7QxavBmsU7zNU0Nd0e1xiqJ00VDWMnXullp/ieR9M4/XsSlS3oqxsxkAbY3eQYVMsnh64oiRw3lpYBkPyNtC/VSL5Cqig3CMaiK9AW8FjP1GwwqoMjL0H0Mkr0fY8eSSQ9Tcy5AqyaiPn7tmG0fSeNOFwxGkTzrujqlCiOkRSM1Yj marco@MacBook-Pro-di-Marco.local\'\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"bgruening/galaxy-stable\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalDocker\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            #private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: ubuntu-16.04-vmi \n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ] ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"additional_description\": \"docker test 2\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"bgruening/galaxy-stable:19.01\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b153-be49-08de-bc63-024283ff312a','2019-07-28 16:21:00','2019-07-28 22:42:31','','elastic 1','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b153-be49-08de-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b153-be49-08de-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b153-be49-08de-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy from scratch with elastic cluster support (SLOW).\n  The basic configuration includes CentOS 7, SLURM, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\n\ntopology_template:\n  inputs:\n    wn_num_max:\n      type: integer\n      description: Maximum number of WNs in the elastic cluster\n      default: 1\n      required: yes\n    wn_num_min:\n      type: integer\n      description: Minimum number of WNs in the elastic cluster\n      default: 0\n      required: yes\n    fe_instance_flavor:\n      type: string\n      description: front end flavor (num_cpu, memory, disk)\n      default: medium\n    wn_instance_flavor:\n      type: string\n      description: worker nodes flavor (num_cpu, memory, disk)\n      default: medium\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB\n    hybrid:\n      type: boolean\n      description: Flag to specify that this cluster will work in an hybrid environment\n      default: false\n      required: false\n\n    galaxy_storage_type:\n      type: string\n      description: Storage type (Iaas Block Storage, Onedata, Filesystem encryption)\n      default: \"IaaS\"\n    userdata_provider:\n      type: string\n      description: default OneProvider\n      default: \"not_a_privder_url\"\n    userdata_token:\n      type: string\n      description: Access token for onedata space\n      default: \"not_a_token\"\n    userdata_space:\n      type: string\n      description: Onedata space\n      default: \"galaxy\"\n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    version:\n      type: string\n      description: galaxy version to install\n      default: release_17.05\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \'ELIXIR-IT SLURM (elastic)\'\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: \'your_ssh_public_key\'\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n    refdata_repository_name:\n      type: string\n      description: Onedata space name, CernVM-FS repository name or subdirectory downaload name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_provider_type:\n      type: string\n      description: Select Reference data provider type (Onedata, CernVM-FS or download)\n      default: \'cvmfs_preconfigured\'\n    refdata_provider:\n      type: string\n      description: Oneprovider for reference data\n      default: \'not_a_provider\'\n    refdata_token:\n      type: string\n      description: Access token for reference data\n      default: \'not_a_token\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: Reference data CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n\n\n  node_templates:\n\n    elastic_cluster_front_end:\n      type: tosca.nodes.indigo.ElasticCluster\n      properties:\n        deployment_id: orchestrator_deployment_id\n        iam_access_token: iam_access_token\n        iam_clues_client_id: iam_clues_client_id\n        iam_clues_client_secret: iam_clues_client_secret\n        hybrid: { get_input: hybrid }\n      requirements:\n        - lrms: lrms_front_end\n        - wn: wn_node\n\n    galaxy_portal:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        os_storage: { get_input: galaxy_storage_type }\n        token: { get_input: userdata_token }\n        provider: { get_input: userdata_provider }\n        space: { get_input: userdata_space }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: lrms_front_end\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy_portal\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n        refdata_repository_name: { get_input: refdata_repository_name }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_provider: { get_input: refdata_provider }\n        refdata_token: { get_input: refdata_token }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n      requirements:\n        - host: galaxy_portal\n        - dependency: galaxy_tools\n\n    lrms_front_end:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Slurm\n      properties:\n        wn_ips: { get_attribute: [ lrms_wn, private_address ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_server\n\n    lrms_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            dns_name: slurmserver\n            network_name: PUBLIC\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        host:\n          properties:\n            instance_type: { get_input: fe_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: centos-7_2nic\n            #image: ubuntu-16.04_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n    wn_node:\n      type: tosca.nodes.indigo.LRMS.WorkerNode.Slurm\n      properties:\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        public_front_end_ip: { get_attribute: [ lrms_server, public_address, 0 ] }\n        hybrid: { get_input: hybrid }\n      capabilities:\n        wn:\n          properties:\n            max_instances: { get_input: wn_num_max }\n            min_instances: { get_input: wn_num_min }\n      requirements:\n        - host: lrms_wn\n        #This component install slurm.\n        #Galaxy send jobs to slurm as {{ galaxy }} user.\n        # So the user has to be created before the slurm installation.\n        # Galaxy user creation is done in galaxy_wn.\n        - dependency: galaxy_wn\n\n    galaxy_wn:\n      type: tosca.nodes.indigo.GalaxyWnCvmfsReferenceData\n      properties:\n        export_dir: { get_input: export_dir }\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        flavor: { get_input: flavor }\n        version: { get_input: version }\n        reference_data: { get_input: reference_data }\n        refdata_provider_type: { get_input: refdata_provider_type }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n      requirements:\n        - host: lrms_wn\n        # The worker node has to be configured after the galaxy_portal component\n        # since the {{ export_dir }} and the external volume is created there.\n        #This is mandatory for wn_num_min > 0, while can be ignored for pure elastic clusters.\n        - dependency: galaxy_portal\n\n    lrms_wn:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        scalable:\n          properties:\n            count: { get_input: wn_num_min }\n        endpoint:\n          properties:\n            # Needed on ReCaS Cloud.\n            # The name of the private network is hard-coded here to append the right interface.\n            # This configuration broke the portability.\n            network_name: private_net\n        host:\n          properties:\n            instance_type: { get_input: wn_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: centos-7_2nic\n            #image: ubuntu-16.04_2nic\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ lrms_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ lrms_server, public_address, 0 ] }\n','{\"additional_description\": \"elastic 1\", \"fe_instance_flavor\": \"medium\", \"wn_num\": \"1\", \"wn_instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b153-f193-fc8c-bc63-024283ff312a','2019-07-28 16:22:00','2019-07-28 16:41:28','f7ff82cc-b153-11e9-b04e-fa163e0663d5','docker','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.240\", \"node_ip\": \"90.147.75.240\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b153-f193-fc8c-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b153-f193-fc8c-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b153-f193-fc8c-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.240','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy official docker image  on a single Virtual Machine.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: ma.tangaro@gmail.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: GALAXY_ADMIN_API_KEY\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: release_18.05\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: \'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDrm8mxOuqwP5XTHf685V9rqRXXg41F4isJvRr4h3MPDs8PgqZBzzjxEFyGpJ/Rgg4ACesGBZy+CbVVGtOveltKvgkpzyHIrh+vMay9z82eK2LMZEfmEPgw1BHdRifPZ1Qb7Zmj1nRk1EMWoNvbBxEc3/MSorWb+2SVMs+42EZ7QxavBmsU7zNU0Nd0e1xiqJ00VDWMnXullp/ieR9M4/XsSlS3oqxsxkAbY3eQYVMsnh64oiRw3lpYBkPyNtC/VSL5Cqig3CMaiK9AW8FjP1GwwqoMjL0H0Mkr0fY8eSSQ9Tcy5AqyaiPn7tmG0fSeNOFwxGkTzrujqlCiOkRSM1Yj marco@MacBook-Pro-di-Marco.local\'\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"bgruening/galaxy-stable\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalDocker\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            #private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: ubuntu-16.04-vmi \n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ] ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"additional_description\": \"docker\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"bgruening/galaxy-stable:19.01\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b155-3e3b-709d-bc63-024283ff312a','2019-07-28 16:32:00','2019-07-28 22:39:34','498eceee-b155-11e9-8255-fa163e0663d5','cluster','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.246/galaxy\", \"node_ip\": \"90.147.75.246\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b155-3e3b-709d-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b155-3e3b-709d-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b155-3e3b-709d-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.246/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy from scratch with cluster support (SLOW).\n  The basic configuration includes CentOS 7, SLURM, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    wn_num:\n      type: integer\n      description: Number of WNs in the cluster\n      default: 2\n      required: yes\n    fe_instance_flavor:\n      type: string\n      description: front end flavor (num_cpu, memory, disk)\n      default: small\n    wn_instance_flavor:\n      type: string\n      description: worker nodes flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB\n    hybrid:\n      type: boolean\n      description: Flag to specify that this cluster will work in an hybrid environment\n      default: false\n      required: false\n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"ELIXIR-ITALY\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n\n  node_templates:\n\n    galaxy_portal:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: lrms_front_end\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy_portal\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy_portal\n        - dependency: galaxy_tools\n\n    lrms_front_end:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Slurm\n      properties:\n        wn_ips: { get_attribute: [ lrms_wn, private_address ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_server\n\n    lrms_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            dns_name: slurmserver\n            network_name: PUBLIC\n            ports:\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        host:\n          properties:\n            instance_type: { get_input: fe_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: centos-7_2nic\n            #image: ubuntu-16.04-vmi\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n    wn_node:\n      type: tosca.nodes.indigo.LRMS.WorkerNode.Slurm\n      properties:\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        public_front_end_ip: { get_attribute: [ lrms_server, public_address, 0 ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: galaxy_portal\n\n    galaxy_wn:\n      type: tosca.nodes.indigo.GalaxyWnCvmfsReferenceData\n      properties:\n        export_dir: { get_input: export_dir }\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        flavor: { get_input: flavor }\n        version: { get_input: version }\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: wn_node\n\n    lrms_wn:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        scalable:\n          properties:\n            count: { get_input: wn_num }\n        host:\n          properties:\n            instance_type: { get_input: wn_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: centos-7_2nic\n            #image: ubuntu-16.04-vmi\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ lrms_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ lrms_server, public_address, 0 ] }\n','{\"additional_description\": \"cluster\", \"fe_instance_flavor\": \"medium\", \"wn_num\": \"1\", \"wn_instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b156-2de9-5187-bc63-024283ff312a','2019-07-28 16:38:00','2019-07-28 22:43:03','','rna workbench docker','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b156-2de9-5187-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b156-2de9-5187-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b156-2de9-5187-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy official docker image  on a single Virtual Machine.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: ma.tangaro@gmail.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: GALAXY_ADMIN_API_KEY\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: release_18.05\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: \'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDrm8mxOuqwP5XTHf685V9rqRXXg41F4isJvRr4h3MPDs8PgqZBzzjxEFyGpJ/Rgg4ACesGBZy+CbVVGtOveltKvgkpzyHIrh+vMay9z82eK2LMZEfmEPgw1BHdRifPZ1Qb7Zmj1nRk1EMWoNvbBxEc3/MSorWb+2SVMs+42EZ7QxavBmsU7zNU0Nd0e1xiqJ00VDWMnXullp/ieR9M4/XsSlS3oqxsxkAbY3eQYVMsnh64oiRw3lpYBkPyNtC/VSL5Cqig3CMaiK9AW8FjP1GwwqoMjL0H0Mkr0fY8eSSQ9Tcy5AqyaiPn7tmG0fSeNOFwxGkTzrujqlCiOkRSM1Yj marco@MacBook-Pro-di-Marco.local\'\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"bgruening/galaxy-stable\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalDocker\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            #private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: ubuntu-16.04-vmi \n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ] ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"additional_description\": \"rna workbench docker\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"bgruening/galaxy-rna-workbench:19.01\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b189-0cdd-a99e-bc63-024283ff312a','2019-07-28 22:42:00','2019-07-29 08:33:27','1be384a6-b189-11e9-9be1-fa163e0663d5','elastic cluster 2','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.102.122/galaxy\", \"node_ip\": \"90.147.102.122\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b189-0cdd-a99e-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b189-0cdd-a99e-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b189-0cdd-a99e-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.102.122/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy from scratch with elastic cluster support (SLOW).\n  The basic configuration includes CentOS 7, SLURM, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    wn_num_max:\n      type: integer\n      description: Maximum number of WNs in the elastic cluster\n      default: 1\n      required: yes\n    wn_num_min:\n      type: integer\n      description: Minimum number of WNs in the elastic cluster\n      default: 0\n      required: yes\n    fe_instance_flavor:\n      type: string\n      description: front end flavor (num_cpu, memory, disk)\n      default: medium\n    wn_instance_flavor:\n      type: string\n      description: worker nodes flavor (num_cpu, memory, disk)\n      default: medium\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB\n    hybrid:\n      type: boolean\n      description: Flag to specify that this cluster will work in an hybrid environment\n      default: false\n      required: false\n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    version:\n      type: string\n      description: galaxy version to install\n      default: release_17.05\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \'ELIXIR-IT SLURM (elastic)\'\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: \'your_ssh_public_key\'\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n\n  node_templates:\n\n    elastic_cluster_front_end:\n      type: tosca.nodes.indigo.ElasticCluster\n      properties:\n        deployment_id: orchestrator_deployment_id\n        iam_access_token: iam_access_token\n        iam_clues_client_id: iam_clues_client_id\n        iam_clues_client_secret: iam_clues_client_secret\n        hybrid: { get_input: hybrid }\n      requirements:\n        - lrms: lrms_front_end\n        - wn: wn_node\n\n    galaxy_portal:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: lrms_front_end\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy_portal\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy_portal\n        - dependency: galaxy_tools\n\n    lrms_front_end:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Slurm\n      properties:\n        wn_ips: { get_attribute: [ lrms_wn, private_address ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_server\n\n    lrms_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            dns_name: slurmserver\n            network_name: PUBLIC\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        host:\n          properties:\n            instance_type: { get_input: fe_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: centos-7_2nic\n            #image: ubuntu-16.04_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n    wn_node:\n      type: tosca.nodes.indigo.LRMS.WorkerNode.Slurm\n      properties:\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        public_front_end_ip: { get_attribute: [ lrms_server, public_address, 0 ] }\n        hybrid: { get_input: hybrid }\n      capabilities:\n        wn:\n          properties:\n            max_instances: { get_input: wn_num_max }\n            min_instances: { get_input: wn_num_min }\n      requirements:\n        - host: lrms_wn\n        #This component install slurm.\n        #Galaxy send jobs to slurm as {{ galaxy }} user.\n        # So the user has to be created before the slurm installation.\n        # Galaxy user creation is done in galaxy_wn.\n        - dependency: galaxy_wn\n\n    galaxy_wn:\n      type: tosca.nodes.indigo.GalaxyWnCvmfsReferenceData\n      properties:\n        export_dir: { get_input: export_dir }\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        flavor: { get_input: flavor }\n        version: { get_input: version }\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n      requirements:\n        - host: lrms_wn\n        # The worker node has to be configured after the galaxy_portal component\n        # since the {{ export_dir }} and the external volume is created there.\n        #This is mandatory for wn_num_min > 0, while can be ignored for pure elastic clusters.\n        - dependency: galaxy_portal\n\n    lrms_wn:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        scalable:\n          properties:\n            count: { get_input: wn_num_min }\n        endpoint:\n          properties:\n            # Needed on ReCaS Cloud.\n            # The name of the private network is hard-coded here to append the right interface.\n            # This configuration broke the portability.\n            network_name: private_net\n        host:\n          properties:\n            instance_type: { get_input: wn_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: centos-7_2nic\n            #image: ubuntu-16.04_2nic\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ lrms_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ lrms_server, public_address, 0 ] }\n','{\"additional_description\": \"elastic cluster 2\", \"fe_instance_flavor\": \"medium\", \"wn_num\": \"1\", \"wn_instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b1df-bcd8-34bc-bc63-024283ff312a','2019-07-29 09:03:00','2019-07-29 09:08:50','c760e17e-b1df-11e9-a036-fa163e0663d5','ciaociaociaociaociaociaociaociaociaociaociaociao','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b1df-bcd8-34bc-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b1df-bcd8-34bc-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b1df-bcd8-34bc-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"instance_description\": \"ELIXIR-ITALY\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"additional_description\": \"ciaociaociaociaociaociaociaociaociaociaociaociao\", \"flavor\": \"galaxy-no-tools\", \"instance_flavor\": \"xlarge\", \"vault_secret_key\": \"secret\", \"version\": \"release_18.09\", \"vault_wrapping_token\": \"s.rzK3Eqdd3yUkrwom2GTjYqZH\", \"admin_email\": \"ma.tangaro@gmail.com\", \"storage_size\": \"500 GB\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/0943e8cf-7d89-4ddd-beef-35af22dbff28\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'0943e8cf-7d89-4ddd-beef-35af22dbff28','secret',''),('11e9b1e0-15b5-13f7-bc63-024283ff312a','2019-07-29 09:06:00','2019-07-29 09:06:00','','caao','CREATE_IN_PROGRESS','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b1e0-15b5-13f7-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b1e0-15b5-13f7-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b1e0-15b5-13f7-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"additional_description\": \"caao\", \"instance_flavor\": \"xlarge\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_encryption\": \"True\", \"vault_secret_key\": \"secret\", \"storage_size\": \"500 GB\", \"version\": \"release_18.09\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\", \"vault_wrapping_token\": \"s.CkW4rgYn0Y9jBpE0AyaC6TmI\", \"vault_secret_path\": \"20340b0b-c07f-46e0-a9c6-1f987ba9ff85/c453e498-c38b-4475-9af0-e7d4eae6ef2f\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'c453e498-c38b-4475-9af0-e7d4eae6ef2f','secret',NULL),('11e9b1e0-70bc-c266-bc63-024283ff312a','2019-07-29 09:08:00','2019-07-29 11:02:00','7a881560-b1e0-11e9-9be1-fa163e0663d5','Prova 1','CREATE_COMPLETE','{\"endpoint\": \"http://90.147.75.239/galaxy\", \"node_ip\": \"90.147.75.239\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b1e0-70bc-c266-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b1e0-70bc-c266-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b1e0-70bc-c266-bc63-024283ff312a/template\"}]','ba31317b-d8ac-4cc7-ab08-5b56bd51e085','provider-RECAS-BARI','http://90.147.75.239/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"additional_description\": \"Prova 1\", \"instance_flavor\": \"xlarge\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC/6WPXdus0Db8ADcKyy3eBHGHsEG2x2VLtk5jpP70nCtG5R4VE1nNKeb9ij3Z0seMpIydhY72zRRoIbcPBaquarnMK8LH4voJbe06TcqTCmHniQleNxeOshkzTpAPgNoEVv+JLhuHb6nDJ8Nc/5VMMgMw+sRpz7sCx8BqoqyCRuVzrvfQAkcjRKBrPDrox4iiX/uAx1sk81gt75EoIwXfOgnH56LoSxf4f4qBx7Jctz7MObdSvu+JYw+QxpxgR1iz2RKwZjk0vmIXoPRPxw+erKXJm5qWqFch6zGkruO/BDyN+Wi0AiEezhxD3BKWQ23uSPVHFE6GjpsjSqFFeHxTT federicozambelli@dhcp-160-167.celoria26-16000022-smfn_biodip.unimi.it\", \"storage_encryption\": \"True\", \"vault_secret_key\": \"secret\", \"storage_size\": \"500 GB\", \"version\": \"release_18.09\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"federico.zambelli@gmail.com\", \"flavor\": \"galaxy-epigen\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\", \"vault_wrapping_token\": \"s.zez6watQ0EofQE8uhyOgDCBB\", \"vault_secret_path\": \"ba31317b-d8ac-4cc7-ab08-5b56bd51e085/9d7698d4-f5ad-4f0e-9a11-0d32c64cd96b\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',1,'9d7698d4-f5ad-4f0e-9a11-0d32c64cd96b','secret',''),('11e9b1ee-f4e7-de82-bc63-024283ff312a','2019-07-29 10:52:00','2019-07-29 12:37:33','fbfeffec-b1ee-11e9-9be1-fa163e0663d5','express','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.67/galaxy\", \"node_ip\": \"90.147.75.67\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b1ee-f4e7-de82-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b1ee-f4e7-de82-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b1ee-f4e7-de82-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.67/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n  #- indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine from a VM image (FAST).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"additional_description\": \"express\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b1fd-a2d4-fbfa-bc63-024283ff312a','2019-07-29 12:37:00','2019-07-29 13:36:19','','express cluster test 1','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b1fd-a2d4-fbfa-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b1fd-a2d4-fbfa-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b1fd-a2d4-fbfa-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy from scratch with cluster support (SLOW).\n  The basic configuration includes CentOS 7, SLURM, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    wn_num:\n      type: integer\n      description: Number of WNs in the cluster\n      default: 2\n      required: yes\n    fe_instance_flavor:\n      type: string\n      description: front end flavor (num_cpu, memory, disk)\n      default: small\n    wn_instance_flavor:\n      type: string\n      description: worker nodes flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB\n    hybrid:\n      type: boolean\n      description: Flag to specify that this cluster will work in an hybrid environment\n      default: false\n      required: false\n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"ELIXIR-ITALY\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n\n  node_templates:\n\n    galaxy_portal:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: lrms_front_end\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy_portal\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy_portal\n        - dependency: galaxy_tools\n\n    lrms_front_end:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Slurm\n      properties:\n        wn_ips: { get_attribute: [ lrms_wn, private_address ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_server\n\n    lrms_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            dns_name: slurmserver\n            network_name: PUBLIC\n            ports:\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        host:\n          properties:\n            instance_type: { get_input: fe_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: centos-7_2nic\n            #image: ubuntu-16.04-vmi\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n    wn_node:\n      type: tosca.nodes.indigo.LRMS.WorkerNode.Slurm\n      properties:\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        public_front_end_ip: { get_attribute: [ lrms_server, public_address, 0 ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: galaxy_portal\n\n    galaxy_wn:\n      type: tosca.nodes.indigo.GalaxyWnCvmfsReferenceData\n      properties:\n        export_dir: { get_input: export_dir }\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        flavor: { get_input: flavor }\n        version: { get_input: version }\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: wn_node\n\n    lrms_wn:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        scalable:\n          properties:\n            count: { get_input: wn_num }\n        host:\n          properties:\n            instance_type: { get_input: wn_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: centos-7_2nic\n            #image: ubuntu-16.04-vmi\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ lrms_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ lrms_server, public_address, 0 ] }\n','{\"additional_description\": \"express cluster test 1\", \"fe_instance_flavor\": \"medium\", \"wn_num\": \"1\", \"wn_instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b1ff-78c4-05e9-bc63-024283ff312a','2019-07-29 12:50:00','2019-07-29 14:36:21','822382ae-b1ff-11e9-b39a-fa163e0663d5','GDC dashboard test','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.86/galaxy\", \"node_ip\": \"90.147.75.86\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b1ff-78c4-05e9-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b1ff-78c4-05e9-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b1ff-78c4-05e9-bc63-024283ff312a/template\"}]','c0b907df-43a3-4c8a-952a-2b5ca56ec43e','provider-RECAS-BARI','http://90.147.75.86/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"additional_description\": \"GDC dashboard test\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDrm8mxOuqwP5XTHf685V9rqRXXg41F4isJvRr4h3MPDs8PgqZBzzjxEFyGpJ/Rgg4ACesGBZy+CbVVGtOveltKvgkpzyHIrh+vMay9z82eK2LMZEfmEPgw1BHdRifPZ1Qb7Zmj1nRk1EMWoNvbBxEc3/MSorWb+2SVMs+42EZ7QxavBmsU7zNU0Nd0e1xiqJ00VDWMnXullp/ieR9M4/XsSlS3oqxsxkAbY3eQYVMsnh64oiRw3lpYBkPyNtC/VSL5Cqig3CMaiK9AW8FjP1GwwqoMjL0H0Mkr0fY8eSSQ9Tcy5AqyaiPn7tmG0fSeNOFwxGkTzrujqlCiOkRSM1Yj marco@MacBook-Pro-di-Marco.local\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"version\": \"release_18.09\", \"instance_description\": \"GDC\", \"admin_email\": \"pietro.mandreoli@gmail.com\", \"flavor\": \"galaxy-GDC_Somatic_Variant\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b1ff-9445-f47e-bc63-024283ff312a','2019-07-29 12:51:00','2019-07-29 14:35:50','9abbc0d8-b1ff-11e9-a036-fa163e0663d5','covacs dashboard test','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.87/galaxy\", \"node_ip\": \"90.147.75.87\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b1ff-9445-f47e-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b1ff-9445-f47e-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b1ff-9445-f47e-bc63-024283ff312a/template\"}]','c0b907df-43a3-4c8a-952a-2b5ca56ec43e','provider-RECAS-BARI','http://90.147.75.87/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"additional_description\": \"covacs dashboard test\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDrm8mxOuqwP5XTHf685V9rqRXXg41F4isJvRr4h3MPDs8PgqZBzzjxEFyGpJ/Rgg4ACesGBZy+CbVVGtOveltKvgkpzyHIrh+vMay9z82eK2LMZEfmEPgw1BHdRifPZ1Qb7Zmj1nRk1EMWoNvbBxEc3/MSorWb+2SVMs+42EZ7QxavBmsU7zNU0Nd0e1xiqJ00VDWMnXullp/ieR9M4/XsSlS3oqxsxkAbY3eQYVMsnh64oiRw3lpYBkPyNtC/VSL5Cqig3CMaiK9AW8FjP1GwwqoMjL0H0Mkr0fY8eSSQ9Tcy5AqyaiPn7tmG0fSeNOFwxGkTzrujqlCiOkRSM1Yj marco@MacBook-Pro-di-Marco.local\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"version\": \"release_18.09\", \"instance_description\": \"covacs\", \"admin_email\": \"pietro.mandreoli@gmail.com\", \"flavor\": \"galaxy-CoVaCS\", \"refdata_cvmfs_repository_name\": \"elixir-italy.covacs.refdata\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b206-3c20-ef8d-bc63-024283ff312a','2019-07-29 13:39:00','2019-07-29 14:23:39','','galaxy express cluster 2','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b206-3c20-ef8d-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b206-3c20-ef8d-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b206-3c20-ef8d-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy from scratch with cluster support (SLOW).\n  The basic configuration includes CentOS 7, SLURM, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    wn_num:\n      type: integer\n      description: Number of WNs in the cluster\n      default: 2\n      required: yes\n    fe_instance_flavor:\n      type: string\n      description: front end flavor (num_cpu, memory, disk)\n      default: small\n    wn_instance_flavor:\n      type: string\n      description: worker nodes flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB\n    hybrid:\n      type: boolean\n      description: Flag to specify that this cluster will work in an hybrid environment\n      default: false\n      required: false\n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"ELIXIR-ITALY\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n\n  node_templates:\n\n    galaxy_portal:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: lrms_front_end\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy_portal\n\n    lrms_front_end:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Slurm\n      properties:\n        wn_ips: { get_attribute: [ lrms_wn, private_address ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_server\n\n    lrms_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            dns_name: slurmserver\n            network_name: PUBLIC\n            ports:\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        host:\n          properties:\n            instance_type: { get_input: fe_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: centos-7_2nic\n            #image: ubuntu-16.04-vmi\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n    wn_node:\n      type: tosca.nodes.indigo.LRMS.WorkerNode.Slurm\n      properties:\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        public_front_end_ip: { get_attribute: [ lrms_server, public_address, 0 ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: galaxy_portal\n\n    galaxy_wn:\n      type: tosca.nodes.indigo.GalaxyWnCvmfsReferenceData\n      properties:\n        export_dir: { get_input: export_dir }\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        flavor: { get_input: flavor }\n        version: { get_input: version }\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: wn_node\n\n    lrms_wn:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        scalable:\n          properties:\n            count: { get_input: wn_num }\n        host:\n          properties:\n            instance_type: { get_input: wn_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: centos-7_2nic\n            #image: ubuntu-16.04-vmi\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ lrms_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ lrms_server, public_address, 0 ] }\n','{\"additional_description\": \"galaxy express cluster 2\", \"fe_instance_flavor\": \"medium\", \"wn_num\": \"1\", \"wn_instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b20c-9a9f-1820-bc63-024283ff312a','2019-07-29 14:24:00','2019-07-29 14:24:00','','express cluster test 3','CREATE_FAILED','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b20c-9a9f-1820-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b20c-9a9f-1820-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b20c-9a9f-1820-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy from scratch with cluster support (SLOW).\n  The basic configuration includes CentOS 7, SLURM, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    wn_num:\n      type: integer\n      description: Number of WNs in the cluster\n      default: 2\n      required: yes\n    fe_instance_flavor:\n      type: string\n      description: front end flavor (num_cpu, memory, disk)\n      default: small\n    wn_instance_flavor:\n      type: string\n      description: worker nodes flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB\n    hybrid:\n      type: boolean\n      description: Flag to specify that this cluster will work in an hybrid environment\n      default: false\n      required: false\n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"ELIXIR-ITALY\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n\n  node_templates:\n\n    galaxy_portal:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: lrms_front_end\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy_portal\n\n    lrms_front_end:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Slurm\n      properties:\n        wn_ips: { get_attribute: [ lrms_wn, private_address ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_server\n\n    lrms_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            dns_name: slurmserver\n            network_name: PUBLIC\n            ports:\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        host:\n          properties:\n            instance_type: { get_input: fe_instance_flavor }\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n    wn_node:\n      type: tosca.nodes.indigo.LRMS.WorkerNode.Slurm\n      properties:\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        public_front_end_ip: { get_attribute: [ lrms_server, public_address, 0 ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: galaxy_portal\n\n    galaxy_wn:\n      type: tosca.nodes.indigo.GalaxyWnCvmfsReferenceData\n      properties:\n        export_dir: { get_input: export_dir }\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        flavor: { get_input: flavor }\n        version: { get_input: version }\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: wn_node\n\n    lrms_wn:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        scalable:\n          properties:\n            count: { get_input: wn_num }\n        host:\n          properties:\n            instance_type: { get_input: wn_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: centos-7_2nic\n            #image: ubuntu-16.04-vmi\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ lrms_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ lrms_server, public_address, 0 ] }\n','{\"additional_description\": \"express cluster test 3\", \"fe_instance_flavor\": \"medium\", \"wn_num\": \"1\", \"wn_instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','','No cloud providers available to deploy'),('11e9b20f-0c53-9af8-bc63-024283ff312a','2019-07-29 14:42:00','2019-07-30 10:18:27','16101086-b20f-11e9-bb42-fa163e0663d5','workbench dashboard test','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.102.125/galaxy\", \"node_ip\": \"90.147.102.125\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b20f-0c53-9af8-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b20f-0c53-9af8-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b20f-0c53-9af8-bc63-024283ff312a/template\"}]','c0b907df-43a3-4c8a-952a-2b5ca56ec43e','provider-RECAS-BARI','http://90.147.102.125/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"additional_description\": \"workbench dashboard test\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDrm8mxOuqwP5XTHf685V9rqRXXg41F4isJvRr4h3MPDs8PgqZBzzjxEFyGpJ/Rgg4ACesGBZy+CbVVGtOveltKvgkpzyHIrh+vMay9z82eK2LMZEfmEPgw1BHdRifPZ1Qb7Zmj1nRk1EMWoNvbBxEc3/MSorWb+2SVMs+42EZ7QxavBmsU7zNU0Nd0e1xiqJ00VDWMnXullp/ieR9M4/XsSlS3oqxsxkAbY3eQYVMsnh64oiRw3lpYBkPyNtC/VSL5Cqig3CMaiK9AW8FjP1GwwqoMjL0H0Mkr0fY8eSSQ9Tcy5AqyaiPn7tmG0fSeNOFwxGkTzrujqlCiOkRSM1Yj marco@MacBook-Pro-di-Marco.local\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"workbench\", \"admin_email\": \"pietro.mandreoli@gmail.com\", \"flavor\": \"galaxy-rna-workbench\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\"}','{\"keepLastAttempt\": \"false\"}',0,1,0,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b20f-ba16-f1bb-bc63-024283ff312a','2019-07-29 14:47:00','2019-07-29 15:13:00','c167d46e-b20f-11e9-8af8-fa163e0663d5','galaxy express cluster test 4','CREATE_FAILED','{}','DEPLOYER','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b20f-ba16-f1bb-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b20f-ba16-f1bb-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b20f-ba16-f1bb-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy from scratch with cluster support (SLOW).\n  The basic configuration includes CentOS 7, SLURM, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    wn_num:\n      type: integer\n      description: Number of WNs in the cluster\n      default: 2\n      required: yes\n    fe_instance_flavor:\n      type: string\n      description: front end flavor (num_cpu, memory, disk)\n      default: small\n    wn_instance_flavor:\n      type: string\n      description: worker nodes flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB\n    hybrid:\n      type: boolean\n      description: Flag to specify that this cluster will work in an hybrid environment\n      default: false\n      required: false\n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"ELIXIR-ITALY\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n\n  node_templates:\n\n    galaxy_portal:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: lrms_front_end\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy_portal\n\n    lrms_front_end:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Slurm\n      properties:\n        wn_ips: { get_attribute: [ lrms_wn, private_address ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_server\n\n    lrms_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            dns_name: slurmserver\n            network_name: PUBLIC\n            ports:\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        host:\n          properties:\n            instance_type: { get_input: fe_instance_flavor }\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n    wn_node:\n      type: tosca.nodes.indigo.LRMS.WorkerNode.Slurm\n      properties:\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        public_front_end_ip: { get_attribute: [ lrms_server, public_address, 0 ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: galaxy_portal\n\n    galaxy_wn:\n      type: tosca.nodes.indigo.GalaxyWnCvmfsReferenceData\n      properties:\n        export_dir: { get_input: export_dir }\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        flavor: { get_input: flavor }\n        version: { get_input: version }\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: wn_node\n\n    lrms_wn:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        scalable:\n          properties:\n            count: { get_input: wn_num }\n        host:\n          properties:\n            instance_type: { get_input: wn_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: centos-7_2nic\n            #image: ubuntu-16.04-vmi\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ lrms_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ lrms_server, public_address, 0 ] }\n','{\"additional_description\": \"galaxy express cluster test 4\", \"fe_instance_flavor\": \"medium\", \"wn_num\": \"1\", \"wn_instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','','Retries on cloud providers exhausted'),('11e9b211-abf3-7d61-bc63-024283ff312a','2019-07-29 15:00:00','2019-07-30 07:07:46','','docker rna','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b211-abf3-7d61-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b211-abf3-7d61-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b211-abf3-7d61-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy official docker image  on a single Virtual Machine.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: ma.tangaro@gmail.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: GALAXY_ADMIN_API_KEY\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: release_18.05\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: \'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDrm8mxOuqwP5XTHf685V9rqRXXg41F4isJvRr4h3MPDs8PgqZBzzjxEFyGpJ/Rgg4ACesGBZy+CbVVGtOveltKvgkpzyHIrh+vMay9z82eK2LMZEfmEPgw1BHdRifPZ1Qb7Zmj1nRk1EMWoNvbBxEc3/MSorWb+2SVMs+42EZ7QxavBmsU7zNU0Nd0e1xiqJ00VDWMnXullp/ieR9M4/XsSlS3oqxsxkAbY3eQYVMsnh64oiRw3lpYBkPyNtC/VSL5Cqig3CMaiK9AW8FjP1GwwqoMjL0H0Mkr0fY8eSSQ9Tcy5AqyaiPn7tmG0fSeNOFwxGkTzrujqlCiOkRSM1Yj marco@MacBook-Pro-di-Marco.local\'\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"bgruening/galaxy-stable\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalDocker\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            #private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: ubuntu-16.04-vmi \n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ] ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"additional_description\": \"docker rna\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"bgruening/galaxy-rna-workbench:19.01\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b215-4d81-a481-bc63-024283ff312a','2019-07-29 15:26:00','2019-07-30 07:08:17','','cluster test 5','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b215-4d81-a481-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b215-4d81-a481-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b215-4d81-a481-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy from scratch with cluster support (SLOW).\n  The basic configuration includes CentOS 7, SLURM, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    wn_num:\n      type: integer\n      description: Number of WNs in the cluster\n      default: 2\n      required: yes\n    fe_instance_flavor:\n      type: string\n      description: front end flavor (num_cpu, memory, disk)\n      default: small\n    wn_instance_flavor:\n      type: string\n      description: worker nodes flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB\n    hybrid:\n      type: boolean\n      description: Flag to specify that this cluster will work in an hybrid environment\n      default: false\n      required: false\n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"ELIXIR-ITALY\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n\n  node_templates:\n\n    galaxy_portal:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: lrms_front_end\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy_portal\n\n    lrms_front_end:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Slurm\n      properties:\n        wn_ips: { get_attribute: [ lrms_wn, private_address ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_server\n\n    lrms_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            dns_name: slurmserver\n            network_name: PUBLIC\n            ports:\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        host:\n          properties:\n            instance_type: { get_input: fe_instance_flavor }\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n    wn_node:\n      type: tosca.nodes.indigo.LRMS.WorkerNode.Slurm\n      properties:\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        public_front_end_ip: { get_attribute: [ lrms_server, public_address, 0 ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: galaxy_portal\n\n    galaxy_wn:\n      type: tosca.nodes.indigo.GalaxyWnCvmfsReferenceData\n      properties:\n        export_dir: { get_input: export_dir }\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        flavor: { get_input: flavor }\n        version: { get_input: version }\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: wn_node\n\n    lrms_wn:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        scalable:\n          properties:\n            count: { get_input: wn_num }\n        host:\n          properties:\n            instance_type: { get_input: wn_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: centos-7_2nic\n            #image: ubuntu-16.04-vmi\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ lrms_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ lrms_server, public_address, 0 ] }\n','{\"additional_description\": \"cluster test 5\", \"fe_instance_flavor\": \"medium\", \"wn_num\": \"1\", \"wn_instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b298-f9ac-1c0b-bc63-024283ff312a','2019-07-30 07:09:00','2019-07-30 08:22:41','','xpress cluster 6','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b298-f9ac-1c0b-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b298-f9ac-1c0b-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b298-f9ac-1c0b-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy from scratch with cluster support (SLOW).\n  The basic configuration includes CentOS 7, SLURM, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    wn_num:\n      type: integer\n      description: Number of WNs in the cluster\n      default: 2\n      required: yes\n    fe_instance_flavor:\n      type: string\n      description: front end flavor (num_cpu, memory, disk)\n      default: small\n    wn_instance_flavor:\n      type: string\n      description: worker nodes flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB\n    hybrid:\n      type: boolean\n      description: Flag to specify that this cluster will work in an hybrid environment\n      default: false\n      required: false\n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"ELIXIR-ITALY\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n\n  node_templates:\n\n    galaxy_portal:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: lrms_front_end\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy_portal\n\n    lrms_front_end:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Slurm\n      properties:\n        wn_ips: { get_attribute: [ lrms_wn, private_address ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_server\n\n    lrms_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            dns_name: slurmserver\n            network_name: PUBLIC\n            ports:\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        host:\n          properties:\n            instance_type: { get_input: fe_instance_flavor }\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n    wn_node:\n      type: tosca.nodes.indigo.LRMS.WorkerNode.Slurm\n      properties:\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        public_front_end_ip: { get_attribute: [ lrms_server, public_address, 0 ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: galaxy_portal\n\n    galaxy_wn:\n      type: tosca.nodes.indigo.GalaxyWnCvmfsReferenceData\n      properties:\n        export_dir: { get_input: export_dir }\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        flavor: { get_input: flavor }\n        version: { get_input: version }\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: wn_node\n\n    lrms_wn:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        scalable:\n          properties:\n            count: { get_input: wn_num }\n        host:\n          properties:\n            instance_type: { get_input: wn_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: centos-7_2nic\n            #image: ubuntu-16.04-vmi\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ lrms_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ lrms_server, public_address, 0 ] }\n','{\"additional_description\": \"xpress cluster 6\", \"fe_instance_flavor\": \"medium\", \"wn_num\": \"1\", \"wn_instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b299-1632-a95f-bc63-024283ff312a','2019-07-30 07:10:00','2019-07-30 07:24:26','29d0db48-b299-11e9-bb42-fa163e0663d5','docker','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b299-1632-a95f-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b299-1632-a95f-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b299-1632-a95f-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy official docker image  on a single Virtual Machine.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: ma.tangaro@gmail.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: GALAXY_ADMIN_API_KEY\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: release_18.05\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: \'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDrm8mxOuqwP5XTHf685V9rqRXXg41F4isJvRr4h3MPDs8PgqZBzzjxEFyGpJ/Rgg4ACesGBZy+CbVVGtOveltKvgkpzyHIrh+vMay9z82eK2LMZEfmEPgw1BHdRifPZ1Qb7Zmj1nRk1EMWoNvbBxEc3/MSorWb+2SVMs+42EZ7QxavBmsU7zNU0Nd0e1xiqJ00VDWMnXullp/ieR9M4/XsSlS3oqxsxkAbY3eQYVMsnh64oiRw3lpYBkPyNtC/VSL5Cqig3CMaiK9AW8FjP1GwwqoMjL0H0Mkr0fY8eSSQ9Tcy5AqyaiPn7tmG0fSeNOFwxGkTzrujqlCiOkRSM1Yj marco@MacBook-Pro-di-Marco.local\'\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"bgruening/galaxy-stable\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalDocker\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            #private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: ubuntu-16.04-vmi \n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ] ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"additional_description\": \"docker\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"bgruening/galaxy-stable:19.01\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b29a-8cbc-7767-bc63-024283ff312a','2019-07-30 07:20:00','2019-07-30 08:24:11','98846022-b29a-11e9-9be1-fa163e0663d5','docker 2','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b29a-8cbc-7767-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b29a-8cbc-7767-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b29a-8cbc-7767-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy official docker image  on a single Virtual Machine.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: ma.tangaro@gmail.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: GALAXY_ADMIN_API_KEY\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: release_18.05\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: \'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDrm8mxOuqwP5XTHf685V9rqRXXg41F4isJvRr4h3MPDs8PgqZBzzjxEFyGpJ/Rgg4ACesGBZy+CbVVGtOveltKvgkpzyHIrh+vMay9z82eK2LMZEfmEPgw1BHdRifPZ1Qb7Zmj1nRk1EMWoNvbBxEc3/MSorWb+2SVMs+42EZ7QxavBmsU7zNU0Nd0e1xiqJ00VDWMnXullp/ieR9M4/XsSlS3oqxsxkAbY3eQYVMsnh64oiRw3lpYBkPyNtC/VSL5Cqig3CMaiK9AW8FjP1GwwqoMjL0H0Mkr0fY8eSSQ9Tcy5AqyaiPn7tmG0fSeNOFwxGkTzrujqlCiOkRSM1Yj marco@MacBook-Pro-di-Marco.local\'\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"bgruening/galaxy-stable\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalDocker\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            #private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: ubuntu-16.04-vmi \n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ] ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"additional_description\": \"docker 2\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"bgruening/galaxy-rna-workbench:19.01\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b29e-8a68-ed88-bc63-024283ff312a','2019-07-30 07:49:00','2019-07-31 07:37:40','933aef74-b29e-11e9-b39a-fa163e0663d5','cluster ','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.170.203/galaxy\", \"node_ip\": \"90.147.170.203\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b29e-8a68-ed88-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b29e-8a68-ed88-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b29e-8a68-ed88-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.170.203/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy from scratch with cluster support (SLOW).\n  The basic configuration includes CentOS 7, SLURM, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    wn_num:\n      type: integer\n      description: Number of WNs in the cluster\n      default: 2\n      required: yes\n    fe_instance_flavor:\n      type: string\n      description: front end flavor (num_cpu, memory, disk)\n      default: small\n    wn_instance_flavor:\n      type: string\n      description: worker nodes flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB\n    hybrid:\n      type: boolean\n      description: Flag to specify that this cluster will work in an hybrid environment\n      default: false\n      required: false\n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"ELIXIR-ITALY\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n\n  node_templates:\n\n    galaxy_portal:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: lrms_front_end\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy_portal\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy_portal\n        - dependency: galaxy_tools\n\n    lrms_front_end:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Slurm\n      properties:\n        wn_ips: { get_attribute: [ lrms_wn, private_address ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_server\n\n    lrms_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            dns_name: slurmserver\n            network_name: PUBLIC\n            ports:\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        host:\n          properties:\n            instance_type: { get_input: fe_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: centos-7_2nic\n            #image: ubuntu-16.04-vmi\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n    wn_node:\n      type: tosca.nodes.indigo.LRMS.WorkerNode.Slurm\n      properties:\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        public_front_end_ip: { get_attribute: [ lrms_server, public_address, 0 ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: galaxy_portal\n\n    galaxy_wn:\n      type: tosca.nodes.indigo.GalaxyWnCvmfsReferenceData\n      properties:\n        export_dir: { get_input: export_dir }\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        flavor: { get_input: flavor }\n        version: { get_input: version }\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: wn_node\n\n    lrms_wn:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        scalable:\n          properties:\n            count: { get_input: wn_num }\n        host:\n          properties:\n            instance_type: { get_input: wn_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: centos-7_2nic\n            #image: ubuntu-16.04-vmi\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ lrms_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ lrms_server, public_address, 0 ] }\n','{\"additional_description\": \"cluster \", \"fe_instance_flavor\": \"medium\", \"wn_num\": \"1\", \"wn_instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-no-tools\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b29e-9755-08b8-bc63-024283ff312a','2019-07-30 07:49:00','2019-07-30 08:22:14','','xpress cluster 3','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b29e-9755-08b8-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b29e-9755-08b8-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b29e-9755-08b8-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy from scratch with cluster support (SLOW).\n  The basic configuration includes CentOS 7, SLURM, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    wn_num:\n      type: integer\n      description: Number of WNs in the cluster\n      default: 2\n      required: yes\n    fe_instance_flavor:\n      type: string\n      description: front end flavor (num_cpu, memory, disk)\n      default: small\n    wn_instance_flavor:\n      type: string\n      description: worker nodes flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB\n    hybrid:\n      type: boolean\n      description: Flag to specify that this cluster will work in an hybrid environment\n      default: false\n      required: false\n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"ELIXIR-ITALY\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n\n  node_templates:\n\n    galaxy_portal:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: lrms_front_end\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy_portal\n\n    lrms_front_end:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Slurm\n      properties:\n        wn_ips: { get_attribute: [ lrms_wn, private_address ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_server\n\n    lrms_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            dns_name: slurmserver\n            network_name: PUBLIC\n            ports:\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        host:\n          properties:\n            instance_type: { get_input: fe_instance_flavor }\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n    wn_node:\n      type: tosca.nodes.indigo.LRMS.WorkerNode.Slurm\n      properties:\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        public_front_end_ip: { get_attribute: [ lrms_server, public_address, 0 ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: galaxy_portal\n\n    galaxy_wn:\n      type: tosca.nodes.indigo.GalaxyWnCvmfsReferenceData\n      properties:\n        export_dir: { get_input: export_dir }\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        flavor: { get_input: flavor }\n        version: { get_input: version }\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: wn_node\n\n    lrms_wn:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        scalable:\n          properties:\n            count: { get_input: wn_num }\n        host:\n          properties:\n            instance_type: { get_input: wn_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: centos-7_2nic\n            #image: ubuntu-16.04-vmi\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ lrms_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ lrms_server, public_address, 0 ] }\n','{\"additional_description\": \"xpress cluster 3\", \"fe_instance_flavor\": \"medium\", \"wn_num\": \"1\", \"wn_instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"true\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b2a3-0675-d64c-bc63-024283ff312a','2019-07-30 08:21:00','2019-07-30 09:57:14','0c2d0af8-b2a3-11e9-a036-fa163e0663d5','docker 2','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.170.217\", \"node_ip\": \"90.147.170.217\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b2a3-0675-d64c-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b2a3-0675-d64c-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b2a3-0675-d64c-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.170.217','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy official docker image  on a single Virtual Machine.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: ma.tangaro@gmail.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: GALAXY_ADMIN_API_KEY\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: release_18.05\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: \'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDrm8mxOuqwP5XTHf685V9rqRXXg41F4isJvRr4h3MPDs8PgqZBzzjxEFyGpJ/Rgg4ACesGBZy+CbVVGtOveltKvgkpzyHIrh+vMay9z82eK2LMZEfmEPgw1BHdRifPZ1Qb7Zmj1nRk1EMWoNvbBxEc3/MSorWb+2SVMs+42EZ7QxavBmsU7zNU0Nd0e1xiqJ00VDWMnXullp/ieR9M4/XsSlS3oqxsxkAbY3eQYVMsnh64oiRw3lpYBkPyNtC/VSL5Cqig3CMaiK9AW8FjP1GwwqoMjL0H0Mkr0fY8eSSQ9Tcy5AqyaiPn7tmG0fSeNOFwxGkTzrujqlCiOkRSM1Yj marco@MacBook-Pro-di-Marco.local\'\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"bgruening/galaxy-stable\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalDocker\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            #private_ip: false\n            ports:\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: ubuntu-16.04-vmi \n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ] ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"additional_description\": \"docker 2\", \"instance_flavor\": \"small\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"vault_secret_key\": \"secret\", \"storage_size\": \"100 GB\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"bgruening/galaxy-rna-workbench:19.01\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b2a3-302d-28e5-bc63-024283ff312a','2019-07-30 08:22:00','2019-07-30 08:48:00','36d5dba4-b2a3-11e9-9be1-fa163e0663d5','xpr cluster','CREATE_FAILED','{}','DEPLOYER','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b2a3-302d-28e5-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b2a3-302d-28e5-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b2a3-302d-28e5-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy from scratch with cluster support (SLOW).\n  The basic configuration includes CentOS 7, SLURM, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    wn_num:\n      type: integer\n      description: Number of WNs in the cluster\n      default: 2\n      required: yes\n    fe_instance_flavor:\n      type: string\n      description: front end flavor (num_cpu, memory, disk)\n      default: small\n    wn_instance_flavor:\n      type: string\n      description: worker nodes flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB\n    hybrid:\n      type: boolean\n      description: Flag to specify that this cluster will work in an hybrid environment\n      default: false\n      required: false\n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"ELIXIR-ITALY\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n\n  node_templates:\n\n    galaxy_portal:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: lrms_front_end\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy_portal\n\n    lrms_front_end:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Slurm\n      properties:\n        wn_ips: { get_attribute: [ lrms_wn, private_address ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_server\n\n    lrms_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            dns_name: slurmserver\n            network_name: PUBLIC\n            ports:\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        host:\n          properties:\n            instance_type: { get_input: fe_instance_flavor }\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n    wn_node:\n      type: tosca.nodes.indigo.LRMS.WorkerNode.Slurm\n      properties:\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        public_front_end_ip: { get_attribute: [ lrms_server, public_address, 0 ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: galaxy_portal\n\n    galaxy_wn:\n      type: tosca.nodes.indigo.GalaxyWnCvmfsReferenceData\n      properties:\n        export_dir: { get_input: export_dir }\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        flavor: { get_input: flavor }\n        version: { get_input: version }\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: wn_node\n\n    lrms_wn:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        scalable:\n          properties:\n            count: { get_input: wn_num }\n        host:\n          properties:\n            instance_type: { get_input: wn_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: centos-7_2nic\n            #image: ubuntu-16.04-vmi\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ lrms_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ lrms_server, public_address, 0 ] }\n','{\"additional_description\": \"xpr cluster\", \"fe_instance_flavor\": \"medium\", \"wn_num\": \"1\", \"wn_instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"true\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','','Retries on cloud providers exhausted'),('11e9b2ac-2ac7-8adc-bc63-024283ff312a','2019-07-30 09:26:00','2019-07-30 10:14:57','','xpr 2','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b2ac-2ac7-8adc-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b2ac-2ac7-8adc-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b2ac-2ac7-8adc-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy from scratch with cluster support (SLOW).\n  The basic configuration includes CentOS 7, SLURM, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    wn_num:\n      type: integer\n      description: Number of WNs in the cluster\n      default: 2\n      required: yes\n    fe_instance_flavor:\n      type: string\n      description: front end flavor (num_cpu, memory, disk)\n      default: small\n    wn_instance_flavor:\n      type: string\n      description: worker nodes flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB\n    hybrid:\n      type: boolean\n      description: Flag to specify that this cluster will work in an hybrid environment\n      default: false\n      required: false\n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"ELIXIR-ITALY\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n\n  node_templates:\n\n    galaxy_portal:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: lrms_front_end\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy_portal\n\n    lrms_front_end:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Slurm\n      properties:\n        wn_ips: { get_attribute: [ lrms_wn, private_address ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_server\n\n    lrms_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            dns_name: slurmserver\n            network_name: PUBLIC\n            ports:\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        host:\n          properties:\n            instance_type: { get_input: fe_instance_flavor }\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n    wn_node:\n      type: tosca.nodes.indigo.LRMS.WorkerNode.Slurm\n      properties:\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        public_front_end_ip: { get_attribute: [ lrms_server, public_address, 0 ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: galaxy_portal\n\n    galaxy_wn:\n      type: tosca.nodes.indigo.GalaxyWnCvmfsReferenceData\n      properties:\n        export_dir: { get_input: export_dir }\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        flavor: { get_input: flavor }\n        version: { get_input: version }\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: wn_node\n\n    lrms_wn:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        scalable:\n          properties:\n            count: { get_input: wn_num }\n        host:\n          properties:\n            instance_type: { get_input: wn_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: centos-7_2nic\n            #image: ubuntu-16.04-vmi\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ lrms_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ lrms_server, public_address, 0 ] }\n','{\"additional_description\": \"xpr 2\", \"fe_instance_flavor\": \"medium\", \"wn_num\": \"1\", \"wn_instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"true\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b2b3-5d0d-6605-bc63-024283ff312a','2019-07-30 10:18:00','2019-07-30 11:20:00','677a11a2-b2b3-11e9-9be1-fa163e0663d5','covacs 18.09 test','CREATE_COMPLETE','{\"endpoint\": \"http://90.147.102.165/galaxy\", \"node_ip\": \"90.147.102.165\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b2b3-5d0d-6605-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b2b3-5d0d-6605-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b2b3-5d0d-6605-bc63-024283ff312a/template\"}]','c0b907df-43a3-4c8a-952a-2b5ca56ec43e','provider-RECAS-BARI','http://90.147.102.165/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine installing it from scratch (SLOW).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalAndStorage\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_tools:\n      type: tosca.nodes.indigo.GalaxyShedTool\n      properties:\n        flavor: { get_input: flavor }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n      requirements:\n        - host: galaxy\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy\n        - dependency: galaxy_tools\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: ubuntu-16.04-vmi\n            #image: centos-7_2nic\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"additional_description\": \"covacs 18.09 test\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDrm8mxOuqwP5XTHf685V9rqRXXg41F4isJvRr4h3MPDs8PgqZBzzjxEFyGpJ/Rgg4ACesGBZy+CbVVGtOveltKvgkpzyHIrh+vMay9z82eK2LMZEfmEPgw1BHdRifPZ1Qb7Zmj1nRk1EMWoNvbBxEc3/MSorWb+2SVMs+42EZ7QxavBmsU7zNU0Nd0e1xiqJ00VDWMnXullp/ieR9M4/XsSlS3oqxsxkAbY3eQYVMsnh64oiRw3lpYBkPyNtC/VSL5Cqig3CMaiK9AW8FjP1GwwqoMjL0H0Mkr0fY8eSSQ9Tcy5AqyaiPn7tmG0fSeNOFwxGkTzrujqlCiOkRSM1Yj marco@MacBook-Pro-di-Marco.local\", \"vault_secret_key\": \"secret\", \"storage_size\": \"50 GB\", \"version\": \"release_18.09\", \"instance_description\": \"covacs 18.09\", \"admin_email\": \"pietro.mandreoli@gmail.com\", \"flavor\": \"galaxy-CoVaCS\", \"refdata_cvmfs_repository_name\": \"elixir-italy.covacs.refdata\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b2cc-28f9-9b5a-bc63-024283ff312a','2019-07-30 13:15:00','2019-07-30 13:54:03','','xpr 4','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b2cc-28f9-9b5a-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b2cc-28f9-9b5a-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b2cc-28f9-9b5a-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy from scratch with cluster support (SLOW).\n  The basic configuration includes CentOS 7, SLURM, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    wn_num:\n      type: integer\n      description: Number of WNs in the cluster\n      default: 2\n      required: yes\n    fe_instance_flavor:\n      type: string\n      description: front end flavor (num_cpu, memory, disk)\n      default: small\n    wn_instance_flavor:\n      type: string\n      description: worker nodes flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB\n    hybrid:\n      type: boolean\n      description: Flag to specify that this cluster will work in an hybrid environment\n      default: false\n      required: false\n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"ELIXIR-ITALY\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n\n  node_templates:\n\n    galaxy_portal:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: lrms_front_end\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy_portal\n\n    lrms_front_end:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Slurm\n      properties:\n        wn_ips: { get_attribute: [ lrms_wn, private_address ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_server\n\n    lrms_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            dns_name: slurmserver\n            network_name: PUBLIC\n            ports:\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        host:\n          properties:\n            instance_type: { get_input: fe_instance_flavor }\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n    wn_node:\n      type: tosca.nodes.indigo.LRMS.WorkerNode.Slurm\n      properties:\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        public_front_end_ip: { get_attribute: [ lrms_server, public_address, 0 ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: galaxy_portal\n\n    galaxy_wn:\n      type: tosca.nodes.indigo.GalaxyWnCvmfsReferenceData\n      properties:\n        export_dir: { get_input: export_dir }\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        flavor: { get_input: flavor }\n        version: { get_input: version }\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: wn_node\n\n    lrms_wn:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        scalable:\n          properties:\n            count: { get_input: wn_num }\n        host:\n          properties:\n            instance_type: { get_input: wn_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: centos-7_2nic\n            #image: ubuntu-16.04-vmi\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ lrms_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ lrms_server, public_address, 0 ] }\n','{\"additional_description\": \"xpr 4\", \"fe_instance_flavor\": \"medium\", \"wn_num\": \"1\", \"wn_instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b2d1-ce9d-60a2-bc63-024283ff312a','2019-07-30 13:56:00','2019-07-30 14:31:15','','xpr 6','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b2d1-ce9d-60a2-bc63-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b2d1-ce9d-60a2-bc63-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b2d1-ce9d-60a2-bc63-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy from scratch with cluster support (SLOW).\n  The basic configuration includes CentOS 7, SLURM, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    wn_num:\n      type: integer\n      description: Number of WNs in the cluster\n      default: 2\n      required: yes\n    fe_instance_flavor:\n      type: string\n      description: front end flavor (num_cpu, memory, disk)\n      default: small\n    wn_instance_flavor:\n      type: string\n      description: worker nodes flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB\n    hybrid:\n      type: boolean\n      description: Flag to specify that this cluster will work in an hybrid environment\n      default: false\n      required: false\n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"ELIXIR-ITALY\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n\n  node_templates:\n\n    galaxy_portal:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: lrms_front_end\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy_portal\n\n    lrms_front_end:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Slurm\n      properties:\n        wn_ips: { get_attribute: [ lrms_wn, private_address ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_server\n\n    lrms_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            dns_name: slurmserver\n            network_name: PUBLIC\n            ports:\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        host:\n          properties:\n            instance_type: { get_input: fe_instance_flavor }\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n    wn_node:\n      type: tosca.nodes.indigo.LRMS.WorkerNode.Slurm\n      properties:\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        public_front_end_ip: { get_attribute: [ lrms_server, public_address, 0 ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: galaxy_portal\n\n    galaxy_wn:\n      type: tosca.nodes.indigo.GalaxyWnCvmfsReferenceData\n      properties:\n        export_dir: { get_input: export_dir }\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        flavor: { get_input: flavor }\n        version: { get_input: version }\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: wn_node\n\n    lrms_wn:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        scalable:\n          properties:\n            count: { get_input: wn_num }\n        host:\n          properties:\n            instance_type: { get_input: wn_instance_flavor }\n        os:\n          properties:\n            #image: centos-7-galaxy-base\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n            #image: centos-7_2nic\n            #image: ubuntu-16.04-vmi\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ lrms_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ lrms_server, public_address, 0 ] }\n','{\"additional_description\": \"xpr 6\", \"fe_instance_flavor\": \"medium\", \"wn_num\": \"1\", \"wn_instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b2d6-9920-31be-8c64-024283ff312a','2019-07-30 14:30:00','2019-07-31 07:37:40','a88d62d4-b2d6-11e9-a8ac-fa163e0663d5','xpr 6','DELETE_COMPLETE','{\"endpoint\": \"http://90.147.75.21/galaxy\", \"node_ip\": \"90.147.75.21\"}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b2d6-9920-31be-8c64-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b2d6-9920-31be-8c64-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b2d6-9920-31be-8c64-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','http://90.147.75.21/galaxy','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy from scratch with cluster support (SLOW).\n  The basic configuration includes CentOS 7, SLURM, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    wn_num:\n      type: integer\n      description: Number of WNs in the cluster\n      default: 2\n      required: yes\n    fe_instance_flavor:\n      type: string\n      description: front end flavor (num_cpu, memory, disk)\n      default: small\n    wn_instance_flavor:\n      type: string\n      description: worker nodes flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB\n    hybrid:\n      type: boolean\n      description: Flag to specify that this cluster will work in an hybrid environment\n      default: false\n      required: false\n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"ELIXIR-ITALY\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n\n  node_templates:\n\n    galaxy_portal:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: lrms_front_end\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy_portal\n\n    lrms_front_end:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Slurm\n      properties:\n        wn_ips: { get_attribute: [ lrms_wn, private_address ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_server\n\n    lrms_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            dns_name: slurmserver\n            network_name: PUBLIC\n            ports:\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        host:\n          properties:\n            instance_type: { get_input: fe_instance_flavor }\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n    wn_node:\n      type: tosca.nodes.indigo.LRMS.WorkerNode.Slurm\n      properties:\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        public_front_end_ip: { get_attribute: [ lrms_server, public_address, 0 ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: galaxy_portal\n\n    galaxy_wn:\n      type: tosca.nodes.indigo.GalaxyWnCvmfsReferenceData\n      properties:\n        export_dir: { get_input: export_dir }\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        flavor: { get_input: flavor }\n        version: { get_input: version }\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: wn_node\n\n    lrms_wn:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        scalable:\n          properties:\n            count: { get_input: wn_num }\n        host:\n          properties:\n            instance_type: { get_input: wn_instance_flavor }\n        os:\n          properties:\n            #image: centos-7-galaxy-base\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n            #image: centos-7_2nic\n            #image: ubuntu-16.04-vmi\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ lrms_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ lrms_server, public_address, 0 ] }\n','{\"additional_description\": \"xpr 6\", \"fe_instance_flavor\": \"medium\", \"wn_num\": \"1\", \"wn_instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b2d9-90a7-212f-8c64-024283ff312a','2019-07-30 14:51:00','2019-07-30 15:09:11','96b05a32-b2d9-11e9-b39a-fa163e0663d5','xpr different images','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b2d9-90a7-212f-8c64-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b2d9-90a7-212f-8c64-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b2d9-90a7-212f-8c64-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy from scratch with cluster support (SLOW).\n  The basic configuration includes CentOS 7, SLURM, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    wn_num:\n      type: integer\n      description: Number of WNs in the cluster\n      default: 2\n      required: yes\n    fe_instance_flavor:\n      type: string\n      description: front end flavor (num_cpu, memory, disk)\n      default: small\n    wn_instance_flavor:\n      type: string\n      description: worker nodes flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB\n    hybrid:\n      type: boolean\n      description: Flag to specify that this cluster will work in an hybrid environment\n      default: false\n      required: false\n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"ELIXIR-ITALY\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n\n  node_templates:\n\n    galaxy_portal:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: lrms_front_end\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy_portal\n\n    lrms_front_end:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Slurm\n      properties:\n        wn_ips: { get_attribute: [ lrms_wn, private_address ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_server\n\n    lrms_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            dns_name: slurmserver\n            network_name: PUBLIC\n            ports:\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        host:\n          properties:\n            instance_type: { get_input: fe_instance_flavor }\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n    wn_node:\n      type: tosca.nodes.indigo.LRMS.WorkerNode.Slurm\n      properties:\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        public_front_end_ip: { get_attribute: [ lrms_server, public_address, 0 ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: galaxy_portal\n\n    galaxy_wn:\n      type: tosca.nodes.indigo.GalaxyWnCvmfsReferenceData\n      properties:\n        export_dir: { get_input: export_dir }\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        flavor: { get_input: flavor }\n        version: { get_input: version }\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: wn_node\n\n    lrms_wn:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        scalable:\n          properties:\n            count: { get_input: wn_num }\n        host:\n          properties:\n            instance_type: { get_input: wn_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n            #image: centos-7_2nic\n            #image: ubuntu-16.04-vmi\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ lrms_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ lrms_server, public_address, 0 ] }\n','{\"additional_description\": \"xpr different images\", \"fe_instance_flavor\": \"medium\", \"wn_num\": \"1\", \"wn_instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b2db-7271-726d-8c64-024283ff312a','2019-07-30 15:05:00','2019-07-31 07:34:05','','xpr dif im 2','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b2db-7271-726d-8c64-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b2db-7271-726d-8c64-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b2db-7271-726d-8c64-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy from scratch with cluster support (SLOW).\n  The basic configuration includes CentOS 7, SLURM, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    wn_num:\n      type: integer\n      description: Number of WNs in the cluster\n      default: 2\n      required: yes\n    fe_instance_flavor:\n      type: string\n      description: front end flavor (num_cpu, memory, disk)\n      default: small\n    wn_instance_flavor:\n      type: string\n      description: worker nodes flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB\n    hybrid:\n      type: boolean\n      description: Flag to specify that this cluster will work in an hybrid environment\n      default: false\n      required: false\n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"ELIXIR-ITALY\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n\n  node_templates:\n\n    galaxy_portal:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: lrms_front_end\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy_portal\n\n    lrms_front_end:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Slurm\n      properties:\n        wn_ips: { get_attribute: [ lrms_wn, private_address ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_server\n\n    lrms_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            dns_name: slurmserver\n            network_name: PUBLIC\n            ports:\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        host:\n          properties:\n            instance_type: { get_input: fe_instance_flavor }\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n    wn_node:\n      type: tosca.nodes.indigo.LRMS.WorkerNode.Slurm\n      properties:\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        public_front_end_ip: { get_attribute: [ lrms_server, public_address, 0 ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: galaxy_portal\n\n    galaxy_wn:\n      type: tosca.nodes.indigo.GalaxyWnCvmfsReferenceData\n      properties:\n        export_dir: { get_input: export_dir }\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        flavor: { get_input: flavor }\n        version: { get_input: version }\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: wn_node\n\n    lrms_wn:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        scalable:\n          properties:\n            count: { get_input: wn_num }\n        host:\n          properties:\n            instance_type: { get_input: wn_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base\n            #image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n            #image: centos-7_2nic\n            #image: ubuntu-16.04-vmi\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ lrms_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ lrms_server, public_address, 0 ] }\n','{\"additional_description\": \"xpr dif im 2\", \"fe_instance_flavor\": \"medium\", \"wn_num\": \"1\", \"wn_instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b36e-6f76-026e-8c64-024283ff312a','2019-07-31 08:37:00','2019-07-31 09:05:03','','xpr new wn base 1','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b36e-6f76-026e-8c64-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b36e-6f76-026e-8c64-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b36e-6f76-026e-8c64-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy from scratch with cluster support (SLOW).\n  The basic configuration includes CentOS 7, SLURM, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    wn_num:\n      type: integer\n      description: Number of WNs in the cluster\n      default: 2\n      required: yes\n    fe_instance_flavor:\n      type: string\n      description: front end flavor (num_cpu, memory, disk)\n      default: small\n    wn_instance_flavor:\n      type: string\n      description: worker nodes flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB\n    hybrid:\n      type: boolean\n      description: Flag to specify that this cluster will work in an hybrid environment\n      default: false\n      required: false\n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"ELIXIR-ITALY\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n\n  node_templates:\n\n    galaxy_portal:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: lrms_front_end\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy_portal\n\n    lrms_front_end:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Slurm\n      properties:\n        wn_ips: { get_attribute: [ lrms_wn, private_address ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_server\n\n    lrms_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            dns_name: slurmserver\n            network_name: PUBLIC\n            ports:\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        host:\n          properties:\n            instance_type: { get_input: fe_instance_flavor }\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n    wn_node:\n      type: tosca.nodes.indigo.LRMS.WorkerNode.Slurm\n      properties:\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        public_front_end_ip: { get_attribute: [ lrms_server, public_address, 0 ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: galaxy_portal\n\n    galaxy_wn:\n      type: tosca.nodes.indigo.GalaxyWnCvmfsReferenceData\n      properties:\n        export_dir: { get_input: export_dir }\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        flavor: { get_input: flavor }\n        version: { get_input: version }\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: wn_node\n\n    lrms_wn:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        scalable:\n          properties:\n            count: { get_input: wn_num }\n        host:\n          properties:\n            instance_type: { get_input: wn_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base-wn\n            #image: centos-7_2nic\n            #image: ubuntu-16.04-vmi\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ lrms_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ lrms_server, public_address, 0 ] }\n','{\"additional_description\": \"xpr new wn base 1\", \"fe_instance_flavor\": \"medium\", \"wn_num\": \"1\", \"wn_instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b376-4978-b1dc-8c64-024283ff312a','2019-07-31 09:33:00','2019-07-31 10:00:42','523ac14c-b376-11e9-b04e-fa163e0663d5','xpr new 2','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b376-4978-b1dc-8c64-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b376-4978-b1dc-8c64-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b376-4978-b1dc-8c64-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy from scratch with cluster support (SLOW).\n  The basic configuration includes CentOS 7, SLURM, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    wn_num:\n      type: integer\n      description: Number of WNs in the cluster\n      default: 2\n      required: yes\n    fe_instance_flavor:\n      type: string\n      description: front end flavor (num_cpu, memory, disk)\n      default: small\n    wn_instance_flavor:\n      type: string\n      description: worker nodes flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB\n    hybrid:\n      type: boolean\n      description: Flag to specify that this cluster will work in an hybrid environment\n      default: false\n      required: false\n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"ELIXIR-ITALY\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n\n  node_templates:\n\n    galaxy_portal:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: lrms_front_end\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy_portal\n\n    lrms_front_end:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Slurm\n      properties:\n        wn_ips: { get_attribute: [ lrms_wn, private_address ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_server\n\n    lrms_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            dns_name: slurmserver\n            network_name: PUBLIC\n            ports:\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        host:\n          properties:\n            instance_type: { get_input: fe_instance_flavor }\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n    wn_node:\n      type: tosca.nodes.indigo.LRMS.WorkerNode.Slurm\n      properties:\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        public_front_end_ip: { get_attribute: [ lrms_server, public_address, 0 ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: galaxy_portal\n\n    galaxy_wn:\n      type: tosca.nodes.indigo.GalaxyWnCvmfsReferenceData\n      properties:\n        export_dir: { get_input: export_dir }\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        flavor: { get_input: flavor }\n        version: { get_input: version }\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: wn_node\n\n    lrms_wn:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        scalable:\n          properties:\n            count: { get_input: wn_num }\n        host:\n          properties:\n            instance_type: { get_input: wn_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base-wn\n            #image: centos-7_2nic\n            #image: ubuntu-16.04-vmi\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ lrms_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ lrms_server, public_address, 0 ] }\n','{\"additional_description\": \"xpr new 2\", \"fe_instance_flavor\": \"medium\", \"wn_num\": \"1\", \"wn_instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b379-8a54-0e90-8c64-024283ff312a','2019-07-31 09:57:00','2019-07-31 10:24:48','','xpr44','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b379-8a54-0e90-8c64-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b379-8a54-0e90-8c64-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b379-8a54-0e90-8c64-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy from scratch with cluster support (SLOW).\n  The basic configuration includes CentOS 7, SLURM, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    wn_num:\n      type: integer\n      description: Number of WNs in the cluster\n      default: 2\n      required: yes\n    fe_instance_flavor:\n      type: string\n      description: front end flavor (num_cpu, memory, disk)\n      default: small\n    wn_instance_flavor:\n      type: string\n      description: worker nodes flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB\n    hybrid:\n      type: boolean\n      description: Flag to specify that this cluster will work in an hybrid environment\n      default: false\n      required: false\n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"ELIXIR-ITALY\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n\n  node_templates:\n\n    galaxy_portal:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: lrms_front_end\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy_portal\n\n    lrms_front_end:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Slurm\n      properties:\n        wn_ips: { get_attribute: [ lrms_wn, private_address ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_server\n\n    lrms_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            dns_name: slurmserver\n            network_name: PUBLIC\n            ports:\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        host:\n          properties:\n            instance_type: { get_input: fe_instance_flavor }\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n    wn_node:\n      type: tosca.nodes.indigo.LRMS.WorkerNode.Slurm\n      properties:\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        public_front_end_ip: { get_attribute: [ lrms_server, public_address, 0 ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: galaxy_portal\n\n    galaxy_wn:\n      type: tosca.nodes.indigo.GalaxyWnCvmfsReferenceData\n      properties:\n        export_dir: { get_input: export_dir }\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        flavor: { get_input: flavor }\n        version: { get_input: version }\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: wn_node\n\n    lrms_wn:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        scalable:\n          properties:\n            count: { get_input: wn_num }\n        host:\n          properties:\n            instance_type: { get_input: wn_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base-wn\n            #image: centos-7_2nic\n            #image: ubuntu-16.04-vmi\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ lrms_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ lrms_server, public_address, 0 ] }\n','{\"additional_description\": \"xpr44\", \"fe_instance_flavor\": \"medium\", \"wn_num\": \"1\", \"wn_instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b37e-dd07-6010-8c64-024283ff312a','2019-07-31 10:35:00','2019-07-31 11:04:26','','xpr cluster','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b37e-dd07-6010-8c64-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b37e-dd07-6010-8c64-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b37e-dd07-6010-8c64-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy from scratch with cluster support (SLOW).\n  The basic configuration includes CentOS 7, SLURM, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    wn_num:\n      type: integer\n      description: Number of WNs in the cluster\n      default: 2\n      required: yes\n    fe_instance_flavor:\n      type: string\n      description: front end flavor (num_cpu, memory, disk)\n      default: small\n    wn_instance_flavor:\n      type: string\n      description: worker nodes flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB\n    hybrid:\n      type: boolean\n      description: Flag to specify that this cluster will work in an hybrid environment\n      default: false\n      required: false\n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"ELIXIR-ITALY\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n\n  node_templates:\n\n    galaxy_portal:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: lrms_front_end\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy_portal\n\n    lrms_front_end:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Slurm\n      properties:\n        wn_ips: { get_attribute: [ lrms_wn, private_address ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_server\n\n    lrms_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            dns_name: slurmserver\n            network_name: PUBLIC\n            ports:\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        host:\n          properties:\n            instance_type: { get_input: fe_instance_flavor }\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n    wn_node:\n      type: tosca.nodes.indigo.LRMS.WorkerNode.Slurm\n      properties:\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        public_front_end_ip: { get_attribute: [ lrms_server, public_address, 0 ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: galaxy_portal\n\n    galaxy_wn:\n      type: tosca.nodes.indigo.GalaxyWnCvmfsReferenceData\n      properties:\n        export_dir: { get_input: export_dir }\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        flavor: { get_input: flavor }\n        version: { get_input: version }\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: wn_node\n\n    lrms_wn:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        scalable:\n          properties:\n            count: { get_input: wn_num }\n        host:\n          properties:\n            instance_type: { get_input: wn_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base-wn\n            #image: centos-7_2nic\n            #image: ubuntu-16.04-vmi\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ lrms_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ lrms_server, public_address, 0 ] }\n','{\"additional_description\": \"xpr cluster\", \"fe_instance_flavor\": \"medium\", \"wn_num\": \"1\", \"wn_instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b393-7da3-c50a-8c64-024283ff312a','2019-07-31 13:02:00','2019-07-31 13:31:30','','xpr ','DELETE_COMPLETE','{}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b393-7da3-c50a-8c64-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b393-7da3-c50a-8c64-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b393-7da3-c50a-8c64-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy from scratch with cluster support (SLOW).\n  The basic configuration includes CentOS 7, SLURM, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    wn_num:\n      type: integer\n      description: Number of WNs in the cluster\n      default: 2\n      required: yes\n    fe_instance_flavor:\n      type: string\n      description: front end flavor (num_cpu, memory, disk)\n      default: small\n    wn_instance_flavor:\n      type: string\n      description: worker nodes flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 50 GB\n    hybrid:\n      type: boolean\n      description: Flag to specify that this cluster will work in an hybrid environment\n      default: false\n      required: false\n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"ELIXIR-ITALY\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n\n  node_templates:\n\n    galaxy_portal:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: lrms_front_end\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy_portal\n\n    lrms_front_end:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Slurm\n      properties:\n        wn_ips: { get_attribute: [ lrms_wn, private_address ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_server\n\n    lrms_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            dns_name: slurmserver\n            network_name: PUBLIC\n            ports:\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        host:\n          properties:\n            instance_type: { get_input: fe_instance_flavor }\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n    wn_node:\n      type: tosca.nodes.indigo.LRMS.WorkerNode.Slurm\n      properties:\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        public_front_end_ip: { get_attribute: [ lrms_server, public_address, 0 ] }\n        hybrid: { get_input: hybrid }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: galaxy_portal\n\n    galaxy_wn:\n      type: tosca.nodes.indigo.GalaxyWnCvmfsReferenceData\n      properties:\n        export_dir: { get_input: export_dir }\n        front_end_ip: { get_attribute: [ lrms_server, private_address, 0 ] }\n        flavor: { get_input: flavor }\n        version: { get_input: version }\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n      requirements:\n        - host: lrms_wn\n        # The worker node is configured after the galaxy_portal to share /export\n        # only after its configuration on WNs if wn_num_min>0\n        - dependency: wn_node\n\n    lrms_wn:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        scalable:\n          properties:\n            count: { get_input: wn_num }\n        host:\n          properties:\n            instance_type: { get_input: wn_instance_flavor }\n        os:\n          properties:\n            image: centos-7-galaxy-base-wn\n            #image: centos-7_2nic\n            #image: ubuntu-16.04-vmi\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ lrms_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ lrms_server, public_address, 0 ] }\n','{\"additional_description\": \"xpr \", \"fe_instance_flavor\": \"medium\", \"wn_num\": \"1\", \"wn_instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"data.galaxyproject.org\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b397-08ec-a220-8c64-024283ff312a','2019-07-31 13:28:00','2019-07-31 13:28:00','13c31efc-b397-11e9-b39a-fa163e0663d5','expr','CREATE_IN_PROGRESS','{}','DEPLOYER','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b397-08ec-a220-8c64-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b397-08ec-a220-8c64-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b397-08ec-a220-8c64-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/mtangaro/tosca-types/master/custom_types.yaml\n  #- indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  Deploy Galaxy on a single Virtual Machine from a VM image (FAST).\n  The basic configuration includes CentOS 7, the selected Galaxy flavour, companion software and reference data.\n  Configure, click on the \"Submit\" button and wait for the confirmation e-mail(s) with instructions on how to provide your passphrase (if encryption is enabled) and log in to your new Galaxy instance.\n  If after some hours you do not receive any e-mail please be sure to check your SPAM BOX.\n\ntopology_template:\n  inputs:\n    instance_flavor:\n      type: string\n      description: instance flavor (num_cpu, memory, disk)\n      default: small\n    storage_size:\n      type: string\n      description: storage memory required for the instance\n      default: 10 GB      \n\n    admin_email:\n      type: string\n      description: email of the admin user\n      default: admin@admin.com\n    admin_api_key:\n      type: string\n      description: key to access the API with admin role\n      default: not_very_secret_api_key\n    user:\n      type: string\n      description: username to launch the galaxy daemon\n      default: galaxy\n    version:\n      type: string\n      description: galaxy version to install\n      default: master\n    instance_description:\n      type: string\n      description: galaxy instance description\n      default: \"INDIGO Galaxy test\"\n    instance_key_pub:\n      type: string\n      description: galaxy instance ssh public key\n      default: your_ssh_public_key\n    export_dir:\n      type: string\n      description: path to store galaxy data\n      default: /export\n\n    storage_encryption:\n      type: boolean\n      description: Enable storage encryption using Vault to store secrets and LUKS to encrypt\n      default: False\n      required: true\n    vault_url:\n      type: string\n      description: Hashicorp Vault server url\n      default: \"https://cloud-90-147-75-223.cloud.ba.infn.it:8200\"\n      required: false\n    vault_wrapping_token:\n      type: string\n      description: Vault Wrapping token to write secret\n      default: not_a_wrapping_token\n      required: false\n    vault_secret_path:\n      type: string\n      description: Vault path to store secret\n      default: \"subject/depuuid\"\n      required: false\n    vault_secret_key:\n      type: string\n      description: Vault secret key name\n      default: secret\n      required: false\n\n    flavor:\n      type: string\n      description: Galaxy flavor for tools installation\n      default: \"galaxy-no-tools\"\n\n    reference_data:\n      type: boolean\n      description: Install Reference data\n      default: true\n    refdata_cvmfs_configuration:\n      type: string\n      description: Configure cvmfs or load preconfigured repository\n      default: \'cvmfs_preconfigured\'\n    refdata_cvmfs_repository_name:\n      type: string\n      description: CernVM-FS repository name\n      default: \'elixir-italy.galaxy.refdata\'\n    refdata_cvmfs_server_url:\n      type: string\n      description: CernVM-FS server, replica or stratum-zero\n      default: \'90.147.102.186\'\n    refdata_cvmfs_key_file:\n      type: string\n      description: CernVM-FS public key\n      default: \'elixir-italy.galaxy.refdata.pub\'\n    refdata_cvmfs_proxy_url:\n      type: string\n      description: CernVM-FS proxy url\n      default: \'DIRECT\'\n    refdata_cvmfs_proxy_port:\n      type: integer\n      description: CernVM-FS proxy port\n      default: 80\n    refdata_dir:\n      type: string\n      description: path to store galaxy reference data\n      default: /cvmfs\n \n  node_templates:\n\n    galaxy:\n      type: tosca.nodes.indigo.GalaxyPortalFastConfig\n      properties:\n        storage_encryption: { get_input: storage_encryption }\n        vault_url: { get_input: vault_url }\n        vault_wrapping_token: { get_input: vault_wrapping_token }\n        vault_secret_path: { get_input: vault_secret_path }\n        vault_secret_key: { get_input: vault_secret_key }\n        admin_email: { get_input: admin_email }\n        admin_api_key: { get_input: admin_api_key }\n        version: { get_input: version }\n        instance_description: { get_input: instance_description }\n        instance_key_pub: { get_input: instance_key_pub }\n        export_dir: { get_input: export_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - lrms: local_lrms\n\n    galaxy_refdata:\n      type: tosca.nodes.indigo.GalaxyReferenceData\n      properties:\n        reference_data: { get_input: reference_data }\n        refdata_cvmfs_configuration: { get_input: refdata_cvmfs_configuration }\n        refdata_cvmfs_repository_name: { get_input: refdata_cvmfs_repository_name }\n        refdata_cvmfs_server_url: { get_input: refdata_cvmfs_server_url }\n        refdata_cvmfs_key_file: { get_input: refdata_cvmfs_key_file }\n        refdata_cvmfs_proxy_url: { get_input: refdata_cvmfs_proxy_url }\n        refdata_cvmfs_proxy_port: { get_input: refdata_cvmfs_proxy_port }\n        refdata_dir: { get_input: refdata_dir }\n        flavor: { get_input: flavor }\n      requirements:\n        - host: galaxy\n\n    # type to describe a Galaxy not using any LRMS but using the local system\n    local_lrms:\n      type: tosca.nodes.indigo.LRMS.FrontEnd.Local\n      requirements:\n        - host: galaxy_server\n \n    galaxy_server:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            private_ip: false\n            ports:\n              luks_api_port:\n                protocol: tcp\n                source: 5000\n              http_port:\n                protocol: tcp\n                source: 80\n              ftp_port:\n                protocol: tcp\n                source: 21\n              ftp_passive:\n                protocol: tcp\n                source_range: [ 30000, 30009 ]\n        # Host container properties\n        host:\n         properties:\n           instance_type: { get_input: instance_flavor }\n        # Guest Operating System properties\n        os:\n          properties:\n            image: { concat: [\'centos-7-\', get_input: flavor,\'-\', get_input: version ] } # centos-7-galaxy-no-tools-release_17.05\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                location: { get_input: export_dir }\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: { get_input: storage_size }\n\n  outputs:\n    endpoint:\n      value: { concat: [ \'http://\', get_attribute: [ galaxy_server, public_address, 0 ], \'/galaxy\' ] }\n    node_ip:\n      value: { get_attribute: [ galaxy_server, public_address, 0 ] }\n','{\"additional_description\": \"expr\", \"instance_flavor\": \"medium\", \"instance_key_pub\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDy787GZIVdHW7QV+Wu2q9q5k5CiTOq04ENioVig88IIVGNqi8qiX+3fhZx/w2hhlz6AePrYu8CfVPplCRdSMjP46av53V1M7r0+yqJvuk1PC2f/rSoEL95TvaeiV28+5Wy4MC58UvYuewuhIHcbfPiXHf3NEE3scd38GXCYKLhAP28mUQ950Ar4SoWv4irv21maJwkwqn5AYXcy1yrbBZtaTbQELVPa/E6X9j+k29bn32ITmmtKBA3ne/QlFRaaYI3XggvMXhhSSIYsJUdlSOjUTriB2DraHsxMGfOPjmPXkjvrXp9MfOzjMg10fb7K2Mda8u/ujK/dvx3BnhlSIpn marco@marco-Latitude-3440\", \"storage_size\": \"50 GB\", \"version\": \"release_18.05\", \"instance_description\": \"ELIXIR-ITALY\", \"admin_email\": \"ma.tangaro@gmail.com\", \"flavor\": \"galaxy-minimal\", \"refdata_cvmfs_repository_name\": \"elixir-italy.galaxy.refdata\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','',''),('11e9b398-d887-576f-8c64-024283ff312a','2019-07-31 13:41:00','2019-07-31 13:49:00','e4665938-b398-11e9-8af8-fa163e0663d5','prova','CREATE_COMPLETE','{\"endpoint\": \"90.147.170.205\", \"node_creds\": {\"token_type\": \"private_key\", \"token\": \"-----BEGIN RSA PRIVATE KEY-----\nMIIEqQIBAAKCAQEAvn0EAtHvmyEDipMxG+HR1g5ttxfQ9oz2j2BIk0SDzL8kYhJJ\nuRt/nvpxzI7XKEGXBIinpVxRv+NhCJDuBsoNLzCzZyMrihCPZVCiGdBSMxVicXH6\ngq6URg2tA117WMAMI/+11HZbu43umxp3b/B+YEuZEiLfwGwaNo8caGijySUfKu7z\nSvmwzR/tDJByj2Njmo4ZFNwDrnXbXYi5hghM+GOQsUGvMAh43Hdo46iaSUpZOugk\nSFtLtWEnrhr0F14aZiLh1zdF5+Dlap8b6XjotnaJwUciy+xOwbSkqY2j0stwHF9g\n0E3Ty9k1PNeyKfhQa7qjrkYcT4t5gIn8SOKe4QIDAQABAoIBAQCgf49InQBo0ck9\nEkYXew6lcCTLVzrO8fiw12xvARSYCBkstMH/QIcoOVZ3B4eLuK/4tveiIYYTyw6v\n/AVCHS48q6kNZpnBy7A2qljarScFOahnc6SiRVxTJiS3qCVMowvXrRXUfSFPhwgb\nEZK+84BXvHqtyEqEw9DWVYCXDEusJrBOL93c8PXrW1CVDtXIk34k+WZKoicxVSlu\nu3E/IncXELX72VjysUO6vn2ZL2bauE88NODfexASvoX02ynrMcrwk3mJRj1cLCGE\n4whov0Av1vCjoXpWXntS+2Y5zzZmPUh0efHFhQN0OjAId0dyg5tPnPPVELm4quvP\nA6JkcuyRAoIAgQDJlmlWilSfzVkC2Wc/TMWQKbQ4Dyoh1kXSeQ1N/PFpXllZqI77\n+F0RVj457RHNm9a6Lt5aNkmcyvCU/PusAW1z4+bsnWNLMp0jpk7Bz/gSW8/4fP0A\nwQr3e9DKwrEutS6NotqkrbrcfBdtM58yBPnNRyKWTqRQDL92by18OaK7tQKCAIEA\n8eenyOACO9u3aXyJ+YCAmMJ9crhoxG5PzDKGzA+ORsienHgLx1xuxr6tDAI3Y4Hj\n5fCM5JBr1rG81oernx81e1TGhU18cBUi+zB3b/pzzQtffUmHHu6xlNVcEFxl1m8t\nTNY9BKVauv/lvNdrHiSsjm5IhwPc3gPrWrabn4+2yf0CggCAV5ZVwHcsG57CTP2e\n4Z7+vAuStUTJfpg2ECPuhvMfBTQsSEt3jL012sGJGewKbzaFzrFshO/PfiOi8mkV\nBIA+STs9a5NawCKGqiWpVIaC958Stpm/5+L4W91dM6vyBiRMzNd0flbJuODl4Nms\nErScwPdmbL5QoENZsSDPN4lnTn0CggCABI4KGLwvDpV6hJ/1sR78TOQMnKZgQqKZ\nGg0xgJIiaa7JXcTc4+oXo+JfO8Sm6la9xcybuooFnctG9Psk/iAGT8Yu3r+wwiOD\nvxsQhKlAmPHH4IIL60cvTNAfpac3u6voPHQkPfwnEzJSTxX3TGAAZ8Yn03L9K6kD\nO3gIwh5goLkCggCBAI4UvyL31G6J7WFvqWyX6OQ4QQceSLkAx4cXcGdrRQ9UMnTV\nP7kbpfPEWYGFvUbzq6sBmnYJWa+idTWqpASiwDohsE9II3WEZSkygyqZCO1/zy8D\nEt0vmo0nCdO4aXYneFvImCXM1+WS27S9E/g3/EF16+Kcf/+EaqPXQgLJl+WV\n-----END RSA PRIVATE KEY-----\n\", \"user\": \"cloudadm\"}}','NONE','[{\"rel\": \"self\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b398-d887-576f-8c64-024283ff312a\"}, {\"rel\": \"resources\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b398-d887-576f-8c64-024283ff312a/resources\"}, {\"rel\": \"template\", \"href\": \"http://cloud-90-147-75-155.cloud.ba.infn.it:8080/deployments/11e9b398-d887-576f-8c64-024283ff312a/template\"}]','20340b0b-c07f-46e0-a9c6-1f987ba9ff85','provider-RECAS-BARI','90.147.170.205','tosca_definitions_version: tosca_simple_yaml_1_0\n\nimports:\n  - indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml\n\ndescription: >\n  TOSCA test for launching compute node with a specified image and getting\n  as an output the IP and SSH credentials to access\n\ntopology_template:\n \n  node_templates:\n   \n    simple_node:\n      type: tosca.nodes.indigo.Compute\n      capabilities:\n        endpoint:\n          properties:\n            network_name: PUBLIC\n            #private_ip: false\n            ports:\n              user_port:\n                protocol: tcp\n                source: 9000\n              other_port:\n                protocol: tcp\n                source: 9001\n              ssh_port:\n                protocol: tcp\n                source: 22\n        scalable:\n          properties:\n            count: 1\n        host:\n          properties:\n            num_cpus: 1\n            mem_size: 2 GB\n        os:\n          properties:\n            type: linux  \n            # The format of the image must be defined\n            # Currently this example uses the IM URI convention\n            # used in disk.0.image.url\n            # see: http://imdocs.readthedocs.org/en/latest/radl.html?highlight=uri#system-features\n            #image: ubuntu-16.04-vmi\n            #image: centos-7-1708-vmi\n            #image: ubuntu-16.04_2nic\n            #image: centos-7_2nic\n            image: centos-7-galaxy-base\n      requirements:\n        # contextually this can only be a relationship type\n        - local_storage:\n            # capability is provided by Compute Node Type\n            node: my_block_storage\n            capability: tosca.capabilities.Attachment\n            relationship:\n              type: tosca.relationships.AttachesTo\n              properties:\n                #location: /export\n                device: hdb\n\n    my_block_storage:\n      type: tosca.nodes.BlockStorage\n      properties:\n        size: 1 GB\n\n  outputs:\n    endpoint:\n      value: { get_attribute: [ simple_node, public_address, 0 ] }\n    node_creds:\n      value: { get_attribute: [ simple_node, endpoint, credential, 0 ] }\n','{\"additional_description\": \"prova\"}','{\"keepLastAttempt\": \"false\"}',0,1,1,'https://iam.recas.ba.infn.it/',0,'','','');
/*!40000 ALTER TABLE `deployments` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `users`
--

DROP TABLE IF EXISTS `users`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `users` (
  `sub` varchar(36) NOT NULL,
  `name` varchar(128) DEFAULT NULL,
  `username` varchar(64) NOT NULL,
  `given_name` varchar(64) DEFAULT NULL,
  `family_name` varchar(64) DEFAULT NULL,
  `email` varchar(64) NOT NULL,
  `organisation_name` varchar(64) DEFAULT NULL,
  `picture` varchar(128) DEFAULT NULL,
  `role` varchar(32) DEFAULT 'user',
  `active` tinyint(1) DEFAULT '1',
  PRIMARY KEY (`sub`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `users`
--

LOCK TABLES `users` WRITE;
/*!40000 ALTER TABLE `users` DISABLE KEYS */;
INSERT INTO `users` VALUES ('20340b0b-c07f-46e0-a9c6-1f987ba9ff85','Marco Tangaro','marco.tangaro','Marco','Tangaro','ma.tangaro@gmail.com','recas-bari','https://www.gravatar.com/avatar/d9d6e935fc0267844260a2b69158ef3b?d=identicon&s=26','admin',1),('4d5b241a-a9cc-4fb1-8443-5385844363d8','Marica Antonacci','maricaantonacci','Marica','Antonacci','marica.antonacci@ba.infn.it','recas-bari','https://www.gravatar.com/avatar/193fcfd0e0a5b4019b7ee6ac34951820?d=identicon&s=26','admin',1),('9ab9b24b-1e70-4bfd-b1c1-25eb81d944e1','Davide Cangelosi','Cangelosi','Davide','Cangelosi','davidecangelosi@gaslini.org','recas-bari','https://www.gravatar.com/avatar/c5d58cd072b3249fac610ecab8d07730?d=identicon&s=26','user',1),('9c3c7f53-7279-4008-82be-60600418c884','Marco Tangaro','mtangaro_test','Marco','Tangaro','marcoantonio.tangaro@ba.infn.it','recas-bari','https://www.gravatar.com/avatar/e487336aa4e8503bb70fb8888189cfb9?d=identicon&s=26','user',1),('ba31317b-d8ac-4cc7-ab08-5b56bd51e085','laniakea1 elixir-it','laniakea1','laniakea1','elixir-it','laniakear001@gmail.com','recas-bari','https://www.gravatar.com/avatar/05137b4283507df37c8196c3217b362b?d=identicon&s=26','user',1),('c0b907df-43a3-4c8a-952a-2b5ca56ec43e','pietro mandreoli','pietro','pietro','mandreoli','pietro.mandreoli@gmail.com','recas-bari','https://www.gravatar.com/avatar/bdc36da74738849a256a6f04655ea237?d=identicon&s=26','user',1);
/*!40000 ALTER TABLE `users` ENABLE KEYS */;
UNLOCK TABLES;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2019-07-31 14:05:41
